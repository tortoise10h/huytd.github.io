<html>
    <head>
        <title> Cấu hình login SSH bằng private key | Huy's Blog</title>
        <meta charset="utf-8">
        <meta http-equiv="content-type" content="text/html;"><meta name=viewport content="initial-scale=1.0 maximum-scale=1.0">
        
        <link href="../css/theme.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="../css/highlight/tomorrow.css">
        <link rel="stylesheet" href="../css/fontello.css">
        <script src="../js/highlight.pack.js"></script>
        <script>
        hljs.initHighlightingOnLoad();
        </script>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    </head>
    <body>
        <div class="header">
            <a href="/"><i class="icon icon-emo-coffee"></i> Huy's Blog</a>
        </div>
        <div class="container">
            <div class="main">
                <h1 id="c-u-h-nh-login-ssh-b-ng-private-key">Cấu hình login SSH bằng private key</h1>
<p>Để có thể kết nối vào SSH server bằng public-private key, đầu tiên chúng ta phải khởi tạo cặp RSA key trên máy tính cá nhân.</p>
<h2 id="b-c-1-kh-i-t-o-rsa-key">Bước 1: Khởi tạo RSA key</h2>
<p><strong>Trên máy tính cá nhân</strong>, gõ lệnh:</p>
<pre><code>ssh-keygen -t rsa -b 2048 -v
</code></pre><p>Lệnh này tạo ra một key RSA 2048 bit. Khi chạy thì <code>ssh-keygen</code> sẽ yêu cầu chúng ta nhập tên của key vào, có thể chọn một cái tên dễ nhớ, thường là tên server, ví dụ <code>gariim</code>:</p>
<div class="box-white" style="padding: 10px;">
Generating public/private rsa key pair.<br/>
Enter file in which to save the key (/home/anonymouse/.ssh/id_rsa): <strong>gariim</strong><br/>
...
</div>

<p>Các thông tin khác như passphrase có thể nhập vào hay để trống tùy ý.</p>
<p>Sau khi chạy xong, truy cập vào thư mục <code>~/.ssh~</code> sẽ thấy có 2 file:</p>
<ul>
<li><strong>gariim</strong>: &tbsp; đây chính là private key, cần lưu kĩ trong máy, không để lộ ra ngoài.</li>
<li><strong>gariim.pub</strong>: &tbsp; đây là public key, có thể đem copy lên bất kì server nào để nó có thể nhận diện ra máy tính của mình.</li>
</ul>
<h2 id="b-c-2-copy-public-key-l-n-server">Bước 2: Copy public key lên server</h2>
<p>Tiếp theo, chúng ta cần đăng ký để server có thể nhận dạng được RSA key của mình. Để làm điều này, dùng lệnh <code>ssh-copy-id</code> như sau:</p>
<pre><code>ssh-copy-id -i ~/gariim.pub root@doumacia.gariim.com
</code></pre><p>Cần phải nhập mật khẩu server để có thể copy. Sau khi copy thành công thì chúng ta có thể login bằng private key ngay.</p>
<h2 id="b-c-3-login-b-ng-private-key">Bước 3: Login bằng private key</h2>
<p>Bây giờ thử login vào server bằng private key vừa tạo:</p>
<pre><code>ssh -i ~/.ssh/gariim root@doumacia.gariim.com
</code></pre><p>Nếu đã copy thành công public key lên server thì quá trình login sẽ diễn ra suông sẻ, mỗi lúc login, server sẽ đối chiếu private key của chúng ta với public key mà nó có để xác thực.</p>
<h2 id="b-c-4-c-u-h-nh-t-ng-ch-n-private-key-client">Bước 4: Cấu hình tự động chọn private key ở Client</h2>
<p>Nếu cảm thấy mỗi lần login phải gõ thêm tham số <code>-i ~/.ssh/gariim</code> phiền phức quá thì có thể cấu hình để máy tính tự động nhập private key.</p>
<p>Ở máy client, tạo một file <code>~/.ssh/config</code>, nội dung như sau:</p>
<pre><code>Host gariim doumacia.gariim.com
Hostname doumacia.gariim.com
User root
IdentityFile ~/.ssh/gariim
</code></pre><p>Từ bây giờ mỗi lúc login chỉ cần gõ như thế này:</p>
<pre><code>ssh gariim
</code></pre>
                <div class="fb-like" data-href="http://huytd.github.io/posts/ssh-private-key.html" data-layout="standard" data-action="like" data-show-faces="true" data-share="true"></div>
                <div id="disqus_thread"></div>
                <script>
                /**
                * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
                * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
                */
                /*
                var disqus_config = function () {
                this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
                this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                };
                */
                (function() { // DON'T EDIT BELOW THIS LINE
                var d = document, s = d.createElement('script');

                s.src = '//huysblog.disqus.com/embed.js';

                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
                })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
            </div>
        </div>
	    <div class="footer">
            <p>Created with <a href="http://github.com/huytd/azeroth-js">azeroth.js</a></p>
            <div class="social">
                <a target="_blank" href="http://facebook.com/kingbazoka"><i class="icon-facebook-squared"></i></a>
                <a target="_blank" href="http://twitter.com/huydotnet"><i class="icon-twitter-squared"></i></a>
                <a target="_blank" href="http://github.com/huytd"><i class="icon-github-squared"></i></a>
                <a target="_blank" href="https://thefullsnack.com"><i class="icon-emo-coffee"></i></a>
            </div>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-71353335-1', 'auto');
          ga('send', 'pageview');
        </script>
        <script>
          window.fbAsyncInit = function() {
            FB.init({
              appId      : '462066520669072',
              xfbml      : true,
              version    : 'v2.6'
            });

            FB.Event.subscribe('edge.create', function(url) {
              ga('send', 'social', 'facebook', 'like', url);
            });
          };

          (function(d, s, id){
             var js, fjs = d.getElementsByTagName(s)[0];
             if (d.getElementById(id)) {return;}
             js = d.createElement(s); js.id = id;
             js.src = "//connect.facebook.net/en_US/sdk.js";
             fjs.parentNode.insertBefore(js, fjs);
           }(document, 'script', 'facebook-jssdk'));
        </script>
        <script id="dsq-count-scr" src="//huysblog.disqus.com/count.js" async></script>
        <script type="text/javascript" async src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>
        <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [['$','$'], ['\\(','\\)']],
            skipTags: ["script","noscript","style","textarea"]
          }
        });
        </script>
    </body>
</html>
