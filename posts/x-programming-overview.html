<html>
    <head>
        <title> L·∫≠p tr√¨nh tr√™n X Window System | Huy's Blog</title>
        <meta charset="utf-8">
        <meta http-equiv="content-type" content="text/html;"><meta name=viewport content="initial-scale=1.0 maximum-scale=1.0">
        
        <link href="../css/inconsolata.css" rel="stylesheet" type="text/css">
        <link href="../css/theme.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="../css/highlight/tomorrow.css">
        <link rel="stylesheet" href="../css/fontello.css">
        <script src="../js/highlight.pack.js"></script>
        <script src="../js/autosizing.js"></script>
        <script>
        hljs.initHighlightingOnLoad();
        </script>
    </head>
    <body>
      <div class="notice">N·ªôi dung tr√™n blog n√†y ƒë∆∞·ª£c c·∫≠p nh·∫≠t l·∫ßn cu·ªëi v√†o l√∫c <b>11:50 02/05/2017</b>.<br/>T·ª´ gi·ªù blog s·∫Ω chuy·ªÉn sang nh√† m·ªõi l√† <a href="https://thefullsnack.com">https://thefullsnack.com</a>. Mong c√°c b·∫°n gh√© ch∆°i <i class="icon icon-emo-coffee"></i></div>
        <div class="header">
            <a href="/"><i class="icon icon-emo-coffee"></i> Huy's Blog</a>
        </div>
        <div class="container">
            <div class="main">
                <h1 id="l-p-tr-nh-tr-n-x-window-system">L·∫≠p tr√¨nh tr√™n X Window System</h1>
<p>X l√† m·ªôt m√¥i tr∆∞·ªùng qu·∫£n l√Ω giao di·ªán c·ª≠a s·ªï d·ª±a tr√™n m√¥ h√¨nh m·∫°ng (client-server), c√°c ·ª©ng d·ª•ng c√≥ th·ªÉ th·ª±c thi ƒë·ªôc l·∫≠p trong m·ªôt h·ªá th·ªëng m·∫°ng t·ª´ nhi·ªÅu thi·∫øt b·ªã kh√°c nhau, v√† k·∫øt qu·∫£ (h√¨nh ·∫£nh v·ªÅ c·ª≠a s·ªï, giao di·ªán c·ªßa ·ª©ng d·ª•ng ƒë√≥) s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã tr√™n workstation ·ªü local.</p>
<p>X11 l√† t√™n g·ªçi kh√°c c·ªßa X phi√™n b·∫£n 11, ƒë∆∞·ª£c release l·∫ßn ƒë·∫ßu v√†o th√°ng 9 nƒÉm 1987.</p>
<p>Xlib l√† t√™n c·ªßa b·ªô th∆∞ vi·ªán chu·∫©n ƒë∆∞·ª£c d√πng ƒë·ªÉ vi·∫øt ch∆∞∆°ng tr√¨nh tr√™n m√¥i tr∆∞·ªùng X.</p>
<h2 id="x-window-system-concepts">X Window System Concepts</h2>
<ul>
<li><strong>Display:</strong> is a workstation consisting of a keyboard, pointing device (mouse, touchpad,...) and <em>one or more</em> screens.</li>
<li><strong>Client:</strong> or <em>applications</em> is the user programs.</li>
<li><strong>Server:</strong> Is a program that control each <em>display</em>, it allows access to the <em>display</em> by multiple <em>clients</em>, pass <em>user input</em> to <em>clients</em>, render graphics content (such as UI) of a <em>client</em>,...</li>
<li><strong>Window:</strong> a region that a <em>client</em> is being draw.</li>
<li><strong>Window Manager:</strong> a program written with Xlib, it is given a special authority to control the layout, the appearance or the UI style of <em>windows</em> on the screen. (i3, dwm,...)</li>
<li><strong>Event:</strong> is a user input (mouse click, mouse move, key press,...) or interaction with other programs (window move, window resize, window close,...).</li>
<li><strong>Extensions:</strong> X is <em>extensible</em>. It allows both client-side and server-side codes to be executed at the same level as Xlib routines to define new behaviors of X.</li>
</ul>
<h2 id="x-window-system-architecture">X Window System Architecture</h2>
<pre><code>.-------------.  .------------------.  .-------------.
|   Client    |  |      Client      |  |   Client    |
| Application |  | (Window Manager) |  | Application |
|-------------|  |------------------|  |-------------|
|    Xlib     |  |       Xlib       |  |   Toolkit   |
`-------------&#39;  `------------------&#39;  |-------------|
      |                    |           |     Xlib    |
      |                    |           `-------------&#39;
      `---------------.    |                  |
                      |    |    .-------------&#39;
  X Window System     |    |    |
  protocol requests   |    |    |  Events and replies are
  sent from clients   |    |    |  passed back to Clients
                      |    |    |
  ======================================================= NETWORK
                      |    |    |
                  .----------------.
                  |    X Server    |
                  |----------------| ====&gt; DISPLAY DEVICE
                  | Device Drivers |
                  `----------------&#39;
</code></pre><p>Clients communicate with the X server by calling to the low-level C library named Xlib. This library provides functions for <em>connecting to a particular display server</em>, <em>creating windows</em>, <em>drawing graphics</em>, <em>responding to events</em>,... </p>
<p>Xlib calls are translated to network requests following the X Window System Protocol and sending to X server.</p>
<p><em>Toolkits</em> is a set of higher level subroutine libraries, implement a set of UI features such as menus or command buttons (aka <em>toolkit widgets</em>), and allow applications to manipulate these features using OOP techniques. </p>
<h2 id="xlib">Xlib</h2>
<p>As mentioned in previous section, Xlib is a low-level C library provides us many functions to work with the X Server. The functions can be grouped as: </p>
<pre><code>- Color                                 - Cursors
- Data Management                       - Display Connection
- Display and Server Specifications     - Drawing
- Errors                                - Events
- Extensions                            - Fonts
- Geometery                             - Graphic Context
- Host Access                           - Images
- Interclient Communication             - Internationalization
- Keyboard                              - Pointer
- Regions                               - Resource Management
- Screen Saver                          - Text
- User Preferences                      - Window Attributes
- Window Life                           - Window Management
</code></pre>
                <div class="copyright">
                B·∫°n ƒë∆∞·ª£c t√πy √Ω b·∫•m like, tr√≠ch d·∫´n ho·∫∑c copy, post l·∫°i, nh∆∞ng vui l√≤ng ghi r√µ ngu·ªìn v√† t√°c gi·∫£ v√† kh√¥ng l√†m thay ƒë·ªïi n·ªôi dung b√†i vi·∫øt. N·∫øu kh√¥ng l√†m v·∫≠y, m√¨nh hy v·ªçng t·ª´ nay v·ªÅ sau b·∫°n s·∫Ω lu√¥n c·∫£m th·∫•y c·∫Øn r·ª©t l∆∞∆°ng t√¢m, ƒÉn kh√¥ng ngon, ng·ªß kh√¥ng y√™n. üòÜ
                </div>
                <!-- Comment -->
                <div class="comments">
                  <div id="comment-loading" class="loading"></div>
                  <div id="login-box" class="login">
                    B·∫°n c·∫ßn <button onclick="login()">Login</button> ƒë·ªÉ comment
                  </div>
                  <div id="comment-box" class="comment-input">
                    <div class="avatar">
                      <img id="user-avatar" src="" width="32" height="32"/>
                    </div>
                    <div class="input">
                      <textarea id="comment-content" onkeyup="autoSizing(this)" onkeydown="submitComment(event)" placeholder="Comment g√µ v√†o ƒë√¢y :D"></textarea>
                      <span>G√µ xong nh·∫•n <kbd>Ctrl</kbd> + <kbd>Enter</kbd> ƒë·ªÉ g·ª≠i.</span>
                    </div>
                  </div>
                  <ul id="comment-list" class="comment-list"></ul>
                </div>
                <!-- End Comment -->
            </div>
        </div>
	    <div class="footer">
        <p><a href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img src="https://thefullsnack.com/img/by-nc-nd.png" height="15" /></a></p>
            <p>Created with <a href="http://github.com/huytd/azeroth-js">azeroth.js</a></p>
            <div class="social">
                <a target="_blank" href="http://facebook.com/kingbazoka"><i class="icon-facebook-squared"></i></a>
                <a target="_blank" href="http://twitter.com/huydotnet"><i class="icon-twitter-squared"></i></a>
                <a target="_blank" href="http://github.com/huytd"><i class="icon-github-squared"></i></a>
                <a target="_blank" href="https://thefullsnack.com"><i class="icon-emo-coffee"></i></a>
            </div>
        </div>
        <script type="text/javascript" async src="https://cdn.rawgit.com/mathjax/MathJax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
        <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [['$','$'], ['\\(','\\)']],
            skipTags: ["script","noscript","style","textarea"]
          }
        });
        </script>
        <script src="https://www.gstatic.com/firebasejs/3.8.0/firebase.js"></script>
        <script>
          // Initialize Firebase
          var config = {
            apiKey: "AIzaSyA1PnIAlJJ-U6iQJMNnCOknBuziBqGMYcY",
            authDomain: "huys-blog-comment.firebaseapp.com",
            databaseURL: "https://huys-blog-comment.firebaseio.com",
            projectId: "huys-blog-comment",
            storageBucket: "huys-blog-comment.appspot.com",
            messagingSenderId: "317330376829"
          };
          firebase.initializeApp(config);
        </script>
        <script>
          let provider = new firebase.auth.GoogleAuthProvider();
          let auth = firebase.auth();
          let currentUser = null;
          let postCommentURL = 'posts/x-programming-overview/comments';

          auth.onAuthStateChanged(function(user) {
            document.getElementById("comment-loading").style.display = "none";
            if (user) {
              currentUser = user;
              // Logged in
              document.getElementById("login-box").style.display = "none";
              document.getElementById("comment-box").style.display = "flex";
              document.getElementById("user-avatar").setAttribute("src", user.photoURL);
            } else {
              // Not login yet
              document.getElementById("comment-box").style.display = "none";
              document.getElementById("login-box").style.display = "block";
            }
          });

          const login = function() {
            auth.signInWithPopup(provider)
              .then(function(result) {
              }).catch(function(err) {
              });
          };

          const encodeHTML = function(s) {
            return s.replace(/</g, '&lt;').replace(/"/g, '&quot;').replace(/>/g, '&gt;');
          };

          const saveNewComment = function(comment) {
            if (!currentUser) {
              return;
            }
            let commentData = {
              user: currentUser.displayName,
              avatar: currentUser.photoURL,
              time: (new Date()).getTime(),
              message: encodeHTML(comment)
            };
            database.ref(postCommentURL).push(commentData);
            document.getElementById("comment-content").value = "";
          };

          const submitComment = function(e) {
            let keyCode = e.which || e.keyCode;
            let ctrlCode = e.ctrlKey || e.metaKey;
            if (keyCode === 13 && ctrlCode) {
              let comment = document.getElementById("comment-content").value;
              saveNewComment(comment);
            }
          };

          const filterURLinComment = function(comment) {
            return comment.replace(/(https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9]\.[^\s]{2,})/g, "<a target='_blank' rel='noopener noreferrer' href='$1'>$1</a>");
          };

          const addNewComment = function(user, avatar, time, comment) {
            let commentFiltered = encodeHTML(comment);
            commentFiltered = filterURLinComment(commentFiltered);
            let d = new Date(time);
            let commentTime = d.toLocaleTimeString() + ' ' + d.toLocaleDateString();
            let html = '<div class="avatar">' +
              '   <img src="' + avatar + '" width="32" height="32"/>' +
              ' </div>' +
              '<div class="comment">' +
              '  <div class="metadata"><b>' + user + '</b> l√∫c <span>' + commentTime + '</span></div>' +
              '  <div class="content">' + commentFiltered
              '  </div>' +
              '</div>';
            let li = document.createElement('li');
            li.innerHTML = html;
            document.getElementById("comment-list").append(li);
          };

          let database = firebase.database();
          let posts = database.ref(postCommentURL).orderByChild('time');
          posts.on('child_added', function(data) {
            addNewComment(data.val().user, data.val().avatar, data.val().time, data.val().message);
          });
        </script>
    </body>
</html>
