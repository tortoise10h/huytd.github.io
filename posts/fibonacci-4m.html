<html>
    <head>
        <title> Tính tổng các số Fibonacci từ 1 tới 4 triệu | Huy's Blog</title>
        <meta charset="utf-8">
        <meta http-equiv="content-type" content="text/html;"><meta name=viewport content="initial-scale=1.0 maximum-scale=1.0">
        
        <link href='https://fonts.googleapis.com/css?family=Noto+Serif:400,400italic,700,700italic&subset=latin,vietnamese' rel='stylesheet' type='text/css'>
        <link href="../css/theme.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="../css/highlight/tomorrow-night.css">
        <link rel="stylesheet" href="../css/fontello.css">
        <script src="../js/highlight.pack.js"></script>
        <script>
        hljs.initHighlightingOnLoad();
        </script>
    </head>
    <body>
        <div class="header">
            <a href="/"><i class="icon icon-emo-coffee"></i> Huy's Blog</a>
        </div>
        <div class="container">
            <div class="main">
                <h1 id="t-nh-t-ng-c-c-s-fibonacci-t-1-t-i-4-tri-u">Tính tổng các số Fibonacci từ 1 tới 4 triệu</h1>
<p>Cuối tuần này có nói chuyện với bác <a href="http://kipalog.com/users/nguyenduyhao1111/mypage">@haond</a> về một đề tài khá là thú vị, đó là bài toán: <strong>Tính tổng các số Fibonacci từ 1 tới 4 triệu</strong></p>
<p>Để tính một số Fibonacci thì cực kì đơn giản, chỉ cần làm theo công thức: </p>
<p>$F\left( n \right)\; =\; F<em>{n-1}\; +\; F</em>{n-2}$</p>
<p>Code thì khá là đơn giản bằng cách dùng đệ quy: </p>
<pre><code>func Fibonacci(n: Int) -&gt; Int {
  if n &lt;= 2 {
    return 1
  }
  return Fibonacci(n - 1) + Fibonacci(n - 2)
}
</code></pre><p>Hoặc dùng vòng lặp để khử đệ quy:</p>
<pre><code>func Fibonacci(n: Int) -&gt; Int {
  var a = 0
  var b = 1
  var next = 0
  for i in 0..&lt;n {
    if i &lt;= 1 {
      next = i
    } else {
      next = a + b
      a = b
      b = next
    }
  }
  return next
}
</code></pre><p>Quay lại bài toán tính tổng các số Fibonacci, ta có thể implement một hàm tính tổng đơn giản như sau:</p>
<pre><code>func Sum(n: Int) -&gt; Int {
  var sum = 0
  for i in 0..&lt;n {
    sum += Fibonacci(n)  
  }
  return sum
}
</code></pre><p>Tuy nhiên thì với thuật toán như vậy, chúng ta có gặp phải vấn đề gì không? </p>
<p>Câu trả lời là có, vấn đề rất lớn!</p>
<p>Đầu tiên hãy nhìn vào đồ thị biểu diễn thời gian cần để tính Fibonacci dưới đây:</p>
<p><img src="img/fibonacci.png" alt=""></p>
<p>Dễ nhận thấy, với số n càng lớn, thì thời gian để tính Fibonacci của số đó càng lâu.</p>
<p>Cho nên đối với bài toán ở đây là tính tổng các số Fibonacci từ 1 tới 4 triệu, thì xét về yếu tố thời gian, điều này cũng trở thành một vấn đề bất khả thi rồi. Để giải quyết bài toán này, chúng ta cần phải loại trừ được vấn đề thời gian do chạy đệ quy hoặc việc lặp gây ra.</p>
<p>Vì mọi vấn đề liên quan đến số học đều, hiển nhiên, có thể biểu diễn được bằng toán học, vậy đây cũng không phải là ngoại lệ, hãy xem chúng ta có thể mượn được gì từ toán nào.</p>
<h2 id="c-ng-th-c-t-nh-t-ng-n-s-fibonacci">Công thức tính tổng n số Fibonacci</h2>
<p>Chúng ta có công thức tính tổng n số Fibonacci với mọi số n &gt;= 2 như sau:</p>
<p>$\mbox{S}<em>{n}\; =\; \sum</em>{i=1}^{n}{F<em>{i}}=\; F</em>{n+2}\; -\; 1$</p>
<p>Nếu không tin tưởng vào công thức, thì các bạn có thể tham khảo <a href="https://proofwiki.org/wiki/Sum_of_Sequence_of_Fibonacci_Numbers#Proof">chứng minh công thức tại đây</a></p>
<p>Vậy để tính tổng các số Fibonacci từ 1 tới 4 triệu, chúng ta có thể <strong>tìm số Fibonacci thứ 4 triệu lẻ 2 (4000002) rồi trừ giá trị này đi cho 1</strong>. Bài toán quay trở về tìm một số Fibonacci bất kì.</p>
<p>Tuy nhiên, 4 triệu lẻ 2 vẫn là một con số quá lớn để có thể tính toán bình thường trên một máy tính cá nhân (với các yếu tố như: tốc độ xử lý, giới hạn bộ nhớ, giới hạn của kiểu dữ liệu,...). Chúng ta cần tìm một giải pháp khác ít tốn kém hơn.</p>
<h2 id="c-ng-th-c-t-nh-s-fibonacci-b-t-k-">Công thức tính số Fibonacci bất kì</h2>
<p>Chúng ta có thêm công thức <a href="http://mathworld.wolfram.com/BinetsFibonacciNumberFormula.html">Binet</a> để tìm một số Fibonacci bất kì như sau:</p>
<p>$F_{n}\; =\; \frac{\phi ^{n}\; -\; \left( -\phi  \right)^{-n}}{\sqrt{5}}$</p>
<p>Chi tiết về kí hiệu <code>Φ</code> (phi): Xem <a href="http://mathworld.wolfram.com/GoldenRatio.html">tỉ lệ vàng</a></p>
<p>Công thức trên có thể được khai triển thành: </p>
<p>$F_{n}\; =\; \frac{\left( 1\; +\; \sqrt{5} \right)^{^{n}}\; -\; \left( 1\; -\; \sqrt{5} \right)^{^{n}}}{2^{^{n}}\sqrt{5}}$</p>
<p>Áp dụng 2 công thức trên, chúng ta có thể loại bỏ hoàn toàn việc sử dụng đệ quy hoặc vòng lặp, và điều này sẽ cải thiện tốc độ tính toán một cách đáng kể.</p>
<p>Một nhược điểm duy nhất của cách này là việc tính toán với căn bậc 2 trên máy tính sẽ dẫn tới tình trạng làm tròn số và sẽ xuất hiện sai số nhất định khiến cho giá trị không thực sự chính xác.</p>
<p>Tuy nhiên đây cũng là một trong những ví dụ cho việc ứng dụng toán học vào lập trình để giúp giải quyết vấn đề một cách hiệu quả hơn. </p>

                <div class="fb-like" data-href="http://huytd.github.io/posts/fibonacci-4m.html" data-layout="standard" data-action="like" data-show-faces="true" data-share="true"></div>
                <div id="disqus_thread"></div>
                <script>
                /**
                * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
                * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
                */
                /*
                var disqus_config = function () {
                this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
                this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                };
                */
                (function() { // DON'T EDIT BELOW THIS LINE
                var d = document, s = d.createElement('script');

                s.src = '//huysblog.disqus.com/embed.js';

                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
                })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
            </div>
        </div>
	    <div class="footer">
            <p>Created with <a href="http://github.com/huytd/azeroth-js">azeroth.js</a></p>
            <div class="social">
                <a target="_blank" href="http://facebook.com/kingbazoka"><i class="icon-facebook-squared"></i></a>
                <a target="_blank" href="http://twitter.com/huydotnet"><i class="icon-twitter-squared"></i></a>
                <a target="_blank" href="http://github.com/huytd"><i class="icon-github-squared"></i></a>
                <a target="_blank" href="https://thefullsnack.com"><i class="icon-emo-coffee"></i></a>
            </div>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-71353335-1', 'auto');
          ga('send', 'pageview');
        </script>
        <script>
          window.fbAsyncInit = function() {
            FB.init({
              appId      : '462066520669072',
              xfbml      : true,
              version    : 'v2.6'
            });

            FB.Event.subscribe('edge.create', function(url) {
              ga('send', 'social', 'facebook', 'like', url);
            });
          };

          (function(d, s, id){
             var js, fjs = d.getElementsByTagName(s)[0];
             if (d.getElementById(id)) {return;}
             js = d.createElement(s); js.id = id;
             js.src = "//connect.facebook.net/en_US/sdk.js";
             fjs.parentNode.insertBefore(js, fjs);
           }(document, 'script', 'facebook-jssdk'));
        </script>
        <script id="dsq-count-scr" src="//huysblog.disqus.com/count.js" async></script>
        <script type="text/javascript" async src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>
        <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
        });
        </script>
    </body>
</html>
