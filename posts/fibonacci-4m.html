<html>
    <head>
        <title> T√≠nh t·ªïng c√°c s·ªë Fibonacci t·ª´ 1 t·ªõi 4 tri·ªáu | Huy's Blog</title>
        <meta charset="utf-8">
        <meta http-equiv="content-type" content="text/html;"><meta name=viewport content="initial-scale=1.0 maximum-scale=1.0">
        
        <link href="../css/inconsolata.css" rel="stylesheet" type="text/css">
        <link href="../css/theme.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="../css/highlight/tomorrow.css">
        <link rel="stylesheet" href="../css/fontello.css">
        <script src="../js/highlight.pack.js"></script>
        <script src="../js/autosizing.js"></script>
        <script>
        hljs.initHighlightingOnLoad();
        </script>
    </head>
    <body>
        <div class="header">
            <a href="/"><i class="icon icon-emo-coffee"></i> Huy's Blog</a>
        </div>
        <div class="container">
            <div class="main">
                <h1 id="t-nh-t-ng-c-c-s-fibonacci-t-1-t-i-4-tri-u">T√≠nh t·ªïng c√°c s·ªë Fibonacci t·ª´ 1 t·ªõi 4 tri·ªáu</h1>
<p>Cu·ªëi tu·∫ßn n√†y c√≥ n√≥i chuy·ªán v·ªõi b√°c <a href="http://kipalog.com/users/nguyenduyhao1111/mypage">@haond</a> v·ªÅ m·ªôt ƒë·ªÅ t√†i kh√° l√† th√∫ v·ªã, ƒë√≥ l√† b√†i to√°n: <strong>T√≠nh t·ªïng c√°c s·ªë Fibonacci t·ª´ 1 t·ªõi 4 tri·ªáu</strong></p>
<h2 id="gi-i-ph-p-n-gi-n">Gi·∫£i ph√°p ƒë∆°n gi·∫£n</h2>
<p>ƒê·ªÉ t√≠nh m·ªôt s·ªë Fibonacci th√¨ c·ª±c k√¨ ƒë∆°n gi·∫£n, ch·ªâ c·∫ßn l√†m theo c√¥ng th·ª©c: </p>
<pre class="math">
$F_{n}=F_{n-1}+F_{n-2}$
</pre>

<p>Code th√¨ kh√° l√† ƒë∆°n gi·∫£n b·∫±ng c√°ch d√πng ƒë·ªá quy: </p>
<pre><code>func Fibonacci(n: Int) -&gt; Int {
  if n &lt;= 2 {
    return 1
  }
  return Fibonacci(n - 1) + Fibonacci(n - 2)
}
</code></pre><p>Ho·∫∑c d√πng v√≤ng l·∫∑p ƒë·ªÉ kh·ª≠ ƒë·ªá quy:</p>
<pre><code>func Fibonacci(n: Int) -&gt; Int {
  var a = 0
  var b = 1
  var next = 0
  for i in 0..&lt;n {
    if i &lt;= 1 {
      next = i
    } else {
      next = a + b
      a = b
      b = next
    }
  }
  return next
}
</code></pre><p>Quay l·∫°i b√†i to√°n t√≠nh t·ªïng c√°c s·ªë Fibonacci, ta c√≥ th·ªÉ implement m·ªôt h√†m t√≠nh t·ªïng ƒë∆°n gi·∫£n nh∆∞ sau:</p>
<pre><code>func Sum(n: Int) -&gt; Int {
  var sum = 0
  for i in 0..&lt;n {
    sum += Fibonacci(n)  
  }
  return sum
}
</code></pre><p>Tuy nhi√™n th√¨ v·ªõi thu·∫≠t to√°n nh∆∞ v·∫≠y, ch√∫ng ta c√≥ g·∫∑p ph·∫£i v·∫•n ƒë·ªÅ g√¨ kh√¥ng? </p>
<p>C√¢u tr·∫£ l·ªùi l√† c√≥, v·∫•n ƒë·ªÅ r·∫•t l·ªõn!</p>
<p>ƒê·∫ßu ti√™n h√£y nh√¨n v√†o ƒë·ªì th·ªã bi·ªÉu di·ªÖn th·ªùi gian c·∫ßn ƒë·ªÉ t√≠nh Fibonacci d∆∞·ªõi ƒë√¢y:</p>
<p><img src="img/fibonacci.png" alt=""></p>
<p>D·ªÖ nh·∫≠n th·∫•y, v·ªõi s·ªë n c√†ng l·ªõn, th√¨ th·ªùi gian ƒë·ªÉ t√≠nh Fibonacci c·ªßa s·ªë ƒë√≥ c√†ng l√¢u.</p>
<p>Cho n√™n ƒë·ªëi v·ªõi b√†i to√°n ·ªü ƒë√¢y l√† t√≠nh t·ªïng c√°c s·ªë Fibonacci t·ª´ 1 t·ªõi 4 tri·ªáu, th√¨ x√©t v·ªÅ y·∫øu t·ªë th·ªùi gian, ƒëi·ªÅu n√†y c≈©ng tr·ªü th√†nh m·ªôt v·∫•n ƒë·ªÅ b·∫•t kh·∫£ thi r·ªìi. ƒê·ªÉ gi·∫£i quy·∫øt b√†i to√°n n√†y, ch√∫ng ta c·∫ßn ph·∫£i lo·∫°i tr·ª´ ƒë∆∞·ª£c v·∫•n ƒë·ªÅ th·ªùi gian do ch·∫°y ƒë·ªá quy ho·∫∑c vi·ªác l·∫∑p g√¢y ra.</p>
<p>V√¨ m·ªçi v·∫•n ƒë·ªÅ li√™n quan ƒë·∫øn s·ªë h·ªçc ƒë·ªÅu, hi·ªÉn nhi√™n, c√≥ th·ªÉ bi·ªÉu di·ªÖn ƒë∆∞·ª£c b·∫±ng to√°n h·ªçc, v·∫≠y ƒë√¢y c≈©ng kh√¥ng ph·∫£i l√† ngo·∫°i l·ªá, h√£y xem ch√∫ng ta c√≥ th·ªÉ m∆∞·ª£n ƒë∆∞·ª£c g√¨ t·ª´ to√°n n√†o.</p>
<h2 id="c-ng-th-c-t-nh-t-ng-n-s-fibonacci">C√¥ng th·ª©c t√≠nh t·ªïng n s·ªë Fibonacci</h2>
<p>Ch√∫ng ta c√≥ c√¥ng th·ª©c t√≠nh t·ªïng n s·ªë Fibonacci v·ªõi m·ªçi s·ªë n &gt;= 2 nh∆∞ sau:</p>
<pre class="math">
$\mbox{S}_{n}\;=\;\sum_{i=1}^{n}{F_{i}}=\;F_{n+2}\; -\; 1$
</pre>

<p>N·∫øu kh√¥ng tin t∆∞·ªüng v√†o c√¥ng th·ª©c, th√¨ c√°c b·∫°n c√≥ th·ªÉ tham kh·∫£o <a href="https://proofwiki.org/wiki/Sum_of_Sequence_of_Fibonacci_Numbers#Proof">ch·ª©ng minh c√¥ng th·ª©c t·∫°i ƒë√¢y</a></p>
<p>V·∫≠y ƒë·ªÉ t√≠nh t·ªïng c√°c s·ªë Fibonacci t·ª´ 1 t·ªõi 4 tri·ªáu, ch√∫ng ta c√≥ th·ªÉ <strong>t√¨m s·ªë Fibonacci th·ª© 4 tri·ªáu l·∫ª 2 (4,000,002) r·ªìi tr·ª´ gi√° tr·ªã n√†y ƒëi cho 1</strong>. B√†i to√°n quay tr·ªü v·ªÅ t√¨m m·ªôt s·ªë Fibonacci b·∫•t k√¨.</p>
<p>Tuy nhi√™n, 4 tri·ªáu l·∫ª 2 v·∫´n l√† m·ªôt con s·ªë qu√° l·ªõn ƒë·ªÉ c√≥ th·ªÉ t√≠nh to√°n b√¨nh th∆∞·ªùng tr√™n m·ªôt m√°y t√≠nh c√° nh√¢n (v·ªõi c√°c y·∫øu t·ªë nh∆∞: t·ªëc ƒë·ªô x·ª≠ l√Ω, gi·ªõi h·∫°n b·ªô nh·ªõ, gi·ªõi h·∫°n c·ªßa ki·ªÉu d·ªØ li·ªáu,...). Ch√∫ng ta c·∫ßn t√¨m m·ªôt gi·∫£i ph√°p kh√°c √≠t t·ªën k√©m h∆°n.</p>
<h2 id="c-ng-th-c-t-m-m-t-s-fibonacci-b-t-k-">C√¥ng th·ª©c t√¨m m·ªôt s·ªë Fibonacci b·∫•t k√¨</h2>
<h3 id="s-d-ng-c-ng-th-c-binet">S·ª≠ d·ª•ng c√¥ng th·ª©c Binet</h3>
<p>Ch√∫ng ta c√≥ th√™m c√¥ng th·ª©c <a href="http://mathworld.wolfram.com/BinetsFibonacciNumberFormula.html">Binet</a> ƒë·ªÉ t√¨m m·ªôt s·ªë Fibonacci b·∫•t k√¨ nh∆∞ sau:</p>
<pre class="math">
$F_{n}\;=\;\frac{\phi ^{n}\; -\; \left( -\phi  \right)^{-n}}{\sqrt{5}}$
</pre>

<p>Chi ti·∫øt v·ªÅ k√≠ hi·ªáu <code class="math">$\phi$</code> (phi): Xem <a href="http://mathworld.wolfram.com/GoldenRatio.html">t·ªâ l·ªá v√†ng</a></p>
<p>C√¥ng th·ª©c tr√™n c√≥ th·ªÉ ƒë∆∞·ª£c khai tri·ªÉn th√†nh: </p>
<pre class="math">
$F_{n}\;=\;\frac{\left( 1\; +\; \sqrt{5} \right)^{^{n}}\; -\; \left( 1\; -\; \sqrt{5} \right)^{^{n}}}{2^{^{n}}\sqrt{5}}$
</pre>

<p>√Åp d·ª•ng 2 c√¥ng th·ª©c tr√™n, ch√∫ng ta c√≥ th·ªÉ lo·∫°i b·ªè ho√†n to√†n vi·ªác s·ª≠ d·ª•ng ƒë·ªá quy ho·∫∑c v√≤ng l·∫∑p, v√† ƒëi·ªÅu n√†y s·∫Ω c·∫£i thi·ªán t·ªëc ƒë·ªô t√≠nh to√°n m·ªôt c√°ch ƒë√°ng k·ªÉ.</p>
<p>C√°ch implement th√¨ c·ª±c k√¨ ƒë∆°n gi·∫£n: </p>
<pre><code>import Foundation

func Fibonacci(n: Double) -&gt; Double {
  return (pow((1.0 + sqrt(5.0)), n) - pow((1.0 - sqrt(5.0)), n)) / (pow(2.0, n) * sqrt(5.0))
}

func Sum(n: Double) -&gt; Double {
  return Fibonacci(n: n + 2.0) - 1.0
}
</code></pre><p>M·ªôt nh∆∞·ª£c ƒëi·ªÉm duy nh·∫•t c·ªßa c√°ch n√†y l√† vi·ªác t√≠nh to√°n v·ªõi cƒÉn b·∫≠c 2 tr√™n m√°y t√≠nh s·∫Ω d·∫´n t·ªõi t√¨nh tr·∫°ng l√†m tr√≤n s·ªë v√† s·∫Ω xu·∫•t hi·ªán sai s·ªë nh·∫•t ƒë·ªãnh khi·∫øn cho gi√° tr·ªã kh√¥ng th·ª±c s·ª± ch√≠nh x√°c.</p>
<h3 id="s-d-ng-ma-tr-n">S·ª≠ d·ª•ng ma tr·∫≠n</h3>
<p>Sau khi vi·∫øt b√†i n√†y th√¨ ƒë∆∞·ª£c a <a href="http://kipalog.com/users/kiennt/mypage">@kiennt</a> gi·ªõi thi·ªáu th√™m m·ªôt c√°ch kh√°c, ƒë√≥ l√† d√πng ma tr·∫≠n.</p>
<p>Quay tr·ªü l·∫°i c√¥ng th·ª©c t√≠nh m·ªôt s·ªë Fibonacci: </p>
<pre class="math">$F_{n}=F_{n-1}\; +\; F_{n-2}$</pre>

<p>ƒê·ªìng nghƒ©a v·ªõi: </p>
<pre class="math">$F_{n+2}=F_{n+1}+F_{n}$</pre>

<p>V√¨ v·∫≠y ta c√≥ th·ªÉ bi·ªÉu di·ªÖn d∆∞·ªõi d·∫°ng ma tr·∫≠n nh∆∞ sau:</p>
<pre class="math">
$\left[ \begin{array}{c} F_{n+2} \\ F_{n+1} \end{array} \right]\; =\; \left[ \begin{array}{c} F_{n+1}\; +\; F_{n} \\ F_{n+1} \end{array} \right]\; =\; \left[ \begin{array}{cc} 1 & 1 \\ 1 & 0 \end{array} \right]\; \left[ \begin{array}{c} F_{n+1} \\ F_{n} \end{array} \right]$
</pre>

<p>N·∫øu kh√¥ng tin th√¨ c√°c b·∫°n c·ª© th·ª≠ t·ª± ch·ª©ng minh ƒëi :3, ti·∫øp, ta c≈©ng c√≥ th·ªÉ vi·∫øt l·∫°i bi·ªÉu th·ª©c tr√™n th√†nh:</p>
<pre class="math">
$\left[ \begin{array}{c} F_{n+1} \\ F_{n} \end{array} \right]\; =\; \left[ \begin{array}{cc} 1 & 1 \\ 1 & 0 \end{array} \right]\; \left[ \begin{array}{c} F_{n} \\ F_{n-1} \end{array} \right]$
</pre>

<p>V√† sau khi th·ª±c hi·ªán m·ªôt v√†i ph√©p t√≠nh to√°n ƒë∆°n gi·∫£n tr√™n ma tr·∫≠n ch√∫ng ta thu ƒë∆∞·ª£c k·∫øt qu·∫£ sau:</p>
<pre class="math">
$\left[ \begin{array}{c} F_{n+1} \\ F_{n} \end{array} \right]\; =\; \left[ \begin{array}{cc} 1 & 1 \\ 1 & 0 \end{array} \right]^{n}\; \left[ \begin{array}{c} F_{1} \\ F_{0} \end{array} \right]$
</pre>

<p>V·ªõi <code>F(1) = 1</code> v√† <code>F(0) = 0</code>. B√†i to√°n quay tr·ªü v·ªÅ d·∫°ng b√†i to√°n nh√¢n 2 ma tr·∫≠n 2x2 v√† nh√¢n m·ªôt ma tr·∫≠n 2x2 v·ªõi m·ªôt ma tr·∫≠n 2x1. </p>
<p>D∆∞·ªõi ƒë√¢y l√† ƒëo·∫°n implement b·∫±ng Python c·ªßa a <a href="http://kipalog.com/users/kiennt/mypage">@kiennt</a>:</p>
<pre><code>def mul_metrix_1(m1, m2):
    return (
        m1[0][0] * m2[0] + m1[0][1] * m2[1],
        m1[1][0] * m2[0] + m1[1][1] * m2[1]
    )


def mul_matrix(m1, m2):
    &quot;&quot;&quot;
    matrix m1, m2 is 2x2 matrix which is respresend like
    ((r00, r01), (r10, r11))
    &quot;&quot;&quot;

    return (
        (m1[0][0] * m2[0][0] + m1[0][1] * m2[1][0], m1[0][0] * m2[0][1] + m1[0][1] * m2[1][1]),
        (m1[1][0] * m2[0][0] + m1[1][1] * m2[1][0], m1[1][0] * m2[0][1] + m1[1][1] * m2[1][1])
    )


def pow_matrix(m, n):
    &quot;&quot;&quot; m is 2x2 matrix &quot;&quot;&quot;
    if n == 1:
        return m
    elif n % 2 == 0:
        a = pow_matrix(m, n / 2)
        return mul_matrix(a, a)
    else:
        return mul_matrix(pow_matrix(m, n - 1), m)


def fibo(n):
    if n == 0:
        return 1
    if n == 1:
        return 1

    a = ((1, 1), (1, 0))
    an = pow_matrix(a, n)
    pair_0 = (1, 1)
    pair_n = mul_metrix_1(an, pair_0)
    return pair_n[1]


for i in xrange(2, 10):
    print fibo(i)
</code></pre><p>Xin ch√¢n th√†nh c·∫£m ∆°n ae nh√≥m <strong>#hardcore</strong> c·ªßa c·ªông ƒë·ªìng Ruby Vi·ªát Nam ƒë√£ t√≠ch c·ª±c th·∫£o lu·∫≠n ƒë·ªÉ t·ªïng h·ª£p th√†nh b√†i vi·∫øt n√†y.</p>
<p>Hy v·ªçng b√†i vi·∫øt ph·∫ßn n√†o gi√∫p cho c√°c b·∫°n nh·∫≠n ra s·ª± quan tr·ªçng c·ªßa vi·ªác ·ª©ng d·ª•ng to√°n h·ªçc, ƒë·∫∑c bi·ªát l√† vi·ªác s·ª≠ d·ª•ng ma tr·∫≠n v√†o gi·∫£i quy·∫øt c√°c b√†i to√°n ph·ª©c t·∫°p. Vi·∫øt xong b√†i t·ªïng h·ª£p n√†y m√¨nh v·∫´n c√≤n ng·ªìi v·∫Øt tay l√™n tr√°n m√† suy nghƒ©, gi√° m√† h·ªìi ƒë√≥ m√¨nh chƒÉm h·ªçc to√°n h∆°n th√¨ t·ªët bi·∫øt m·∫•y :joy:</p>
<div class='other-tags'><b>Tags:</b> <a class='topic-tag' href='https://huytd.github.io/tags/algorithm.html'>algorithm</a><a class='topic-tag' href='https://huytd.github.io/tags/math.html'>math</a></div>
                <div class="copyright">
                B·∫°n ƒë∆∞·ª£c t√πy √Ω b·∫•m like, tr√≠ch d·∫´n ho·∫∑c copy, post l·∫°i, nh∆∞ng vui l√≤ng ghi r√µ ngu·ªìn v√† t√°c gi·∫£ v√† kh√¥ng l√†m thay ƒë·ªïi n·ªôi dung b√†i vi·∫øt. N·∫øu kh√¥ng l√†m v·∫≠y, m√¨nh hy v·ªçng t·ª´ nay v·ªÅ sau b·∫°n s·∫Ω lu√¥n c·∫£m th·∫•y c·∫Øn r·ª©t l∆∞∆°ng t√¢m, ƒÉn kh√¥ng ngon, ng·ªß kh√¥ng y√™n. üòÜ
                </div>
                <!-- Comment -->
                <div class="comments">
                  <div id="comment-loading" class="loading"></div>
                  <div id="login-box" class="login">
                    B·∫°n c·∫ßn <button onclick="login()">Login</button> ƒë·ªÉ comment
                  </div>
                  <div id="comment-box" class="comment-input">
                    <div class="avatar">
                      <img id="user-avatar" src="" width="32" height="32"/>
                    </div>
                    <div class="input">
                      <textarea id="comment-content" onkeyup="autoSizing(this)" onkeydown="submitComment(event)" placeholder="Comment g√µ v√†o ƒë√¢y :D"></textarea>
                      <span>G√µ xong nh·∫•n <kbd>Ctrl</kbd> + <kbd>Enter</kbd> ƒë·ªÉ g·ª≠i.</span>
                    </div>
                  </div>
                  <ul id="comment-list" class="comment-list"></ul>
                </div>
                <!-- End Comment -->
            </div>
        </div>
	    <div class="footer">
            <p>Created with <a href="http://github.com/huytd/azeroth-js">azeroth.js</a></p>
            <div class="social">
                <a target="_blank" href="http://facebook.com/kingbazoka"><i class="icon-facebook-squared"></i></a>
                <a target="_blank" href="http://twitter.com/huydotnet"><i class="icon-twitter-squared"></i></a>
                <a target="_blank" href="http://github.com/huytd"><i class="icon-github-squared"></i></a>
                <a target="_blank" href="https://thefullsnack.com"><i class="icon-emo-coffee"></i></a>
            </div>
        </div>
        <script type="text/javascript" async src="https://cdn.rawgit.com/mathjax/MathJax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
        <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [['$','$'], ['\\(','\\)']],
            skipTags: ["script","noscript","style","textarea"]
          }
        });
        </script>
        <script src="https://www.gstatic.com/firebasejs/3.8.0/firebase.js"></script>
        <script>
          // Initialize Firebase
          var config = {
            apiKey: "AIzaSyA1PnIAlJJ-U6iQJMNnCOknBuziBqGMYcY",
            authDomain: "huys-blog-comment.firebaseapp.com",
            databaseURL: "https://huys-blog-comment.firebaseio.com",
            projectId: "huys-blog-comment",
            storageBucket: "huys-blog-comment.appspot.com",
            messagingSenderId: "317330376829"
          };
          firebase.initializeApp(config);
        </script>
        <script>
          let provider = new firebase.auth.GoogleAuthProvider();
          let auth = firebase.auth();
          let currentUser = null;
          let postCommentURL = 'posts/fibonacci-4m/comments';

          auth.onAuthStateChanged(function(user) {
            document.getElementById("comment-loading").style.display = "none";
            if (user) {
              currentUser = user;
              // Logged in
              document.getElementById("login-box").style.display = "none";
              document.getElementById("comment-box").style.display = "flex";
              document.getElementById("user-avatar").setAttribute("src", user.photoURL);
            } else {
              // Not login yet
              document.getElementById("comment-box").style.display = "none";
              document.getElementById("login-box").style.display = "block";
            }
          });

          const login = function() {
            auth.signInWithPopup(provider)
              .then(function(result) {
              }).catch(function(err) {
              });
          };

          const encodeHTML = function(s) {
            return s.replace(/</g, '&lt;').replace(/"/g, '&quot;').replace(/>/g, '&gt;');
          };

          const saveNewComment = function(comment) {
            if (!currentUser) {
              return;
            }
            let commentData = {
              user: currentUser.displayName,
              avatar: currentUser.photoURL,
              time: (new Date()).toISOString(),
              message: encodeHTML(comment)
            };
            database.ref(postCommentURL).push(commentData);
            document.getElementById("comment-content").value = "";
          };

          const submitComment = function(e) {
            let keyCode = e.which || e.keyCode;
            let ctrlCode = e.ctrlKey || e.metaKey;
            if (keyCode === 13 && ctrlCode) {
              let comment = document.getElementById("comment-content").value;
              saveNewComment(comment);
            }
          };

          const filterURLinComment = function(comment) {
            return comment.replace(/(https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9]\.[^\s]{2,})/g, "<a target='_blank' rel='noopener noreferrer' href='$1'>$1</a>");
          };

          const addNewComment = function(user, avatar, time, comment) {
            let commentFiltered = encodeHTML(comment);
            commentFiltered = filterURLinComment(commentFiltered);
            let d = new Date(time);
            let commentTime = d.toLocaleTimeString() + ' ' + d.toLocaleDateString();
            let html = '<div class="avatar">' +
              '   <img src="' + avatar + '" width="32" height="32"/>' +
              ' </div>' +
              '<div class="comment">' +
              '  <div class="metadata"><b>' + user + '</b> l√∫c <span>' + commentTime + '</span></div>' +
              '  <div class="content">' + commentFiltered
              '  </div>' +
              '</div>';
            let li = document.createElement('li');
            li.innerHTML = html;
            document.getElementById("comment-list").append(li);
          };

          let database = firebase.database();
          let posts = database.ref(postCommentURL).orderByChild('time');
          posts.on('child_added', function(data) {
            addNewComment(data.val().user, data.val().avatar, data.val().time, data.val().message);
          });
        </script>
    </body>
</html>
