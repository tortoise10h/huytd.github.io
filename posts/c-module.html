<html>
    <head>
        <title> Thiáº¿t káº¿ hÆ°á»›ng Module trong C | Huy's Blog</title>
        <meta charset="utf-8">
        <meta http-equiv="content-type" content="text/html;"><meta name=viewport content="initial-scale=1.0 maximum-scale=1.0">
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inconsolata:400,700">
        <link href='https://fonts.googleapis.com/css?family=Noto+Serif:400,400italic,700,700italic&subset=latin,vietnamese' rel='stylesheet' type='text/css'>
        <link href="../css/theme.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="../css/highlight/tomorrow.css">
        <link rel="stylesheet" href="../css/fontello.css">
        <script src="../js/highlight.pack.js"></script>
        <script>
        hljs.initHighlightingOnLoad();
        </script>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    </head>
    <body>
        <div class="header">
            <a href="/"><i class="icon icon-emo-coffee"></i> Huy's Blog</a>
        </div>
        <div class="container">
            <div class="main">
                <h1 id="thi-t-k-h-ng-module-trong-c">Thiáº¿t káº¿ hÆ°á»›ng Module trong C</h1>
<p>C cÃ³ láº½ lÃ  má»™t ngÃ´n ngá»¯ khÃ´ng láº¡ Ä‘á»‘i vá»›i táº¥t cáº£ má»i ngÆ°á»i, nháº¥t lÃ  cÃ¡c báº¡n sinh viÃªn cÃ¡c nÄƒm Ä‘áº§u vÃ  cÃ¡c báº¡n há»c sinh cáº¥p 3, vÃ¬ Ä‘Ã¢y lÃ  quÃ£ng thá»i gian chÃºng ta sá»­ dá»¥ng C nhiá»u nháº¥t -- Ä‘á»ƒ giáº£i bÃ i táº­p.</p>
<p>Tuy nhiÃªn sáº½ tháº¿ nÃ o náº¿u chÃºng ta sá»­ dá»¥ng C vÃ  Ã¡p dá»¥ng vÃ o cÃ´ng viá»‡c thá»±c táº¿? lÆ°u Ã½ á»Ÿ Ä‘Ã¢y mÃ¬nh nÃ³i vá» C chá»© khÃ´ng pháº£i C++ nhÃ©. Cá»¥ thá»ƒ lÃ  phÃ¡t triá»ƒn cÃ¡c á»©ng dá»¥ng lá»›n báº±ng C? nghe cÃ³ váº» Ä‘iÃªn rá»“ quÃ¡ khÃ´ng? </p>
<h2 id="c-ai-l-m-v-y-kh-ng-">CÃ³ ai lÃ m váº­y khÃ´ng?</h2>
<p>CÃ¢u tráº£ lá»i lÃ  cÃ³. Ráº¥t nhiá»u lÃ  Ä‘áº±ng khÃ¡c. Äá»ƒ xem ai nÃ o...</p>
<p>Äáº§u tiÃªn pháº£i ká»ƒ Ä‘áº¿n Ä‘Ã³ lÃ  <a href="https://github.com/torvalds/linux">nhÃ¢n há»‡ Ä‘iá»u hÃ nh Linux</a> vÃ  <a href="https://github.com/git/git">git</a>, cáº£ 2 sáº£n pháº©m quan trá»ng nÃ y Ä‘á»u Ä‘Æ°á»£c viáº¿t hoÃ n toÃ n báº±ng <strong>C</strong> bá»Ÿi <strong>Linus Torvalds</strong> vÃ  Ä‘Ã¢y lÃ  má»™t <a href="http://harmful.cat-v.org/software/c++/linus">C++ hater cÃ³ tiáº¿ng</a>.</p>
<p>Káº¿ Ä‘áº¿n cÃ³ thá»ƒ nÃ³i Ä‘áº¿n <a href="https://github.com/curl/curl">curl</a>, cÃ´ng cá»¥ mÃ  báº¥t cá»© ai xÃ i há»‡ Ä‘iá»u hÃ nh unix-like nhÆ° cÃ¡c thá»ƒ loáº¡i Linux hay macOS Ä‘á»u tá»«ng xÃ i qua, cÅ©ng Ä‘Æ°á»£c viáº¿t chá»§ yáº¿u báº±ng <strong>C</strong>.</p>
<p>Trong tháº¿ giá»›i cá»§a cÃ¡c web developer, cÃ³ thá»ƒ ká»ƒ Ä‘áº¿n <a href="https://github.com/antirez/redis">redis</a>, <a href="https://github.com/nginx/nginx">nginx</a>, <a href="https://github.com/openssl/openssl">openssl</a> Ä‘á»u Ä‘Æ°á»£c viáº¿t báº±ng <strong>C</strong>.</p>
<p>ChÆ°a háº¿t, ngoÃ i ra cÃ²n cÃ³ <a href="https://github.com/libuv/libuv">libuv</a>, bá»™ thÆ° viá»‡n Ä‘á»©ng Ä‘áº±ng sau sá»± thÃ nh cÃ´ng cá»§a cÆ¡ cháº¿ Async I/O táº¡o nÃªn tÃªn tuá»•i cá»§a NodeJS (táº¥t nhiÃªn chá»‰ lÃ  trong giá»›i frontend dev thÃ´i =)))) cÅ©ng Ä‘Æ°á»£c xÃ¢y dá»±ng báº±ng <strong>C</strong> ná»‘t.</p>
<p>á»’, cÃ²n ná»¯a, ngay cáº£ ngÃ´n ngá»¯ <a href="https://github.com/ruby/ruby">ruby</a> vá»‘n Ä‘Ã£ quÃ¡ ná»•i tiáº¿ng khÃ´ng cáº§n nÃ³i thÃªm ná»¯a, cÅ©ng Ä‘Æ°á»£c Matz xÃ¢y dá»±ng báº±ng <strong>C</strong> luÃ´n Ä‘áº¥y.</p>
<p>PhÃ¨o, ká»ƒ nhiá»u má»i tay quÃ¡, viáº¿t Ä‘áº¿n Ä‘Ã¢y tá»± dÆ°ng cáº£m tháº¥y gáº§n nhÆ° toÃ n bá»™ tháº¿ giá»›i Ä‘Ã£ Ä‘Æ°á»£c xÃ¢y dá»±ng báº±ng <strong>C</strong> rá»“i, táº¡i sao mÃ¬nh láº¡i lang thang Ä‘i code Swift vá»›i Java lÃ m gÃ¬ nhá»‰ ğŸ”</p>
<h2 id="ok-v-y-gi-v-ch-ch-nh-i-">OK, váº­y giá» vÃ´ chá»§ Ä‘á» chÃ­nh Ä‘i...</h2>
<p>BÃ¢y giá» chÃºng ta sáº½ cÃ¹ng tÃ¬m hiá»ƒu lÃ m tháº¿ nÃ o Ä‘á»ƒ viáº¿t Ä‘Æ°á»£c cÃ¡c á»©ng dá»¥ng lá»›n nhÆ° nhá»¯ng vÃ­ dá»¥ Ä‘Ã£ nÃªu á»Ÿ trÃªn, chá»‰ báº±ng cÃ¡ch sá»­ dá»¥ng má»™t ngÃ´n ngá»¯ khÃ´ng há» cÃ³ nhá»¯ng chá»©c nÄƒng gÃ¬ tiÃªu biá»ƒu nhÆ° lÃ  class, hay template,... nhÆ° C.</p>
<p>ThÃ´ng thÆ°á»ng, khi viáº¿t má»™t chÆ°Æ¡ng trÃ¬nh C thÃ¬ chÃºng ta sáº½ thá»±c hiá»‡n nhÆ° mÃ´ hÃ¬nh sau:</p>
<p><img src="img/write-C-old.png" alt=""></p>
<p>ChÆ°Æ¡ng trÃ¬nh Ä‘Æ°á»£c viáº¿t táº¡i file <strong>main.c</strong> vÃ  sau khi biÃªn dá»‹ch, chÃºng ta cÃ³ má»™t file binary cÃ³ thá»ƒ cháº¡y Ä‘Æ°á»£c, Ä‘á»‹nh dáº¡ng file nÃ y nhÆ° tháº¿ nÃ o lÃ  tÃ¹y vÃ o há»‡ Ä‘iá»u hÃ nh Ä‘Ã­ch mÃ  chÃºng ta chá»‰ Ä‘á»‹nh Ä‘á»ƒ biÃªn dá»‹ch.</p>
<p>ChÆ°Æ¡ng trÃ¬nh cÃ ng lá»›n, file <strong>main.c</strong> cÃ ng to, thá»i gian biÃªn dá»‹ch cÃ ng cháº­m, Ä‘Ã³ lÃ  lÃ½ do táº¡i sao chÃºng ta nÃªn phÃ¢n tÃ¡ch ra thÃ nh tá»«ng module nhá», thao tÃ¡c nÃ y gá»i lÃ  Modularity.</p>
<h3 id="modularity-l-g-">Modularity lÃ  gÃ¬?</h3>
<p>Modularity lÃ  phÆ°Æ¡ng phÃ¡p tá»• chá»©c má»™t chÆ°Æ¡ng trÃ¬nh lá»›n thÃ nh nhiá»u pháº§n nhá» hÆ¡n, gá»i lÃ  tá»«ng <strong>module</strong>. Má»—i module sáº½ gá»“m má»™t file <strong>header (*.h)</strong> chá»©a cÃ¡c Ä‘á»‹nh nghÄ©a, khai bÃ¡o biáº¿n, prototype, cÃ¡c kiá»ƒu,... vÃ  má»™t file <strong>implementation (*.c)</strong> Ä‘á»ƒ hiá»‡n thá»±c hÃ³a cÃ¡c prototype trong header, má»¥c Ä‘Ã­ch chÃ­nh lÃ  Ä‘á»ƒ giáº¥u Ä‘i pháº§n code thá»±c sá»± cá»§a nÃ³ vÃ  giáº¥u luÃ´n cÃ¡c thuá»™c tÃ­nh private cá»§a tá»«ng module.</p>
<p><img src="img/write-C-module.png" alt=""></p>
<p>á» pháº§n sau chÃºng ta sáº½ nÃ³i rÃµ hÆ¡n vá» cÃ¡ch tá»• chá»©c bÃªn trong má»™t module. </p>
<p>SÆ¡ Ä‘á»“ bÃªn dÆ°á»›i cho chÃºng ta tháº¥y cÃ¡ch tá»• chá»©c cá»§a má»™t project sá»­ dá»¥ng nhiá»u module:</p>
<p><img src="img/write-C-module-layout.png" alt=""></p>
<p>Trong sÆ¡ Ä‘á»“ nÃ y, chÃºng ta cÃ³ 2 module <code>mod_a</code> vÃ  <code>mod_b</code> Ä‘Æ°á»£c khai bÃ¡o báº±ng cÃ¡c file .h vÃ  .c tÆ°Æ¡ng á»©ng. Khi biÃªn dá»‹ch, cÃ¡c module nÃ y sáº½ Ä‘Æ°á»£c trÃ¬nh biÃªn dá»‹ch build thÃ nh cÃ¡c file <strong>mod_a.o</strong> vÃ  <strong>mod_b.o</strong></p>
<p>MÅ©i tÃªn mÃ u xanh nÆ°á»›c biá»ƒn chá»‰ quÃ¡ trÃ¬nh biÃªn dá»‹ch, mÅ©i tÃªn mÃ u xanh lá»¥c chá»‰ quÃ¡ trÃ¬nh <strong>Linking</strong>.</p>
<div class="box-white" style="padding: 15px;">
<strong>Side note</strong><br/><hr/>
<strong>Há»i:</strong> Má»™t chÆ°Æ¡ng trÃ¬nh C Ä‘Æ°á»£c biÃªn dá»‹ch nhÆ° tháº¿ nÃ o?<br/>
<strong>ÄÃ¡p:</strong> Má»™t chÆ°Æ¡ng trÃ¬nh C Ä‘Æ°á»£c biÃªn dá»‹ch thÃ´ng qua 4 bÆ°á»›c: <strong>Pre-processing</strong>, <strong>Compilation</strong>, <strong>Assembly</strong> vÃ  <strong>Linking</strong><br/>
<img src="img/c-compilation.png" alt="">
BÆ°á»›c <strong>pre-processing</strong> cÃ³ nhiá»‡m vá»¥ ghÃ©p ná»‘i toÃ n bá»™ cÃ¡c file header Ä‘Æ°á»£c include, cÃ¡c macro,... thÃ nh má»™t bá»™ source thá»‘ng nháº¥t vÃ  chuyá»ƒn qua bÆ°á»›c <strong>compilation</strong>, bÆ°á»›c nÃ y, trÃ¬nh biÃªn dá»‹ch sáº½ &quot;dá»‹ch&quot; file source, chuyá»ƒn nÃ³ thÃ nh mÃ£ mÃ¡y (assembler code), bÆ°á»›c <strong>assembly</strong> nháº­n chÆ°Æ¡ng trÃ¬nh assembler tá»« bÆ°á»›c 2, build thÃ nh tá»«ng file <strong>object (*.o)</strong>, cÃ¡c file object nÃ y sáº½ Ä‘Æ°á»£c chuyá»ƒn qua <strong>linker</strong> (má»™t cÃ´ng cá»¥ giÃºp káº¿t ná»‘i cÃ¡c file object) vÃ  táº¡o thÃ nh má»™t file thá»±c thi duy nháº¥t Ä‘á»ƒ cháº¡y.
</div>

<h3 id="l-i-ch-c-a-modularity-l-g-">Lá»£i Ã­ch cá»§a Modularity lÃ  gÃ¬?</h3>
<p>Viá»‡c phÃ¢n chia chÆ°Æ¡ng trÃ¬nh ra thÃ nh nhiá»u module cÃ³ ráº¥t nhiá»u Æ°u Ä‘iá»ƒm, Ä‘áº·c biá»‡t lÃ  Ä‘á»‘i vá»›i nhá»¯ng á»©ng dá»¥ng lá»›n vÃ  phá»©c táº¡p:</p>
<ul>
<li>CÃ¡c module cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng láº¡i trong nhiá»u project khÃ¡c</li>
<li>Náº¿u pháº§n implementation cá»§a module cÃ³ thay Ä‘á»•i, mÃ  khÃ´ng lÃ m thay Ä‘á»•i interface nÃ³ cung cáº¥p thÃ¬ khÃ´ng cáº§n thiáº¿t pháº£i compile láº¡i toÃ n bá»™ chÆ°Æ¡ng trÃ¬nh (chá»‰ compile module Ä‘Ã³ thÃ´i)</li>
<li>Compile láº¡i nhanh hÆ¡n (nhÆ° Ä‘Ã£ nÃ³i á»Ÿ trÃªn)</li>
<li>Self-documenting - Chá»‰ cáº§n nhÃ¬n vÃ o file header thÃ¬ sáº½ biáº¿t Ä‘Æ°á»£c cÃ¡ch dÃ¹ng vÃ  cÃ¡c chá»©c nÄƒng mÃ  module cung cáº¥p </li>
<li>Dá»… debug. VÃ¬ tÃ¡ch biá»‡t vÃ  hoáº¡t Ä‘á»™ng Ä‘á»™c láº­p nÃªn má»—i module cÃ³ thá»ƒ Ä‘Æ°á»£c test riÃªng biá»‡t, debug riÃªng biá»‡t.</li>
<li>Má»™t sá»‘ trÃ¬nh biÃªn dá»‹ch C hiá»‡n Ä‘áº¡i cÃ³ thá»ƒ generate code nhanh hÆ¡n vÃ  tá»‘i Æ°u tá»‘t hÆ¡n khi chÃºng ta modularity.</li>
</ul>
<h3 id="modularity-nh-th-n-o-">Modularity nhÆ° tháº¿ nÃ o?</h3>
<p>Modularity tá»©c lÃ  chÃºng ta chia source code thÃ nh nhiá»u file module, má»—i module gá»“m má»™t file source (.c) vÃ  header (.h). </p>
<p>File header sáº½ chá»©a má»i thÃ nh pháº§n <strong>public</strong> cá»§a module, nhÆ° lÃ  cÃ¡c háº±ng sá»‘, thuá»™c tÃ­nh, cÃ¡c hÃ m chÃºng ta muá»‘n sá»­ dá»¥ng (chá»‰ khai bÃ¡o á»Ÿ dáº¡ng prototype), tuyá»‡t Ä‘á»‘i khÃ´ng implement bÃªn trong file header.</p>
<p><img src="img/write-C-headers.png" alt=""></p>
<p>CÃ¡c thÃ nh pháº§n khÃ¡c nhÆ° implementation, cÃ¡c thÃ nh pháº§n <strong>private</strong> sáº½ Ä‘Æ°á»£c Ä‘Æ°a vÃ o source file (.c), vÃ¬ khi thiáº¿t káº¿ theo module, cÃ¡c chÆ°Æ¡ng trÃ¬nh/module cáº§n sá»­ dá»¥ng module Ä‘ang xÃ©t khÃ´ng cáº§n thiáº¿t pháº£i biáº¿t pháº§n logic bÃªn dÆ°á»›i cá»§a module nÃ y lÃ m gÃ¬.</p>
<h4 id="header-file-c-g-">Header file cÃ³ gÃ¬?</h4>
<p>BÆ°á»›c Ä‘áº§u tiÃªn khi thiáº¿t káº¿ má»™t module Ä‘Ã³ lÃ  tá»• chá»©c file Header cá»§a module Ä‘Ã³.</p>
<p>File header ngoÃ i má»¥c Ä‘Ã­ch Ä‘á»‹nh nghÄ©a cÃ¡c thÃ nh pháº§n cáº§n thiáº¿t cho quÃ¡ trÃ¬nh pre-processing, nÃ³ cÃ²n cÃ³ tÃ¡c dá»¥ng lÃ m cÃ´ng cá»¥ tham chiáº¿u cho cÃ¡c láº­p trÃ¬nh viÃªn khÃ¡c khi sá»­ dá»¥ng module cá»§a báº¡n.</p>
<p>Cáº¥u trÃºc má»™t file header thÆ°á»ng cÃ³ cÃ¡c pháº§n sau:</p>
<h5 id="copyright">Copyright</h5>
<p>Pháº§n nÃ y khÃ´ng nháº¥t thiáº¿t pháº£i cÃ³, nhÆ°ng náº¿u lÃ m cÃ¡c dá»± Ã¡n open source thÃ¬ báº¡n nÃªn bá»• sung cÃ¡c thÃ´ng tin nÃ y, Ä‘á»ƒ trÃ¡nh viá»‡c nháº­p nháº±ng vá» quyá»n sá»Ÿ há»¯u cÅ©ng nhÆ° viá»‡c sá»­ dá»¥ng cho cÃ¡c project khÃ¡c:</p>
<pre><code>/*
  mod_a.h -- Example of a C module
  Copyright 2016 by Huy Tran
  License: MIT
  Author: Huy Tran &lt;huy@gamarist.com&gt;
  Version: 2016-11-16
*/
</code></pre><p>CÃ¡c thÃ´ng tin gá»“m cÃ³: TÃªn module, chÃº thÃ­ch cho module, copyright, tÃªn loáº¡i giáº¥y phÃ©p (ráº¥t quan trá»ng), tÃªn tÃ¡c giáº£, version,...</p>
<p>CÃ³ nhiá»u ngÆ°á»i cÃ²n Ä‘Æ°a háº³n ná»™i dung giáº¥y phÃ©p sá»­ dá»¥ng vÃ o pháº§n header nÃ y luÃ´n, tuy nhiÃªn theo mÃ¬nh viá»‡c nÃ y khÃ´ng cáº§n thiáº¿t láº¯m, vÃ¬ tÃªn giáº¥y phÃ©p lÃ  Ä‘á»§ rá»“i.</p>
<h5 id="ch-ng-double-include">Chá»‘ng double include</h5>
<p>Pháº§n tiáº¿p theo, khÃ¡ lÃ  quan trá»ng, Ä‘Ã³ lÃ  define module flag Ä‘á»ƒ Ä‘Ã¡nh dáº¥u cho C pre-processor biáº¿t ráº±ng module Ä‘Ã£ Ä‘Æ°á»£c xá»­ lÃ½, trÃ¡nh viá»‡c include nhiá»u láº§n cÃ¹ng má»™t file.</p>
<pre><code>#ifndef _MODA_H_
#define _MODA_H_

// Body here

#endif
</code></pre><p>Khá»‘i lá»‡nh trÃªn dÃ¹ng lá»‡nh <code>#ifndef</code> Ä‘á»ƒ kiá»ƒm tra xem flag <code>_MODA_H_</code> Ä‘Ã£ tá»“n táº¡i hay chÆ°a, ban Ä‘áº§u thÃ¬ chÆ°a.</p>
<p>Náº¿u chÆ°a tá»“n táº¡i thÃ¬ sáº½ define flag nÃ y báº±ng lá»‡nh <code>#define</code>, vÃ  káº¿t thÃºc vá»›i lá»‡nh <code>#endif</code>.</p>
<p>Sau khi pre-processor xá»­ lÃ½ xong file header nÃ y, thÃ¬ flag <code>_MODA_H_</code> cÅ©ng Ä‘Ã£ Ä‘Æ°á»£c táº¡o xong, náº¿u láº§n sau cÃ³ má»™t module nÃ o Ä‘Ã³ tÃ¬nh cá» include láº¡i file header nÃ y, hoáº·c báº¡n vÃ´ tÃ¬nh include 2 láº§n liÃªn tiáº¿p á»Ÿ nhiá»u nÆ¡i, thÃ¬ cÅ©ng sáº½ khÃ´ng bá»‹ lá»—i khi xá»­ lÃ½.</p>
<h5 id="khai-b-o-macro-h-ng-s-">Khai bÃ¡o macro, háº±ng sá»‘</h5>
<p>Tiáº¿p theo, chÃºng ta dÃ¹ng lá»‡nh <code>#define</code> Ä‘á»ƒ khai bÃ¡o cÃ¡c macro cáº§n dÃ¹ng cho chÆ°Æ¡ng trÃ¬nh, á»Ÿ Ä‘Ã¢y thÃ¬ tÃ¹y module cáº§n gÃ¬ vÃ  define cho há»£p lÃ½.</p>
<p>VÃ­ dá»¥:</p>
<pre><code>/* mod_a.h -- Constants declarations */

#define MODA_HEX_RED   0xff0000
#define MODA_HEX_GREEN 0x00ff00
#define MODA_HEX_BLUE  0x0000ff

#define MODA_KEY_A     65
</code></pre><p>LÆ°u Ã½ lÃ  cÃ¡c macro, háº±ng sá»‘ Ä‘Æ°á»£c khai bÃ¡o trong file header sáº½ lÃ  public vÃ  tá»“n táº¡i trong toÃ n bá»™ chÆ°Æ¡ng trÃ¬nh sá»­ dá»¥ng nÃ³, vÃ¬ tháº¿ nÃªn trÃ¡nh Ä‘áº·t nhá»¯ng tÃªn macro dá»… gÃ¢y nháº·p nháº±ng, chá»“ng chÃ©o vá»›i cÃ¡c module khÃ¡c. </p>
<p>CÃ¡ch tá»‘t nháº¥t lÃ  Ä‘áº·t tÃªn theo dáº¡ng <code>&lt;TÃªn Module&gt;_&lt;Macro&gt;</code>.</p>
<h5 id="khai-b-o-ki-u">Khai bÃ¡o kiá»ƒu</h5>
<p>Pháº§n nÃ y chÃºng ta khai bÃ¡o cÃ¡c kiá»ƒu dá»¯ liá»‡u, struct, enum cáº§n dÃ¹ng cho module.</p>
<pre><code>/* mod_a.h -- Types declarations */

enum moda_direction {
  MODA_NORTH,
  MODA_EAST,
  MODA_SOUTH,
  MODA_WEST
};

typedef struct _moda_point {
  int x;
  int y;
} moda_point;
</code></pre><p>CÃ¡ch Ä‘áº·t tÃªn cÅ©ng tÆ°Æ¡ng tá»± nhÆ° á»Ÿ trÃªn.</p>
<h5 id="function-prototype">Function prototype</h5>
<p>ÄÃ¢y lÃ  pháº§n quan trá»ng nháº¥t trong má»™t module header, táº¡i Ä‘Ã¢y chÃºng ta khai bÃ¡o toÃ n bá»™ prototype cá»§a cÃ¡c phÆ°Æ¡ng thá»©c/hÃ m cáº§n dÃ¹ng bÃªn trong module. CÃ¡c láº­p trÃ¬nh viÃªn khÃ¡c cÃ³ thá»ƒ dá»±a vÃ o file nÃ y Ä‘á»ƒ sá»­ dá»¥ng module cá»§a báº¡n mÃ  khÃ´ng cáº§n pháº£i viáº¿t tÃ i liá»‡u chi tiáº¿t.</p>
<pre><code>/* mod_a.h -- Function prototypes */

void moda_init(void);
int moda_add(int a);
</code></pre><h4 id="source-file-c-g-">Source file cÃ³ gÃ¬?</h4>
<p>Source file (vÃ­ dá»¥: <strong>mod_a.c</strong>) sáº½ lÃ  pháº§n implementation cho toÃ n bá»™ cÃ¡c prototype function Ä‘Ã£ khai bÃ¡o á»Ÿ header. Táº¥t nhiÃªn lÃ  báº¡n pháº£i include header file trÆ°á»›c:</p>
<pre><code>#include &quot;mod_a.h&quot;
</code></pre><p>á» trong nÃ y báº¡n cÅ©ng cáº§n khai bÃ¡o giÃ¡ trá»‹ cho táº¥t cáº£ cÃ¡c biáº¿n Ä‘Ã£ khai bÃ¡o á»Ÿ header (náº¿u cÃ³).</p>
<p>CÃ¡c macro, háº±ng sá»‘, kiá»ƒu dá»¯ liá»‡u Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a bÃªn trong source file sáº½ khÃ´ng Ä‘Æ°á»£c export khi biÃªn dá»‹ch, vÃ¬ tháº¿ chÃºng luÃ´n lÃ  <strong>private</strong>.</p>
<p>CÃ¡c biáº¿n sá»‘ khai bÃ¡o trong nÃ y váº«n sáº½ lÃ  public trá»« khi báº¡n thÃªm vÃ o tá»« khÃ³a <strong>static</strong> cho nÃ³ á»Ÿ phÃ­a trÆ°á»›c:</p>
<pre><code>static int _a = 1;
</code></pre><p>TÆ°Æ¡ng tá»± vá»›i cÃ¡c hÃ m, báº¡n cÅ©ng sáº½ cáº§n tá»« khÃ³a <strong>static</strong>, náº¿u khÃ´ng nÃ³ váº«n sáº½ Ä‘Æ°á»£c export vÃ  cÃ¡c module khÃ¡c cÃ³ thá»ƒ sá»­ dá»¥ng, cho dÃ¹ báº¡n khÃ´ng khai bÃ¡o trong prototype:</p>
<pre><code>static void mod_a_private_func(int a, int b) {
  ...
}
</code></pre><hr>
<p><strong>LÆ°u Ã½: á» Ä‘Ã¢y cÃ³ sá»± nháº­p nháº±ng trong cÃ¡ch dÃ¹ng tá»« khÃ³a static</strong></p>
<p>Trong C, náº¿u ta dÃ¹ng tá»« khÃ³a <strong>static</strong> bÃªn trong má»™t scope nÃ o Ä‘Ã³ khi khai bÃ¡o má»™t biáº¿n, thÃ¬ ra khá»i scope Ä‘Ã³, biáº¿n nÃ y váº«n tá»“n táº¡i, vÃ¬ khi Ä‘Ã³ nÃ³ Ä‘Æ°á»£c cáº¥p phÃ¡t tÄ©nh trong bá»™ nhá»›, vÃ­ dá»¥:</p>
<pre><code>void static_test() {
  int a = 0;
  static int b = 0;
  b++;
  printf(&quot;%d -- %d\n&quot;, a, b);
}

static_test();
static_test();
static_test();
</code></pre><p>Output sáº½ lÃ :</p>
<pre><code>0 -- 1
0 -- 2
0 -- 3
</code></pre><p>NhÆ°ng náº¿u dÃ¹ng nÃ³ á»Ÿ pháº¡m vi toÃ n cá»¥c (khÃ´ng thuá»™c scope nÃ o) thÃ¬ trÃ¬nh biÃªn dá»‹ch sáº½ nháº­n biáº¿t Ä‘Ã³ lÃ  má»™t biáº¿n/hÃ m public.</p>
<hr>
<h4 id="bi-n-d-ch-b-ng-make">BiÃªn dá»‹ch báº±ng Make</h4>
<h3 id="common-practice-khi-modularity">Common practice khi Modularity</h3>
<h4 id="ki-m-tra-module-export-c-i-g-ra-ngo-i-">Kiá»ƒm tra module export cÃ¡i gÃ¬ ra ngoÃ i?</h4>
<h4 id="c-ch-t-tr-n-trong-module">CÃ¡ch Ä‘áº·t trÃªn trong module</h4>
<h4 id="gi-i-quy-t-v-n-ch-ng-ch-o-module">Giáº£i quyáº¿t váº¥n Ä‘á» chá»“ng chÃ©o module</h4>

                <div class="fb-like" data-href="http://huytd.github.io/posts/c-module.html" data-layout="standard" data-action="like" data-show-faces="true" data-share="true"></div>
                <div id="disqus_thread"></div>
                <script>
                /**
                * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
                * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
                */
                /*
                var disqus_config = function () {
                this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
                this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                };
                */
                (function() { // DON'T EDIT BELOW THIS LINE
                var d = document, s = d.createElement('script');

                s.src = '//huysblog.disqus.com/embed.js';

                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
                })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
            </div>
        </div>
	    <div class="footer">
            <p>Created with <a href="http://github.com/huytd/azeroth-js">azeroth.js</a></p>
            <div class="social">
                <a target="_blank" href="http://facebook.com/kingbazoka"><i class="icon-facebook-squared"></i></a>
                <a target="_blank" href="http://twitter.com/huydotnet"><i class="icon-twitter-squared"></i></a>
                <a target="_blank" href="http://github.com/huytd"><i class="icon-github-squared"></i></a>
                <a target="_blank" href="https://thefullsnack.com"><i class="icon-emo-coffee"></i></a>
            </div>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-71353335-1', 'auto');
          ga('send', 'pageview');
        </script>
        <script>
          window.fbAsyncInit = function() {
            FB.init({
              appId      : '462066520669072',
              xfbml      : true,
              version    : 'v2.6'
            });

            FB.Event.subscribe('edge.create', function(url) {
              ga('send', 'social', 'facebook', 'like', url);
            });
          };

          (function(d, s, id){
             var js, fjs = d.getElementsByTagName(s)[0];
             if (d.getElementById(id)) {return;}
             js = d.createElement(s); js.id = id;
             js.src = "//connect.facebook.net/en_US/sdk.js";
             fjs.parentNode.insertBefore(js, fjs);
           }(document, 'script', 'facebook-jssdk'));
        </script>
        <script id="dsq-count-scr" src="//huysblog.disqus.com/count.js" async></script>
        <script type="text/javascript" async src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>
        <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [['$','$'], ['\\(','\\)']],
            skipTags: ["script","noscript","style","textarea"]
          }
        });
        </script>
    </body>
</html>
