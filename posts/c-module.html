<html>
    <head>
        <title> Thi·∫øt k·∫ø h∆∞·ªõng Module trong C | Huy's Blog</title>
        <meta charset="utf-8">
        <meta http-equiv="content-type" content="text/html;"><meta name=viewport content="initial-scale=1.0 maximum-scale=1.0">
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inconsolata:400,700">
        <link href='https://fonts.googleapis.com/css?family=Noto+Serif:400,400italic,700,700italic&subset=latin,vietnamese' rel='stylesheet' type='text/css'>
        <link href="../css/theme.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="../css/highlight/tomorrow.css">
        <link rel="stylesheet" href="../css/fontello.css">
        <script src="../js/highlight.pack.js"></script>
        <script>
        hljs.initHighlightingOnLoad();
        </script>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-4401401497575880",
            enable_page_level_ads: true
          });
        </script>
    </head>
    <body>
        <div class="header">
            <a href="/"><i class="icon icon-emo-coffee"></i> Huy's Blog</a>
        </div>
        <div class="container">
            <div class="main">
                <h1 id="thi-t-k-h-ng-module-trong-c">Thi·∫øt k·∫ø h∆∞·ªõng Module trong C</h1>
<p>C c√≥ l·∫Ω l√† m·ªôt ng√¥n ng·ªØ kh√¥ng l·∫° ƒë·ªëi v·ªõi t·∫•t c·∫£ m·ªçi ng∆∞·ªùi, nh·∫•t l√† c√°c b·∫°n sinh vi√™n c√°c nƒÉm ƒë·∫ßu v√† c√°c b·∫°n h·ªçc sinh c·∫•p 3, v√¨ ƒë√¢y l√† qu√£ng th·ªùi gian ch√∫ng ta s·ª≠ d·ª•ng C nhi·ªÅu nh·∫•t -- ƒë·ªÉ gi·∫£i b√†i t·∫≠p.</p>
<p>Tuy nhi√™n s·∫Ω th·∫ø n√†o n·∫øu ch√∫ng ta s·ª≠ d·ª•ng C v√† √°p d·ª•ng v√†o c√¥ng vi·ªác th·ª±c t·∫ø? l∆∞u √Ω ·ªü ƒë√¢y m√¨nh n√≥i v·ªÅ C ch·ª© kh√¥ng ph·∫£i C++ nh√©. C·ª• th·ªÉ l√† ph√°t tri·ªÉn c√°c ·ª©ng d·ª•ng l·ªõn b·∫±ng C? nghe c√≥ v·∫ª ƒëi√™n r·ªì qu√° kh√¥ng? </p>
<h2 id="c-ai-l-m-v-y-kh-ng-">C√≥ ai l√†m v·∫≠y kh√¥ng?</h2>
<p>C√¢u tr·∫£ l·ªùi l√† c√≥. R·∫•t nhi·ªÅu l√† ƒë·∫±ng kh√°c. ƒê·ªÉ xem ai n√†o...</p>
<p>ƒê·∫ßu ti√™n ph·∫£i k·ªÉ ƒë·∫øn ƒë√≥ l√† <a href="https://github.com/torvalds/linux">nh√¢n h·ªá ƒëi·ªÅu h√†nh Linux</a> v√† <a href="https://github.com/git/git">git</a>, c·∫£ 2 s·∫£n ph·∫©m quan tr·ªçng n√†y ƒë·ªÅu ƒë∆∞·ª£c vi·∫øt ho√†n to√†n b·∫±ng <strong>C</strong> b·ªüi <strong>Linus Torvalds</strong> v√† ƒë√¢y l√† m·ªôt <a href="http://harmful.cat-v.org/software/c++/linus">C++ hater c√≥ ti·∫øng</a>.</p>
<p>K·∫ø ƒë·∫øn c√≥ th·ªÉ n√≥i ƒë·∫øn <a href="https://github.com/curl/curl">curl</a>, c√¥ng c·ª• m√† b·∫•t c·ª© ai x√†i h·ªá ƒëi·ªÅu h√†nh unix-like nh∆∞ c√°c th·ªÉ lo·∫°i Linux hay macOS ƒë·ªÅu t·ª´ng x√†i qua, c≈©ng ƒë∆∞·ª£c vi·∫øt ch·ªß y·∫øu b·∫±ng <strong>C</strong>.</p>
<p>Trong th·∫ø gi·ªõi c·ªßa c√°c web developer, c√≥ th·ªÉ k·ªÉ ƒë·∫øn <a href="https://github.com/antirez/redis">redis</a>, <a href="https://github.com/nginx/nginx">nginx</a>, <a href="https://github.com/openssl/openssl">openssl</a> ƒë·ªÅu ƒë∆∞·ª£c vi·∫øt b·∫±ng <strong>C</strong>.</p>
<p>Ch∆∞a h·∫øt, ngo√†i ra c√≤n c√≥ <a href="https://github.com/libuv/libuv">libuv</a>, b·ªô th∆∞ vi·ªán ƒë·ª©ng ƒë·∫±ng sau s·ª± th√†nh c√¥ng c·ªßa c∆° ch·∫ø Async I/O t·∫°o n√™n t√™n tu·ªïi c·ªßa NodeJS (t·∫•t nhi√™n ch·ªâ l√† trong gi·ªõi frontend dev th√¥i =)))) c≈©ng ƒë∆∞·ª£c x√¢y d·ª±ng b·∫±ng <strong>C</strong> n·ªët.</p>
<p>·ªí, c√≤n n·ªØa, ngay c·∫£ ng√¥n ng·ªØ <a href="https://github.com/ruby/ruby">ruby</a> v·ªën ƒë√£ qu√° n·ªïi ti·∫øng kh√¥ng c·∫ßn n√≥i th√™m n·ªØa, c≈©ng ƒë∆∞·ª£c Matz x√¢y d·ª±ng b·∫±ng <strong>C</strong> lu√¥n ƒë·∫•y.</p>
<p>Ph√®o, k·ªÉ nhi·ªÅu m·ªèi tay qu√°, vi·∫øt ƒë·∫øn ƒë√¢y t·ª± d∆∞ng c·∫£m th·∫•y g·∫ßn nh∆∞ to√†n b·ªô th·∫ø gi·ªõi ƒë√£ ƒë∆∞·ª£c x√¢y d·ª±ng b·∫±ng <strong>C</strong> r·ªìi, t·∫°i sao m√¨nh l·∫°i lang thang ƒëi code Swift v·ªõi Java l√†m g√¨ nh·ªâ üêî</p>
<h2 id="ok-v-y-gi-v-ch-ch-nh-i-">OK, v·∫≠y gi·ªù v√¥ ch·ªß ƒë·ªÅ ch√≠nh ƒëi...</h2>
<p>B√¢y gi·ªù ch√∫ng ta s·∫Ω c√πng t√¨m hi·ªÉu l√†m th·∫ø n√†o ƒë·ªÉ vi·∫øt ƒë∆∞·ª£c c√°c ·ª©ng d·ª•ng l·ªõn nh∆∞ nh·ªØng v√≠ d·ª• ƒë√£ n√™u ·ªü tr√™n, ch·ªâ b·∫±ng c√°ch s·ª≠ d·ª•ng m·ªôt ng√¥n ng·ªØ kh√¥ng h·ªÅ c√≥ nh·ªØng ch·ª©c nƒÉng g√¨ ti√™u bi·ªÉu nh∆∞ l√† class, hay template,... nh∆∞ C.</p>
<p>Th√¥ng th∆∞·ªùng, khi vi·∫øt m·ªôt ch∆∞∆°ng tr√¨nh C th√¨ ch√∫ng ta s·∫Ω th·ª±c hi·ªán nh∆∞ m√¥ h√¨nh sau:</p>
<p><img src="img/write-C-old.png" alt=""></p>
<p>Ch∆∞∆°ng tr√¨nh ƒë∆∞·ª£c vi·∫øt t·∫°i file <strong>main.c</strong> v√† sau khi bi√™n d·ªãch, ch√∫ng ta c√≥ m·ªôt file binary c√≥ th·ªÉ ch·∫°y ƒë∆∞·ª£c, ƒë·ªãnh d·∫°ng file n√†y nh∆∞ th·∫ø n√†o l√† t√πy v√†o h·ªá ƒëi·ªÅu h√†nh ƒë√≠ch m√† ch√∫ng ta ch·ªâ ƒë·ªãnh ƒë·ªÉ bi√™n d·ªãch.</p>
<p>Ch∆∞∆°ng tr√¨nh c√†ng l·ªõn, file <strong>main.c</strong> c√†ng to, th·ªùi gian bi√™n d·ªãch c√†ng ch·∫≠m, ƒë√≥ l√† l√Ω do t·∫°i sao ch√∫ng ta n√™n ph√¢n t√°ch ra th√†nh t·ª´ng module nh·ªè, thao t√°c n√†y g·ªçi l√† Modularity.</p>
<h3 id="modularity-l-g-">Modularity l√† g√¨?</h3>
<p>Modularity l√† ph∆∞∆°ng ph√°p t·ªï ch·ª©c m·ªôt ch∆∞∆°ng tr√¨nh l·ªõn th√†nh nhi·ªÅu ph·∫ßn nh·ªè h∆°n, g·ªçi l√† t·ª´ng <strong>module</strong>. M·ªói module s·∫Ω g·ªìm m·ªôt file <strong>header (*.h)</strong> ch·ª©a c√°c ƒë·ªãnh nghƒ©a, khai b√°o bi·∫øn, prototype, c√°c ki·ªÉu,... v√† m·ªôt file <strong>implementation (*.c)</strong> ƒë·ªÉ hi·ªán th·ª±c h√≥a c√°c prototype trong header, m·ª•c ƒë√≠ch ch√≠nh l√† ƒë·ªÉ gi·∫•u ƒëi ph·∫ßn code th·ª±c s·ª± c·ªßa n√≥ v√† gi·∫•u lu√¥n c√°c thu·ªôc t√≠nh private c·ªßa t·ª´ng module.</p>
<p><img src="img/write-C-module.png" alt=""></p>
<p>·ªû ph·∫ßn sau ch√∫ng ta s·∫Ω n√≥i r√µ h∆°n v·ªÅ c√°ch t·ªï ch·ª©c b√™n trong m·ªôt module. </p>
<p>S∆° ƒë·ªì b√™n d∆∞·ªõi cho ch√∫ng ta th·∫•y c√°ch t·ªï ch·ª©c c·ªßa m·ªôt project s·ª≠ d·ª•ng nhi·ªÅu module:</p>
<p><img src="img/write-C-module-layout.png" alt=""></p>
<p>Trong s∆° ƒë·ªì n√†y, ch√∫ng ta c√≥ 2 module <code>mod_a</code> v√† <code>mod_b</code> ƒë∆∞·ª£c khai b√°o b·∫±ng c√°c file .h v√† .c t∆∞∆°ng ·ª©ng. Khi bi√™n d·ªãch, c√°c module n√†y s·∫Ω ƒë∆∞·ª£c tr√¨nh bi√™n d·ªãch build th√†nh c√°c file <strong>mod_a.o</strong> v√† <strong>mod_b.o</strong></p>
<p>M≈©i t√™n m√†u xanh n∆∞·ªõc bi·ªÉn ch·ªâ qu√° tr√¨nh bi√™n d·ªãch, m≈©i t√™n m√†u xanh l·ª•c ch·ªâ qu√° tr√¨nh <strong>Linking</strong>.</p>
<div class="box-white" style="padding: 15px;">
<strong>Side note</strong><br/><hr/>
<strong>H·ªèi:</strong> M·ªôt ch∆∞∆°ng tr√¨nh C ƒë∆∞·ª£c bi√™n d·ªãch nh∆∞ th·∫ø n√†o?<br/>
<strong>ƒê√°p:</strong> M·ªôt ch∆∞∆°ng tr√¨nh C ƒë∆∞·ª£c bi√™n d·ªãch th√¥ng qua 4 b∆∞·ªõc: <strong>Pre-processing</strong>, <strong>Compilation</strong>, <strong>Assembly</strong> v√† <strong>Linking</strong><br/>
<img src="img/c-compilation.png" alt="">
B∆∞·ªõc <strong>pre-processing</strong> c√≥ nhi·ªám v·ª• gh√©p n·ªëi to√†n b·ªô c√°c file header ƒë∆∞·ª£c include, c√°c macro,... th√†nh m·ªôt b·ªô source th·ªëng nh·∫•t v√† chuy·ªÉn qua b∆∞·ªõc <strong>compilation</strong>, b∆∞·ªõc n√†y, tr√¨nh bi√™n d·ªãch s·∫Ω &quot;d·ªãch&quot; file source, chuy·ªÉn n√≥ th√†nh m√£ m√°y (assembler code), b∆∞·ªõc <strong>assembly</strong> nh·∫≠n ch∆∞∆°ng tr√¨nh assembler t·ª´ b∆∞·ªõc 2, build th√†nh t·ª´ng file <strong>object (*.o)</strong>, c√°c file object n√†y s·∫Ω ƒë∆∞·ª£c chuy·ªÉn qua <strong>linker</strong> (m·ªôt c√¥ng c·ª• gi√∫p k·∫øt n·ªëi c√°c file object) v√† t·∫°o th√†nh m·ªôt file th·ª±c thi duy nh·∫•t ƒë·ªÉ ch·∫°y.
</div>

<h3 id="l-i-ch-c-a-modularity-l-g-">L·ª£i √≠ch c·ªßa Modularity l√† g√¨?</h3>
<p>Vi·ªác ph√¢n chia ch∆∞∆°ng tr√¨nh ra th√†nh nhi·ªÅu module c√≥ r·∫•t nhi·ªÅu ∆∞u ƒëi·ªÉm, ƒë·∫∑c bi·ªát l√† ƒë·ªëi v·ªõi nh·ªØng ·ª©ng d·ª•ng l·ªõn v√† ph·ª©c t·∫°p:</p>
<ul>
<li>C√°c module c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng l·∫°i trong nhi·ªÅu project kh√°c</li>
<li>N·∫øu ph·∫ßn implementation c·ªßa module c√≥ thay ƒë·ªïi, m√† kh√¥ng l√†m thay ƒë·ªïi interface n√≥ cung c·∫•p th√¨ kh√¥ng c·∫ßn thi·∫øt ph·∫£i compile l·∫°i to√†n b·ªô ch∆∞∆°ng tr√¨nh (ch·ªâ compile module ƒë√≥ th√¥i)</li>
<li>Compile l·∫°i nhanh h∆°n (nh∆∞ ƒë√£ n√≥i ·ªü tr√™n)</li>
<li>Self-documenting - Ch·ªâ c·∫ßn nh√¨n v√†o file header th√¨ s·∫Ω bi·∫øt ƒë∆∞·ª£c c√°ch d√πng v√† c√°c ch·ª©c nƒÉng m√† module cung c·∫•p </li>
<li>D·ªÖ debug. V√¨ t√°ch bi·ªát v√† ho·∫°t ƒë·ªông ƒë·ªôc l·∫≠p n√™n m·ªói module c√≥ th·ªÉ ƒë∆∞·ª£c test ri√™ng bi·ªát, debug ri√™ng bi·ªát.</li>
<li>M·ªôt s·ªë tr√¨nh bi√™n d·ªãch C hi·ªán ƒë·∫°i c√≥ th·ªÉ generate code nhanh h∆°n v√† t·ªëi ∆∞u t·ªët h∆°n khi ch√∫ng ta modularity.</li>
</ul>
<h3 id="modularity-nh-th-n-o-">Modularity nh∆∞ th·∫ø n√†o?</h3>
<p>Modularity t·ª©c l√† ch√∫ng ta chia source code th√†nh nhi·ªÅu file module, m·ªói module g·ªìm m·ªôt file source (.c) v√† header (.h). </p>
<p>File header s·∫Ω ch·ª©a m·ªçi th√†nh ph·∫ßn <strong>public</strong> c·ªßa module, nh∆∞ l√† c√°c h·∫±ng s·ªë, thu·ªôc t√≠nh, c√°c h√†m ch√∫ng ta mu·ªën s·ª≠ d·ª•ng (ch·ªâ khai b√°o ·ªü d·∫°ng prototype), tuy·ªát ƒë·ªëi kh√¥ng implement b√™n trong file header.</p>
<p><img src="img/write-C-headers.png" alt=""></p>
<p>C√°c th√†nh ph·∫ßn kh√°c nh∆∞ implementation, c√°c th√†nh ph·∫ßn <strong>private</strong> s·∫Ω ƒë∆∞·ª£c ƒë∆∞a v√†o source file (.c), v√¨ khi thi·∫øt k·∫ø theo module, c√°c ch∆∞∆°ng tr√¨nh/module c·∫ßn s·ª≠ d·ª•ng module ƒëang x√©t kh√¥ng c·∫ßn thi·∫øt ph·∫£i bi·∫øt ph·∫ßn logic b√™n d∆∞·ªõi c·ªßa module n√†y l√†m g√¨.</p>
<h4 id="header-file-c-g-">Header file c√≥ g√¨?</h4>
<p>B∆∞·ªõc ƒë·∫ßu ti√™n khi thi·∫øt k·∫ø m·ªôt module ƒë√≥ l√† t·ªï ch·ª©c file Header c·ªßa module ƒë√≥.</p>
<p>File header ngo√†i m·ª•c ƒë√≠ch ƒë·ªãnh nghƒ©a c√°c th√†nh ph·∫ßn c·∫ßn thi·∫øt cho qu√° tr√¨nh pre-processing, n√≥ c√≤n c√≥ t√°c d·ª•ng l√†m c√¥ng c·ª• tham chi·∫øu cho c√°c l·∫≠p tr√¨nh vi√™n kh√°c khi s·ª≠ d·ª•ng module c·ªßa b·∫°n.</p>
<p>C·∫•u tr√∫c m·ªôt file header th∆∞·ªùng c√≥ c√°c ph·∫ßn sau:</p>
<h5 id="copyright">Copyright</h5>
<p>Ph·∫ßn n√†y kh√¥ng nh·∫•t thi·∫øt ph·∫£i c√≥, nh∆∞ng n·∫øu l√†m c√°c d·ª± √°n open source th√¨ b·∫°n n√™n b·ªï sung c√°c th√¥ng tin n√†y, ƒë·ªÉ tr√°nh vi·ªác nh·∫≠p nh·∫±ng v·ªÅ quy·ªÅn s·ªü h·ªØu c≈©ng nh∆∞ vi·ªác s·ª≠ d·ª•ng cho c√°c project kh√°c:</p>
<pre><code>/*
  mod_a.h -- Example of a C module
  Copyright 2016 by Huy Tran
  License: MIT
  Author: Huy Tran &lt;huy@gamarist.com&gt;
  Version: 2016-11-16
*/
</code></pre><p>C√°c th√¥ng tin g·ªìm c√≥: T√™n module, ch√∫ th√≠ch cho module, copyright, t√™n lo·∫°i gi·∫•y ph√©p (r·∫•t quan tr·ªçng), t√™n t√°c gi·∫£, version,...</p>
<p>C√≥ nhi·ªÅu ng∆∞·ªùi c√≤n ƒë∆∞a h·∫≥n n·ªôi dung gi·∫•y ph√©p s·ª≠ d·ª•ng v√†o ph·∫ßn header n√†y lu√¥n, tuy nhi√™n theo m√¨nh vi·ªác n√†y kh√¥ng c·∫ßn thi·∫øt l·∫Øm, v√¨ t√™n gi·∫•y ph√©p l√† ƒë·ªß r·ªìi.</p>
<h5 id="ch-ng-double-include">Ch·ªëng double include</h5>
<p>Ph·∫ßn ti·∫øp theo, kh√° l√† quan tr·ªçng, ƒë√≥ l√† define module flag ƒë·ªÉ ƒë√°nh d·∫•u cho C pre-processor bi·∫øt r·∫±ng module ƒë√£ ƒë∆∞·ª£c x·ª≠ l√Ω, tr√°nh vi·ªác include nhi·ªÅu l·∫ßn c√πng m·ªôt file.</p>
<pre><code>#ifndef _MODA_H_
#define _MODA_H_

// Body here

#endif
</code></pre><p>Kh·ªëi l·ªánh tr√™n d√πng l·ªánh <code>#ifndef</code> ƒë·ªÉ ki·ªÉm tra xem flag <code>_MODA_H_</code> ƒë√£ t·ªìn t·∫°i hay ch∆∞a, ban ƒë·∫ßu th√¨ ch∆∞a.</p>
<p>N·∫øu ch∆∞a t·ªìn t·∫°i th√¨ s·∫Ω define flag n√†y b·∫±ng l·ªánh <code>#define</code>, v√† k·∫øt th√∫c v·ªõi l·ªánh <code>#endif</code>.</p>
<p>Sau khi pre-processor x·ª≠ l√Ω xong file header n√†y, th√¨ flag <code>_MODA_H_</code> c≈©ng ƒë√£ ƒë∆∞·ª£c t·∫°o xong, n·∫øu l·∫ßn sau c√≥ m·ªôt module n√†o ƒë√≥ t√¨nh c·ªù include l·∫°i file header n√†y, ho·∫∑c b·∫°n v√¥ t√¨nh include 2 l·∫ßn li√™n ti·∫øp ·ªü nhi·ªÅu n∆°i, th√¨ c≈©ng s·∫Ω kh√¥ng b·ªã l·ªói khi x·ª≠ l√Ω.</p>
<h5 id="khai-b-o-macro-h-ng-s-">Khai b√°o macro, h·∫±ng s·ªë</h5>
<p>Ti·∫øp theo, ch√∫ng ta d√πng l·ªánh <code>#define</code> ƒë·ªÉ khai b√°o c√°c macro c·∫ßn d√πng cho ch∆∞∆°ng tr√¨nh, ·ªü ƒë√¢y th√¨ t√πy module c·∫ßn g√¨ v√† define cho h·ª£p l√Ω.</p>
<p>V√≠ d·ª•:</p>
<pre><code>/* mod_a.h -- Constants declarations */

#define MODA_HEX_RED   0xff0000
#define MODA_HEX_GREEN 0x00ff00
#define MODA_HEX_BLUE  0x0000ff

#define MODA_KEY_A     65
</code></pre><p>L∆∞u √Ω l√† c√°c macro, h·∫±ng s·ªë ƒë∆∞·ª£c khai b√°o trong file header s·∫Ω l√† public v√† t·ªìn t·∫°i trong to√†n b·ªô ch∆∞∆°ng tr√¨nh s·ª≠ d·ª•ng n√≥, v√¨ th·∫ø n√™n tr√°nh ƒë·∫∑t nh·ªØng t√™n macro d·ªÖ g√¢y nh·∫∑p nh·∫±ng, ch·ªìng ch√©o v·ªõi c√°c module kh√°c. </p>
<p>C√°ch t·ªët nh·∫•t l√† ƒë·∫∑t t√™n theo d·∫°ng <code>&lt;T√™n Module&gt;_&lt;Macro&gt;</code>.</p>
<h5 id="khai-b-o-ki-u">Khai b√°o ki·ªÉu</h5>
<p>Ph·∫ßn n√†y ch√∫ng ta khai b√°o c√°c ki·ªÉu d·ªØ li·ªáu, struct, enum c·∫ßn d√πng cho module.</p>
<pre><code>/* mod_a.h -- Types declarations */

enum moda_direction {
  MODA_NORTH,
  MODA_EAST,
  MODA_SOUTH,
  MODA_WEST
};

typedef struct _moda_point {
  int x;
  int y;
} moda_point;
</code></pre><p>C√°ch ƒë·∫∑t t√™n c≈©ng t∆∞∆°ng t·ª± nh∆∞ ·ªü tr√™n.</p>
<h5 id="function-prototype">Function prototype</h5>
<p>ƒê√¢y l√† ph·∫ßn quan tr·ªçng nh·∫•t trong m·ªôt module header, t·∫°i ƒë√¢y ch√∫ng ta khai b√°o to√†n b·ªô prototype c·ªßa c√°c ph∆∞∆°ng th·ª©c/h√†m c·∫ßn d√πng b√™n trong module. C√°c l·∫≠p tr√¨nh vi√™n kh√°c c√≥ th·ªÉ d·ª±a v√†o file n√†y ƒë·ªÉ s·ª≠ d·ª•ng module c·ªßa b·∫°n m√† kh√¥ng c·∫ßn ph·∫£i vi·∫øt t√†i li·ªáu chi ti·∫øt.</p>
<pre><code>/* mod_a.h -- Function prototypes */

void moda_init(void);
int moda_add(int a);
</code></pre><h4 id="source-file-c-g-">Source file c√≥ g√¨?</h4>
<p>Source file (v√≠ d·ª•: <strong>mod_a.c</strong>) s·∫Ω l√† ph·∫ßn implementation cho to√†n b·ªô c√°c prototype function ƒë√£ khai b√°o ·ªü header. T·∫•t nhi√™n l√† b·∫°n ph·∫£i include header file tr∆∞·ªõc:</p>
<pre><code>#include &quot;mod_a.h&quot;
</code></pre><p>·ªû trong n√†y b·∫°n c≈©ng c·∫ßn khai b√°o gi√° tr·ªã cho t·∫•t c·∫£ c√°c bi·∫øn ƒë√£ khai b√°o ·ªü header (n·∫øu c√≥).</p>
<p>C√°c macro, h·∫±ng s·ªë, ki·ªÉu d·ªØ li·ªáu ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a b√™n trong source file s·∫Ω kh√¥ng ƒë∆∞·ª£c export khi bi√™n d·ªãch, v√¨ th·∫ø ch√∫ng lu√¥n l√† <strong>private</strong>.</p>
<p>C√°c bi·∫øn s·ªë khai b√°o trong n√†y v·∫´n s·∫Ω l√† public tr·ª´ khi b·∫°n th√™m v√†o t·ª´ kh√≥a <strong>static</strong> cho n√≥ ·ªü ph√≠a tr∆∞·ªõc:</p>
<pre><code>static int _a = 1;
</code></pre><p>T∆∞∆°ng t·ª± v·ªõi c√°c h√†m, b·∫°n c≈©ng s·∫Ω c·∫ßn t·ª´ kh√≥a <strong>static</strong>, n·∫øu kh√¥ng n√≥ v·∫´n s·∫Ω ƒë∆∞·ª£c export v√† c√°c module kh√°c c√≥ th·ªÉ s·ª≠ d·ª•ng, cho d√π b·∫°n kh√¥ng khai b√°o trong prototype:</p>
<pre><code>static void mod_a_private_func(int a, int b) {
  ...
}
</code></pre><hr>
<p><strong>L∆∞u √Ω: ·ªû ƒë√¢y c√≥ s·ª± nh·∫≠p nh·∫±ng trong c√°ch d√πng t·ª´ kh√≥a static</strong></p>
<p>Trong C, n·∫øu ta d√πng t·ª´ kh√≥a <strong>static</strong> b√™n trong m·ªôt scope n√†o ƒë√≥ khi khai b√°o m·ªôt bi·∫øn, th√¨ ra kh·ªèi scope ƒë√≥, bi·∫øn n√†y v·∫´n t·ªìn t·∫°i, v√¨ khi ƒë√≥ n√≥ ƒë∆∞·ª£c c·∫•p ph√°t tƒ©nh trong b·ªô nh·ªõ, v√≠ d·ª•:</p>
<pre><code>void static_test() {
  int a = 0;
  static int b = 0;
  b++;
  printf(&quot;%d -- %d\n&quot;, a, b);
}

static_test();
static_test();
static_test();
</code></pre><p>Output s·∫Ω l√†:</p>
<pre><code>0 -- 1
0 -- 2
0 -- 3
</code></pre><p>Nh∆∞ng n·∫øu d√πng n√≥ ·ªü ph·∫°m vi to√†n c·ª•c (kh√¥ng thu·ªôc scope n√†o) th√¨ tr√¨nh bi√™n d·ªãch s·∫Ω nh·∫≠n bi·∫øt ƒë√≥ l√† m·ªôt bi·∫øn/h√†m public.</p>
<hr>
<h4 id="bi-n-d-ch-b-ng-make">Bi√™n d·ªãch b·∫±ng Make</h4>
<h3 id="common-practice-khi-modularity">Common practice khi Modularity</h3>
<h4 id="ki-m-tra-module-export-c-i-g-ra-ngo-i-">Ki·ªÉm tra module export c√°i g√¨ ra ngo√†i?</h4>
<h4 id="c-ch-t-tr-n-trong-module">C√°ch ƒë·∫∑t tr√™n trong module</h4>
<h4 id="gi-i-quy-t-v-n-ch-ng-ch-o-module">Gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ ch·ªìng ch√©o module</h4>

                <div class="fb-like" data-href="http://huytd.github.io/posts/c-module.html" data-layout="standard" data-action="like" data-show-faces="true" data-share="true"></div>
                <div id="disqus_thread"></div>
                <script>
                /**
                * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
                * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
                */
                /*
                var disqus_config = function () {
                this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
                this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                };
                */
                (function() { // DON'T EDIT BELOW THIS LINE
                var d = document, s = d.createElement('script');

                s.src = '//huysblog.disqus.com/embed.js';

                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
                })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
            </div>
        </div>
	    <div class="footer">
            <p>Created with <a href="http://github.com/huytd/azeroth-js">azeroth.js</a></p>
            <div class="social">
                <a target="_blank" href="http://facebook.com/kingbazoka"><i class="icon-facebook-squared"></i></a>
                <a target="_blank" href="http://twitter.com/huydotnet"><i class="icon-twitter-squared"></i></a>
                <a target="_blank" href="http://github.com/huytd"><i class="icon-github-squared"></i></a>
                <a target="_blank" href="https://thefullsnack.com"><i class="icon-emo-coffee"></i></a>
            </div>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-71353335-1', 'auto');
          ga('send', 'pageview');
        </script>
        <script>
          window.fbAsyncInit = function() {
            FB.init({
              appId      : '462066520669072',
              xfbml      : true,
              version    : 'v2.6'
            });

            FB.Event.subscribe('edge.create', function(url) {
              ga('send', 'social', 'facebook', 'like', url);
            });
          };

          (function(d, s, id){
             var js, fjs = d.getElementsByTagName(s)[0];
             if (d.getElementById(id)) {return;}
             js = d.createElement(s); js.id = id;
             js.src = "//connect.facebook.net/en_US/sdk.js";
             fjs.parentNode.insertBefore(js, fjs);
           }(document, 'script', 'facebook-jssdk'));
        </script>
        <script id="dsq-count-scr" src="//huysblog.disqus.com/count.js" async></script>
        <script type="text/javascript" async src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>
        <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [['$','$'], ['\\(','\\)']],
            skipTags: ["script","noscript","style","textarea"]
          }
        });
        </script>
    </body>
</html>
