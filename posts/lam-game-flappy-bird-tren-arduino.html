<html>
    <head>
        <title> L√†m game Flappy Bird tr√™n Arduino | Huy's Blog</title>
        <meta charset="utf-8">
        <meta http-equiv="content-type" content="text/html;"><meta name=viewport content="initial-scale=1.0 maximum-scale=1.0">
        <meta property="og:url" content="http://huytd.github.io/posts/lam-game-flappy-bird-tren-arduino" />
<meta property="og:type" content="article" />
<meta property="og:title" content="L√†m game Flappy Bird tr√™n Arduino" />
<meta property="og:description" content="M·ªôt trong nh·ªØng v·ªã c·ª©u tinh c·ªßa d√¢n ƒëam m√™ ƒëi·ªán t·ª≠ nh∆∞ng ngo·∫°i ƒë·∫°o nh∆∞ m√¨nh ƒë√≥ l√† Arduino, ƒë√¢y l√† m·ªôt board m·∫°ch l·∫≠p tr√¨nh ƒë∆∞·ª£c (v√¨ t√≠ch h·ª£p c·∫£ m·∫°ch n·∫°p, m·∫°ch ngu·ªìn, output, input,...), b·∫°n ch·ªâ c·∫ßn t·∫≠p trung v√†o s·ª≠ d·ª•ng c√°c ch√¢n input,..." />
<meta property="og:image" content="https://raw.githubusercontent.com/huytd/huytd.github.io/master/posts/arduinoflappy.jpg" />

        <link href="../css/inconsolata.css" rel="stylesheet" type="text/css">
        <link href="../css/theme.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="../css/highlight/tomorrow.css">
        <link rel="stylesheet" href="../css/fontello.css">
        <script src="../js/highlight.pack.js"></script>
        <script>
        hljs.initHighlightingOnLoad();
        </script>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    </head>
    <body>
        <div class="header">
            <a href="/"><i class="icon icon-emo-coffee"></i> Huy's Blog</a>
        </div>
        <div class="container">
            <div class="main">
                <h1 id="l-m-game-flappy-bird-tr-n-arduino">L√†m game Flappy Bird tr√™n Arduino</h1>
<h2 id="gi-i-thi-u-m-t-t-">Gi·ªõi thi·ªáu m·ªôt t√≠</h2>
<p>Ng√†y nay, lƒ©nh v·ª±c ƒëi·ªán t·ª≠ ƒëang d·∫ßn ƒë∆∞·ª£c nhi·ªÅu ng∆∞·ªùi quan t√¢m, b·∫£n th√¢n m√¨nh c≈©ng b·∫Øt ƒë·∫ßu c·ªë g·∫Øng t√¨m hi·ªÉu m·∫£ng n√†y t·ª´ kh√° l√¢u (h∆°n 10 nƒÉm tr∆∞·ªõc) nh∆∞ng ti·∫øc l√† d·ªët To√°n/L√Ω, c≈©ng kh√¥ng ph·∫£i d√¢n h·ªçc ƒêi·ªán t·ª≠ n√™n sau g·∫ßn 10 nƒÉm m·ªõi c√≥ l√†m ƒë∆∞·ª£c √≠t th·ª© ƒë·ªÉ khoe v·ªõi b·∫°n b√®. </p>
<p>M·ªôt trong nh·ªØng v·ªã c·ª©u tinh c·ªßa d√¢n ƒëam m√™ ƒëi·ªán t·ª≠ nh∆∞ng ngo·∫°i ƒë·∫°o nh∆∞ m√¨nh ƒë√≥ l√† Arduino, ƒë√¢y l√† m·ªôt board m·∫°ch l·∫≠p tr√¨nh ƒë∆∞·ª£c (v√¨ t√≠ch h·ª£p c·∫£ m·∫°ch n·∫°p, m·∫°ch ngu·ªìn, output, input,...), b·∫°n ch·ªâ c·∫ßn t·∫≠p trung v√†o s·ª≠ d·ª•ng c√°c ch√¢n input, output c·ªßa Arduino ƒë·ªÉ &quot;s√°ng t√°c&quot;, ch·ªâ c·∫ßn m·ªôt ch√∫t ki·∫øn th·ª©c ƒëi·ªán t·ª≠ c∆° b·∫£n ƒë·ªÉ kh√¥ng l√†m n√≥ ch·∫≠p m·∫°ch, ch√°y nh√†. </p>
<p>V·ªõi d√¢n g√µ code th√¨ ch·ªâ nh∆∞ th·∫ø n√†y l√† ƒë·ªß, gi·ªëng nh∆∞ t√¥n ch·ªâ c·ªßa RoR, b·∫°n c·ª© tho·∫£ s·ª©c s√°ng t·∫°o, m·∫•y chuy·ªán kh√°c ƒë·ªÉ Arduino lo.</p>
<p>N·∫øu ch∆∞a c√≥ ki·∫øn th·ª©c v·ªÅ Arduino, c√°c b·∫°n c√≥ th·ªÉ tham kh·∫£o b√†i vi·∫øt c·ªßa b√°c @viethnguyen (<a href="http://kipalog.com/posts/JsG_PhVlQM-anwGna4ZT0g">http://kipalog.com/posts/JsG_PhVlQM-anwGna4ZT0g</a>)</p>
<p>C√≤n b√¢y gi·ªù ch√∫ng ta s·∫Ω b·∫Øt ƒë·∫ßu l√†m ƒë·ªì ch∆°i.</p>
<h2 id="l-m-game-flappy-bird">L√†m game Flappy Bird</h2>
<p>ƒê√¢y l√† video demo cho c√°i game Flappy Bird ch√∫ng ta s·∫Ω l√†m:</p>
<p><img src="https://raw.githubusercontent.com/huytd/huytd.github.io/master/posts/arduinoflappy.jpg" alt="alt text">
<strong>Video</strong>: <a href="https://www.youtube.com/watch?v=04cY78Y2d3g">https://www.youtube.com/watch?v=04cY78Y2d3g</a></p>
<p>Game n√†y m√¨nh s·ª≠ d·ª•ng data h√¨nh ·∫£nh c·ªßa m·ªôt tutorial t∆∞∆°ng t·ª± t·ª´ <a href="http://arduino.vn">http://arduino.vn</a>, tuy nhi√™n v√¨ code logic c·ªßa trang n√†y kh√≥ hi·ªÉu qu√° n√™n m√¨nh ch·ªçn c√°ch t·ª± vi·∫øt t·ª´ ƒë·∫ßu. </p>
<h3 id="chu-n-b-">Chu·∫©n b·ªã</h3>
<p>V·ªÅ ph·∫ßn c·ª©ng, ch√∫ng ta c·∫ßn c√≥:</p>
<ul>
<li><strong>1x</strong> M√†n h√¨nh <strong>Nokia 5110 LCD</strong> (gi√° t·∫ßm 40k/c√°i)</li>
<li><strong>1x</strong> N√∫t b·∫•m (Push button, lo·∫°i n√†y mua 5k nguy√™n 1 bao)</li>
<li><strong>7x</strong> S·ª£i d√¢y Jumper Wire (c√°i n√†y mua 1 b√≥ v·ªÅ d√πng d·∫ßn)</li>
<li><strong>1x</strong> Board Arduino. ·ªû ƒë√¢y m√¨nh d√πng <strong>UNO R3</strong>, m·∫•y con kh√°c c≈©ng ko kh√°c g√¨, kh√°c m·ªói c√°ch n·ªëi d√¢y :v</li>
</ul>
<p>T·ªïng thi·ªát h·∫°i ch∆∞a ƒë·∫øn 50k, ch∆∞a t√≠nh con Arduino :D  </p>
<h3 id="n-i-d-y-m-t-tr-c">N·ªëi d√¢y m·∫∑t tr∆∞·ªõc</h3>
<p>ƒê√¢y l√† ph·∫ßn th√∫ v·ªã nh·∫•t khi l√†m vi·ªác v·ªõi Arduino, ch·∫Øc do m√¨nh kh√¥ng ph·∫£i d√¢n chuy√™n ƒëi·ªán t·ª≠ n√™n c√°i kh√¢u n√†y kh√° l√† v·∫•t v·∫£, ƒë·ªÉ tr√°nh l√†m c√°c b·∫°n v·∫•t v·∫£ theo m√¨nh th√¨ m√¨nh ghi l·∫°i c√°ch n·ªëi lu√¥n, ƒë·ª° ph·∫£i m√†y m√≤ datasheet n√†y n·ªç. </p>
<p><strong>Push Button</strong>: N·ªëi v√†o <code>Pin 2</code> v√† <code>GND</code> c·ªßa Arduino
<strong>M√†n h√¨nh</strong>: N·ªëi l·∫ßn l∆∞·ª£t c√°c ch√¢n t∆∞∆°ng ·ª©ng t·ª´ m√†n h√¨nh v√†o Arduino</p>
<ul>
<li><code>CLK</code> --&gt; <code>Pin 7</code></li>
<li><code>DIN</code> --&gt; <code>Pin 6</code></li>
<li><code>D/C</code> --&gt; <code>Pin 5</code></li>
<li><code>CS</code> --&gt; <code>Pin 4</code></li>
</ul>
<p>Ngu·ªìn ƒëi·ªán th√¨ ·ªü ƒë√¢y ch√∫ng ta s·ª≠ d·ª•ng ngu·ªìn t·ª´ m√°y t√≠nh c·∫•p cho Arduino, n·∫øu mu·ªën ƒëem ra ngo√†i ch∆°i th√¨ b·∫°n c√≥ th·ªÉ mua 1 vi√™n pin <code>9V</code> v√† n·ªëi 2 c·ª±c c·ªßa pin v√†o <code>Vin</code> v√† <code>GND</code> c·ªßa Arduino. </p>
<h3 id="n-i-code-m-t-sau">N·ªëi code m·∫∑t sau</h3>
<p>ƒê·∫ßu ti√™n, ch√∫ng ta c·∫ßn define ra c√°c d·ªØ li·ªáu c·∫ßn d√πng, ·ªü ƒë√¢y l√† c√°c m·∫£ng gi√° tr·ªã ch·ª©a h√¨nh ·∫£nh (bitmap) cho con chim, v√† m·∫•y c√°i ·ªëng n∆∞·ªõc. Ngo√†i ra m√¨nh define th√™m 2 bi·∫øn <code>ANIM_FRAME</code> ƒë·ªÉ quy ƒë·ªãnh t·ªëc ƒë·ªô thay ƒë·ªïi h√¨nh (ƒë·ªÉ t·∫°o hi·ªáu ·ª©ng chuy·ªÉn ƒë·ªông) c·ªßa con chim v√† <code>DELAY_FRAME</code> ƒë·ªÉ ƒëi·ªÅu ch·ªânh t·ªëc ƒë·ªô xung nh·ªãp x·ª≠ l√Ω cho t∆∞∆°ng ·ª©ng v·ªõi t·ªëc ƒë·ªô c·ªßa Arduino UNO R3. </p>
<p><strong>Sprite.h</strong></p>
<pre><code>#define ANIM_FRAME 50
#define DELAY_FRAME 5
static unsigned char PROGMEM flappybird_frame_1[] = { 0x03, 0xF0, 0x0C, 0x48, 0x10, 0x84, 0x78, 0x8A, 0x84, 0x8A, 0x82, 0x42, 0x82, 0x3E, 0x44, 0x41,0x38, 0xBE, 0x20, 0x41, 0x18, 0x3E, 0x07, 0xC0 };
static unsigned char PROGMEM flappybird_frame_2[] = { 0x03, 0xF0, 0x0C, 0x48, 0x10, 0x84, 0x20, 0x8A, 0x40, 0x8A, 0x40, 0x42, 0x7C, 0x3E, 0x82, 0x41, 0x84, 0xBE, 0x88, 0x41, 0x78, 0x3E, 0x07, 0xC0 };
static unsigned char PROGMEM bar_bottom[] = { 0xFF, 0xFF, 0xFF, 0x42, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E };
static unsigned char PROGMEM bar_top[] = { 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x42, 0xFF, 0xFF, 0xFF };
</code></pre><p>C√°c m·∫£ng d·ªØ li·ªáu <code>flappybird_frame_*</code> v√† <code>bar_bottom</code>, <code>bar_top</code> l√† m·∫£ng ƒë∆∞·ª£c convert t·ª´ c√°c tool bitmap converter (tool n√†y ch·ªâ ch·∫°y tr√™n Windows n√™n m√¨nh copy lu√¥n t·ª´ <a href="http://arduino.vn">http://arduino.vn</a> :v)</p>
<p>Ti·∫øp ƒë·∫øn ch√∫ng ta s·∫Ω vi·∫øt 2 class ƒë·ªÉ x·ª≠ l√Ω 2 th√†nh ph·∫ßn ch√≠nh trong game, ƒë√≥ l√† con chim (<code>Chym.h</code>) v√† ·ªëng n∆∞·ªõc (<code>Bar.h</code>).</p>
<p>T∆∞∆°ng t·ª± nh∆∞ khi l·∫≠p tr√¨nh game tr√™n c√°c thi·∫øt b·ªã kh√°c, ch√∫ng ta c·∫ßn m·ªôt v√≤ng l·∫∑p ch√≠nh (<code>main loop</code>) ƒë·ªÉ x·ª≠ l√Ω tu·∫ßn t·ª± v√† li√™n t·ª•c c√°c thao t√°c: <code>X·ª≠ l√Ω game logic</code> &gt; <code>Xo√° m√†n h√¨nh</code> &gt; <code>V·∫Ω l·∫°i m·ªçi th·ª© l√™n m√†n h√¨nh</code> </p>
<p>Ch√≠nh v√¨ th·∫ø n√™n trong 2 class <code>Chym.h</code> v√† <code>Bar.h</code>, ch√∫ng ta s·∫Ω c√≥ c√πng c·∫•u tr√∫c d·∫°ng:</p>
<pre><code>class Foo {
    void update(); // H√†m x·ª≠ l√Ω update logic
    void render(); // H√†m v·∫Ω ƒë·ªëi t∆∞·ª£ng l√™n m√†n h√¨nh
    // c√°c x·ª≠ l√Ω kh√°c
}
</code></pre><p>B√¢y gi·ªù ch√∫ng ta s·∫Ω b·∫Øt tay v√†o vi·∫øt code cho ƒë·ªëi t∆∞·ª£ng con <code>Chym</code></p>
<p><strong>Chym.h</strong></p>
<pre><code>class Chym {

private:
  int frameCount;
  int x; 
  int y;
  int deltaIde;
  int delayFrame;

  int jumpCount; 
  int maxJumpCount;
  int moveSpeed;

  bool _isDead;
public: 
  void respawn() {
    x = 24; 
    y = 20;
    deltaIde = -1;
    moveSpeed = 1;
    jumpCount = 0;
    _isDead = false;
  }

  Chym() {
    frameCount = 0;
    delayFrame = 0;
    maxJumpCount = 20;
    respawn();
  }

  void render() {
    if (frameCount &lt; ANIM_FRAME / 2) {
      display.drawBitmap(x, y, flappybird_frame_1, 16, 12, 1);      
    } 
    else {
      display.drawBitmap(x, y, flappybird_frame_2, 16, 12, 1);          
    }
  }

  void update() {
    delayFrame++;
    if (delayFrame == DELAY_FRAME) {
      y += deltaIde * moveSpeed;
      delayFrame = 0;
    }

    if (y &gt; 35) {
      _isDead = true;
    }

    frameCount++;
    if (frameCount &gt;= ANIM_FRAME) frameCount = 0;
  }

  bool isDead() {
    return _isDead;
  }

  void die() {
    _isDead = true;
  }

  void cancelJump() {
    jumpCount = 0;
    flyDown();
  }

  void flyUp() {
    if (jumpCount &lt; maxJumpCount) {
      deltaIde = -1; 
      moveSpeed = 3;    
      jumpCount++;
    } 
    else {
      flyDown();
    }
  }

  void flyDown() {
    deltaIde = 1; 
    moveSpeed = 1;
  }

  int getX() {
    return x;
  }

  int getY() {
    return y;
  }

};
</code></pre><p>Gi·∫£i th√≠ch: </p>
<ul>
<li>H√†m <code>respawn</code> c√≥ nhi·ªám v·ª• reset l·∫°i to·∫° ƒë·ªô, tr·∫°ng th√°i c·ªßa Chim khi b·∫Øt ƒë·∫ßu game (ho·∫∑c sau khi ch·∫øt)</li>
<li>H√†m <code>render</code> c√≥ nhi·ªám v·ª• v·∫Ω l·∫ßn l∆∞·ª£t 2 h√¨nh ·∫£nh t∆∞·ª£ng tr∆∞ng cho 2 tr·∫°ng th√°i c·ªßa Chim khi ƒëang bay theo th·ªùi gian</li>
<li>H√†m <code>update</code> c√≥ nhi·ªám v·ª• ƒëi·ªÅu khi·ªÉn to·∫° ƒë·ªô c·ªßa Chim l√™n/xu·ªëng th√¥ng qua bi·∫øn <code>deltaIde</code>, ki·ªÉm tra khi n√†o th√¨ con Chim n√≥ ch·∫øt,...</li>
<li>H√†m <code>isDead</code> ki·ªÉm tra xem Chim n√≥ ch·∫øt ch∆∞a </li>
<li>H√†m <code>die</code> ƒë·ªÉ b√°o hi·ªáu con Chim ƒë√£ ch·∫øt </li>
<li>H√†m <code>cancelJump</code> c√≥ nhi·ªám v·ª• x·ª≠ l√Ω k·∫øt th√∫c vi·ªác nh·∫£y c·ªßa con Chim, v√† g·ªçi h√†m <code>flyDown</code> ƒë·ªÉ k√©o con Chim ƒëi xu·ªëng l·∫°i</li>
<li>H√†m <code>flyUp</code> ƒë·ªÉ n√¢ng to·∫° ƒë·ªô c·ªßa Chim l√™n th√¥ng qua bi·∫øn <code>deltaIde</code>, t·∫°o hi·ªáu ·ª©ng nh·∫£y </li>
<li>H√†m <code>flyDown</code> d√πng ƒë·ªÉ gi·∫£m to·∫° ƒë·ªô c·ªßa Chim (gi·∫£ l·∫≠p m√¥i tr∆∞·ªùng tr·ªçng l·ª±c ƒë·∫•y)</li>
<li>H√†m <code>getX</code> v√† <code>getY</code> d√πng ƒë·ªÉ l·∫•y to·∫° ƒë·ªô c·ªßa Chim.</li>
</ul>
<p>Ti·∫øp theo l√† code logic cho m·∫•y c√°i ·ªëng n∆∞·ªõc (<code>Bar</code>) </p>
<p><strong>Bar.h</strong>:</p>
<pre><code>class Bar {

private:
  int x; 
  int y;
  int delayFrame;
  int moveSpeed;
public:   
  Bar() {
    delayFrame = 0;
    x = 0; y = 24;
    moveSpeed = 2;
  }

  void setPos(int sx, int sy) {
    x = sx; y = sy;
  }

  void render() {
    display.drawBitmap(x, y - 30, bar_top, 8, 20, 1); 
    display.drawBitmap(x, y + 10, bar_bottom, 8, 20, 1); 
  }

  void update() {
    delayFrame++;
    if (delayFrame == DELAY_FRAME) {

      x -= moveSpeed;
      if (x &lt; -10) x = 95;

      delayFrame = 0;
    }
  }

  int hitTest(int tx, int ty) {
    int hitX = ((tx &gt;= x - 16) &amp;&amp; (tx &lt;= x))?1:0;
    int hitY = ((ty &lt;= (y - 10)) || (ty + 12 &gt;= y + 10))?1:0;
    if (hitX != 0) {
      return hitY;
    }
    return 0;
  }

};
</code></pre><p>Gi·∫£i th√≠ch: </p>
<ul>
<li>H√†m <code>setPos</code> d√πng ƒë·ªÉ thi·∫øt l·∫≠p v·ªã tr√≠ c·ªßa ·ªëng n∆∞·ªõc</li>
<li>H√†m <code>render</code> d√πng ƒë·ªÉ v·∫Ω 2 c√°i ·ªëng n∆∞·ªõc (tr√™n v√† d∆∞·ªõi) ra m√†n h√¨nh theo to·∫° ƒë·ªô hi·ªán t·∫°i c·ªßa n√≥</li>
<li>H√†m <code>update</code> l√†m nhi·ªám v·ª• thay ƒë·ªïi to·∫° ƒë·ªô c·ªßa ·ªëng n∆∞·ªõc, t·∫°o c·∫£m gi√°c l√† con chim ƒëang bay t·ªõi (nh∆∞ng th·ª±c ra l√† c√°i ·ªëng n∆∞·ªõc bay lui)</li>
<li>H√†m <code>hitTest</code> l√†m nhi·ªám v·ª• ki·ªÉm tra xem con chim v√† c√°i ·ªëng n∆∞·ªõc c√≥ va ch·∫°m v·ªõi nhau kh√¥ng</li>
</ul>
<p>Ph√π... ch√∫ng ta ƒë√£ x√¢y d·ª±ng xong code x·ª≠ l√Ω logic cho c√°c ƒë·ªëi t∆∞·ª£ng c√≥ trong game. B√¢y gi·ªù l√† l√∫c gh√©p n·ªëi t·∫•t c·∫£ l·∫°i th√†nh m·ªôt game ho√†n ch·ªânh. </p>
<p>·ªû ch∆∞∆°ng tr√¨nh ch√≠nh c·ªßa Arduino, quƒÉng v√†o ƒëo·∫°n code sau:</p>
<pre><code>#include &lt;SPI.h&gt;
#include &lt;Adafruit_GFX.h&gt;
#include &lt;Adafruit_PCD8544.h&gt;

Adafruit_PCD8544 display = Adafruit_PCD8544(7, 6, 5, 4, 3);

#include &quot;Sprite.h&quot;
#include &quot;Chym.h&quot;
#include &quot;Bar.h&quot;

Chym player;
Bar bar; Bar bar2;
int gameScore = 0;

int KNOCK_PIN = 2;
int LED_PIN = 8;

boolean clicked = false;

void loop(){}

void resetGame() {
  player.respawn();
  bar.setPos(0, 20);
  bar2.setPos(50, 30);
  gameScore = 0;
}

void setup() {
  Serial.begin(9600);

  display.begin();
  display.setContrast(50);
  display.clearDisplay();
  display.display();

  digitalWrite(LED_PIN, HIGH);

  pinMode(KNOCK_PIN, INPUT_PULLUP);
  pinMode(LED_PIN, OUTPUT);

  resetGame();

  while(1) {
    getInput();
    player.update();
    bar.update(); bar2.update();
    drawLCD();
  }
}

void getInput() {
  int knock = digitalRead(KNOCK_PIN);
  if (knock == 0) { // push down
    clicked = true;
  } 
  else {
    clicked = false;
  }
}

void drawLCD() {
  display.clearDisplay();

  if (!player.isDead()) {
    int ht1 = bar.hitTest(player.getX(), player.getY());
    int ht2 = bar2.hitTest(player.getX(), player.getY());
    int die = ht1 + ht2;
    if (die == 1) {
        // game over
        player.die();
    }

    if (clicked) {
      player.flyUp();
    } 
    else {
      player.cancelJump();
    }
    player.render();    

    bar.render(); bar2.render(); 
  } 
  else {
    display.setCursor(0, 0);
    display.setTextSize(2);
    display.println(&quot;Game   Over!!!&quot;);
    if (clicked) {
      resetGame();
    }
  }

  display.display();
}
</code></pre><p>Gi·∫£i th√≠ch: </p>
<p>D√≤ng l·ªánh ƒë·∫ßu ti√™n n√†y l√†m nhi·ªám v·ª• kh·ªüi t·∫°o driver giao ti·∫øp v·ªõi m√†n h√¨nh LCD m√† ch√∫ng ta ƒë√£ n·ªëi v√†o Arduino:
<code>Adafruit_PCD8544 display = Adafruit_PCD8544(7, 6, 5, 4, 3);</code></p>
<p>T·ª´ b√¢y gi·ªù, ch√∫ng ta c√≥ th·ªÉ giao ti·∫øp v·ªõi m√†n h√¨nh th√¥ng qua ƒë·ªëi t∆∞·ª£ng <code>display</code>.</p>
<p>H√†m <code>resetGame</code> d√πng ƒë·ªÉ restart l·∫°i game sau khi Chim ch·∫øt.</p>
<p>H√†m <code>setup</code> kh·ªüi t·∫°o c√°c th√¥ng s·ªë c·∫ßn thi·∫øt cho m√†n h√¨nh. Trong h√†m n√†y c√≥ m·ªôt v√≤ng l·∫∑p v√¥ h·∫°n:
<code>while(1) { ... }</code></p>
<p>ƒê√¢y l√† v√≤ng l·∫∑p ch√≠nh c·ªßa game, c√°c l·ªánh b√™n trong ƒë√≥ s·∫Ω ch·∫°y tu·∫ßn t·ª´ v√† li√™n t·ª•c. Trong v√≤ng l·∫∑p n√†y ch√∫ng ta x·ª≠ l√Ω vi·ªác ƒë·ªçc tr·∫°ng th√°i nh·∫•n n√∫t c·ªßa Push Button th√¥ng qua h√†m <code>getInput</code> v√† update x·ª≠ l√Ω logic cho <code>player</code> (con chim) v√† 2 c·∫∑p ·ªëng n∆∞·ªõc (<code>bar</code> v√† <code>bar2</code>), cu·ªëi c√πng g·ªçi h√†m <code>drawLCD</code>.</p>
<p>H√†m <code>drawLCD</code> n√†y ngo√†i nhi·ªám v·ª• v·∫Ω m·ªçi th·ª© l√™n m√†n h√¨nh th√¨ c√≤n x·ª≠ l√Ω vi·ªác ki·ªÉm tra xem Chim c√≥ ƒë·ª•ng v√†o c·∫∑p ·ªëng n∆∞·ªõc n√†o ch∆∞a, n·∫øu ƒë·ª•ng th√¨ s·∫Ω g·ªçi l·ªánh <code>player.die()</code> ƒë·ªÉ b√°o hi·ªáu l√† Chim ch·∫øt. </p>
<p>H√†m n√†y c√≤n ki·ªÉm tra bi·∫øn <code>clicked</code> ƒë·ªÉ nh·∫≠n bi·∫øt khi n√†o n√∫t b·∫•m ƒë∆∞·ª£c nh·∫•n, n·∫øu c√≥ th√¨ s·∫Ω g·ªçi l·ªánh <code>player.flyUp()</code> ƒë·ªÉ chim bay l√™n.</p>
<p>Cu·ªëi c√πng g·ªçi c√°c h√†m <code>render()</code> ƒë·ªÉ v·∫Ω c√°c ƒë·ªëi t∆∞·ª£ng hi·ªán c√≥ ra m√†n h√¨nh.</p>
<p>N·∫øu chim ƒë√£ ch·∫øt th√¨ kh·ªëi l·ªánh <code>else</code> s·∫Ω ƒë∆∞·ª£c ch·∫°y ƒë·ªÉ in ra m√†n h√¨nh d√≤ng ch·ªØ &quot;Game Over&quot;, ƒë·ªìng th·ªùi reset l·∫°i game khi ng∆∞·ªùi d√πng b·∫•m v√†o Push Button.</p>
<h3 id="xong-r-i-y">Xong r·ªìi ƒë·∫•y</h3>
<p>B√¢y gi·ªù, m·ªçi th·ª© ƒë√£ ho√†n th√†nh, b·∫°n c√≥ th·ªÉ nh·∫•n n√∫t <strong>Run</strong> ƒë·ªÉ build v√† n·∫°p ch∆∞∆°ng tr√¨nh v√†o Arduino, sau ƒë√≥ th∆∞·ªüng th·ª©c th√†nh qu·∫£ c·ªßa m√¨nh. </p>
<p>C√°c b·∫°n c√≥ th·ªÉ tham kh·∫£o m√£ ngu·ªìn c·ªßa game t·∫°i Github: <a href="https://github.com/huytd/arduino-flappybird">https://github.com/huytd/arduino-flappybird</a></p>
<meta property="og:site_name" content="L√†m game Flappy Bird tr√™n Arduino | Huy's Blog"/>
                <div class="copyright">
                B·∫°n ƒë∆∞·ª£c t√πy √Ω b·∫•m like, tr√≠ch d·∫´n ho·∫∑c copy, post l·∫°i, nh∆∞ng vui l√≤ng ghi r√µ ngu·ªìn v√† t√°c gi·∫£ v√† kh√¥ng l√†m thay ƒë·ªïi n·ªôi dung b√†i vi·∫øt. N·∫øu kh√¥ng l√†m v·∫≠y, m√¨nh hy v·ªçng t·ª´ nay v·ªÅ sau b·∫°n s·∫Ω lu√¥n c·∫£m th·∫•y c·∫Øn r·ª©t l∆∞∆°ng t√¢m, ƒÉn kh√¥ng ngon, ng·ªß kh√¥ng y√™n. üòÜ
                </div>
                <div class="fb-like" data-href="http://huytd.github.io/posts/lam-game-flappy-bird-tren-arduino.html" data-layout="standard" data-action="like" data-show-faces="true" data-share="true"></div>
                <div id="disqus_thread"></div>
                <script>
                /**
                * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
                * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
                */
                /*
                var disqus_config = function () {
                this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
                this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                };
                */
                (function() { // DON'T EDIT BELOW THIS LINE
                var d = document, s = d.createElement('script');

                s.src = '//huysblog.disqus.com/embed.js';

                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
                })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
            </div>
        </div>
	    <div class="footer">
            <p>Created with <a href="http://github.com/huytd/azeroth-js">azeroth.js</a></p>
            <div class="social">
                <a target="_blank" href="http://facebook.com/kingbazoka"><i class="icon-facebook-squared"></i></a>
                <a target="_blank" href="http://twitter.com/huydotnet"><i class="icon-twitter-squared"></i></a>
                <a target="_blank" href="http://github.com/huytd"><i class="icon-github-squared"></i></a>
                <a target="_blank" href="https://thefullsnack.com"><i class="icon-emo-coffee"></i></a>
            </div>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-71353335-1', 'auto');
          ga('send', 'pageview');
        </script>
        <script>
          window.fbAsyncInit = function() {
            FB.init({
              appId      : '462066520669072',
              xfbml      : true,
              version    : 'v2.6'
            });

            FB.Event.subscribe('edge.create', function(url) {
              ga('send', 'social', 'facebook', 'like', url);
            });
          };

          (function(d, s, id){
             var js, fjs = d.getElementsByTagName(s)[0];
             if (d.getElementById(id)) {return;}
             js = d.createElement(s); js.id = id;
             js.src = "//connect.facebook.net/en_US/sdk.js";
             fjs.parentNode.insertBefore(js, fjs);
           }(document, 'script', 'facebook-jssdk'));
        </script>
        <script id="dsq-count-scr" src="//huysblog.disqus.com/count.js" async></script>
        <script type="text/javascript" async src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>
        <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [['$','$'], ['\\(','\\)']],
            skipTags: ["script","noscript","style","textarea"]
          }
        });
        </script>
    </body>
</html>
