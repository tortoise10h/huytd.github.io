<html>
    <head>
        <title> T·ª± vi·∫øt Emulator: CHIP-8 Interpreter | Huy's Blog</title>
        <meta charset="utf-8">
        <meta http-equiv="content-type" content="text/html;"><meta name=viewport content="initial-scale=1.0 maximum-scale=1.0">
        
        <link href="../css/theme.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="../css/highlight/tomorrow.css">
        <link rel="stylesheet" href="../css/fontello.css">
        <script src="../js/highlight.pack.js"></script>
        <script>
        hljs.initHighlightingOnLoad();
        </script>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    </head>
    <body>
        <div class="header">
            <a href="/"><i class="icon icon-emo-coffee"></i> Huy's Blog</a>
        </div>
        <div class="container">
            <div class="main">
                <h1 id="t-vi-t-emulator-chip-8-interpreter">T·ª± vi·∫øt Emulator: CHIP-8 Interpreter</h1>
<p>Nh·∫Øc ƒë·∫øn game gi·∫£ l·∫≠p, ch·∫Øc kh√¥ng ai l·∫° g√¨ v√† ai c≈©ng t·ª´ng ch∆°i qua (gi·∫£ l·∫≠p NES, Gameboy, PS1, PS2,...)</p>
<p>V√† ch·∫Øc h·∫≥n, c≈©ng c√≥ kh√¥ng √≠t b·∫°n nung n·∫•u √Ω ƒë·ªãnh t·ª± vi·∫øt m·ªôt b·ªô emulator cho ri√™ng m√¨nh nh∆∞ng kh√¥ng bi·∫øt b·∫Øt ƒë·∫ßu t·ª´ ƒë√¢u.</p>
<p>M√¨nh c≈©ng v·∫≠y, lu√¥n m∆° c√≥ m·ªôt ng√†y s·∫Ω t·ª± vi·∫øt ƒë∆∞·ª£c m·ªôt b·ªô gi·∫£ l·∫≠p cho NES, Gameboy hay th·∫≠m ch√≠ l√† Play Station :)) nh∆∞ng v·∫´n d·∫≠m ch√¢n t·∫°i ch·ªó trong nhi·ªÅu nƒÉm tr·ªùi ch·ªâ v√¨ kh√¥ng bi·∫øt ph·∫£i b·∫Øt ƒë·∫ßu nh∆∞ th·∫ø n√†o.</p>
<p>Nh·ªØng t√†i li·ªáu, b√†i vi·∫øt n√≥i v·ªÅ gi·∫£ l·∫≠p NES hay Gameboy tr√†n lan tr√™n m·∫°ng r·∫•t nhi·ªÅu, nh∆∞ng ƒëa s·ªë ƒë·ªÅu b·ªã m√¨nh v·ª©t qua m·ªôt b√™n v√¨ ƒë·ªçc kh√¥ng hi·ªÉu g√¨ c·∫£ :sweat_smile: th·∫ø n√™n m√¨nh quy·∫øt ƒë·ªãnh s·∫Ω t·∫°m g√°c √Ω ƒë·ªãnh gi·∫£ l·∫≠p m√°y NES hay Gameboy sang m·ªôt b√™n v√† b·∫Øt ƒë·∫ßu v·ªõi m·ªôt lo·∫°i ƒë∆°n gi·∫£n h∆°n - ƒë√≥ l√† <strong>CHIP-8</strong>.</p>
<p><img src="https://s3-ap-southeast-1.amazonaws.com/kipalog.com/pong.png_d4gokk7w44" alt="alt text"></p>
<p>Lo·∫°t b√†i n√†y s·∫Ω c√≥ 3 ph·∫ßn:</p>
<ol>
<li><strong>Ph·∫ßn 1:</strong> Gi·ªõi thi·ªáu CHIP-8 v√† c√°c kh√°i ni·ªám c∆° b·∫£n</li>
<li><strong>Ph·∫ßn 2:</strong> T·∫≠p l·ªánh c·ªßa CHIP-8</li>
<li><strong>Ph·∫ßn 3:</strong> Implement</li>
</ol>
<p>C√°c b·∫°n ch·ªâ th·ª±c s·ª± ƒë·ª•ng ƒë·∫øn code t·ª´ ph·∫ßn 3, d·ª•c t·ªëc b·∫•t ƒë·∫°t, v·∫≠y n√™n, c·ª© b√¨nh tƒ©nh v√† t·ª´ t·ª´ m√† nu·ªët tr√¥i h·∫øt c√°i ƒë·ªëng kh√°i ni·ªám n√†y. Kh√¥ng th·ª´a ƒë√¢u :D</p>
<hr>
<h1 id="ph-n-1-gi-i-thi-u-chip-8-v-c-c-kh-i-ni-m-c-b-n">Ph·∫ßn 1: Gi·ªõi thi·ªáu CHIP-8 v√† c√°c kh√°i ni·ªám c∆° b·∫£n</h1>
<hr>
<p>V·∫≠y CHIP-8 l√† c√°i g√¨? t·∫°i sao kh√¥ng ph·∫£i NES, Gameboy m√† l·∫°i l√† CHIP-8?</p>
<h1 id="ph-n-1-m-t-s-kh-i-ni-m-c-b-n">Ph·∫ßn 1: M·ªôt s·ªë kh√°i ni·ªám c∆° b·∫£n</h1>
<h2 id="gi-l-p-l-g-">Gi·∫£ l·∫≠p l√† g√¨?</h2>
<p>Th·ª±c ra ch·∫Øc kh√¥ng ai th·∫Øc m·∫Øc c√°i n√†y ƒë√¢u, nh∆∞ng ƒë·ªÅ ph√≤ng l·ª° c√≥ ai th·∫Øc m·∫Øc th√¨: Gi·∫£ l·∫≠p l√† m·ªôt ph·∫ßn m·ªÅm m√¥ ph·ªèng l·∫°i ho·∫°t ƒë·ªông c·ªßa m·ªôt c√°i g√¨ ƒë√≥. Trong tr∆∞·ªùng h·ª£p n√†y, ch√∫ng ta ƒëang chu·∫©n b·ªã vi·∫øt ph·∫ßn m·ªÅm m√¥ ph·ªèng ho·∫°t ƒë·ªông c·ªßa tr√¨nh th√¥ng d·ªãch CHIP-8 (CHIP-8 interpreter)</p>
<h2 id="chip-8-l-g-">CHIP-8 l√† g√¨?</h2>
<p>CHIP-8 l√† m·ªôt ng√¥n ng·ªØ th√¥ng d·ªãch (interpreted programming language), thi·∫øt k·∫ø b·ªüi Joseph Weisbecker, ƒë∆∞·ª£c d√πng cho c√°c m√°y t√≠nh 8-bit COSMAC VIP v√† Telmac 1800 v√†o nh·ªØng nƒÉm 1970.</p>
<p><img src="http://www.chip8.com/telmac1800/telmac1800_1.jpg" alt="M√°y t√≠nh Telmac 1800"></p>
<p>C√°c m√°y t√≠nh n√†y c√≥ ƒë·∫ßy ƒë·ªß c√°c th√†nh ph·∫ßn nh∆∞ m√†n h√¨nh (2 m√†u ƒëen tr·∫Øng), √¢m thanh v√† b√†n ph√≠m (nh∆∞ng kh√¥ng ph·∫£i b√†n ph√≠m QWERTY nh∆∞ b√¢y gi·ªù).</p>
<p><img src="http://www.chip8.com/cosmacvip/CosmacVip4.jpg" alt="COSMAC VIP 4 v√† qu·∫£ b√†n ph√≠m kh√°c ng∆∞·ªùi c·ªßa n√≥"></p>
<p>Ng√†y nay, CHIP-8 v·∫´n c√≤n ƒë∆∞·ª£c s·ª≠ d·ª•ng trong c·ªông ƒë·ªìng hobby, v·ªõi s·ª± ƒë∆°n gi·∫£n v·ªÅ c·∫•u tr√∫c c≈©ng nh∆∞ t·∫≠p l·ªánh nh·ªè (ch·ªâ c√≥ 36 l·ªánh), CHIP-8 Interpreter (th∆∞·ªùng b·ªã nh·∫ßm l·∫´n l√† CHIP-8 Emulator) ƒë√£ tr·ªü th√†nh ·ª©ng d·ª•ng ƒë∆∞·ª£c ƒëa s·ªë c√°c l·∫≠p tr√¨nh vi√™n l·ª±a ch·ªçn khi mu·ªën b·∫Øt ƒë·∫ßu con ƒë∆∞·ªùng l·∫≠p tr√¨nh emulator c·ªßa m√¨nh.</p>
<h2 id="t-i-sao-l-i-ch-n-chip-8-">T·∫°i sao l·∫°i ch·ªçn CHIP-8?</h2>
<p>S·ªü dƒ© ch·ªçn CHIP-8 thay v√¨ NES hay Gameboy l√† v√¨ c·∫•u tr√∫c ƒë∆°n gi·∫£n c·ªßa n√≥. C·∫•u tr√∫c ch·ªâ c√≥ m·ªôt b·ªô x·ª≠ l√Ω v√† s·ªë t·∫≠p l·ªánh c·ª±c k√¨ √≠t, ch∆∞a k·ªÉ ƒë·∫øn khi l√†m vi·ªác v·ªõi c√°c h·ªá m√°y kh√°c, b·∫°n c√≤n ph·∫£i ƒëau ƒë·∫ßu v·ªõi vi·ªác gi·∫£ l·∫≠p nh·ªØng module kh√°c, kh√¥ng h·ªÅ th√≠ch h·ª£p cho ng∆∞·ªùi m·ªõi b·∫Øt ƒë·∫ßu.</p>
<p>Ng∆∞·ª£c l·∫°i, sau khi ho√†n th√†nh ƒë∆∞·ª£c m·ªôt b·∫£n CHIP-8 emulator cho ri√™ng m√¨nh, b·∫°n s·∫Ω c√≥ ƒë·ªß ki·∫øn th·ª©c <strong>c∆° b·∫£n</strong> ƒë·ªÉ ti·∫øp t·ª•c nghi√™n c·ª©u c√°c h·ªá m√°y kh√°c nh∆∞ NES hay Gameboy.</p>
<h2 id="chu-n-b-ki-n-th-c">Chu·∫©n b·ªã ki·∫øn th·ª©c</h2>
<p>ƒê·ªÉ b·∫Øt ƒë·∫ßu con ƒë∆∞·ªùng l·∫≠p tr√¨nh Emulator, b·∫°n ch·∫Øc ch·∫Øn c·∫ßn ph·∫£i c√≥ c√°c ki·∫øn th·ª©c v·ªÅ:</p>
<ul>
<li>C√°c ph√©p to√°n thao t√°c bit (bitwise operation)</li>
<li>M√£ m√°y (Assembly)</li>
</ul>
<p>N·∫øu ƒë·ªçc ƒë·∫øn ƒë√¢y m√† b·∫°n ƒë√£ b·∫Øt ƒë·∫ßu th·∫•y ng·∫°i v√¨ kh√¥ng c√≥ nh·ªØng ki·∫øn th·ª©c n√†y th√¨ c≈©ng kh√¥ng sao. C·ª© ƒë·ªçc ti·∫øp, trong b√†i m√¨nh s·∫Ω c·ªë g·∫Øng gi·∫£i th√≠ch th·∫≠t kƒ© c√°c kh√°i ni·ªám c·∫ßn thi·∫øt. :trollface:</p>
<h2 id="rom-v-nguy-n-l-ho-t-ng-c-a-chip-8">ROM v√† nguy√™n l√Ω ho·∫°t ƒë·ªông c·ªßa CHIP-8</h2>
<h3 id="rom-l-g-">ROM l√† g√¨?</h3>
<p>Khi s·ª≠ d·ª•ng b·∫•t c·ª© m·ªôt ph·∫ßn m·ªÅm gi·∫£ l·∫≠p cho b·∫•t k√¨ h·ªá m√†y g√¨, ch√∫ng ta ƒë·ªÅu nh·∫Øc ƒë·∫øn kh√°i ni·ªám ROM.</p>
<p>Hi·ªÉu ƒë∆°n gi·∫£n, ROM l√† m·ªôt t·∫≠p h·ª£p c√°c l·ªánh th·ª±c thi, c√≤n g·ªçi l√† <strong>opcode</strong> (operation code). C√°c opcode n√†y l√† c√°c l·ªánh ƒë∆∞·ª£c h·ªó tr·ª£ b·ªüi b·ªô x·ª≠ l√Ω.</p>
<p>V√≠ d·ª•, ƒë·ªëi v·ªõi CHIP-8, opcode c√≥ m√£ hex l√† <em>0x00E0</em> l√†m nhi·ªám v·ª• xo√° to√†n b·ªô m√†n h√¨nh, opcode c√≥ m√£ hex <em>0xD123</em> c√≥ nhi·ªám v·ª• v·∫Ω c√°i g√¨ ƒë√≥ ra m√†n h√¨nh.</p>
<h3 id="nguy-n-l-ho-t-ng-c-a-chip-8">Nguy√™n l√Ω ho·∫°t ƒë·ªông c·ªßa CHIP-8</h3>
<p>Khi ho·∫°t ƒë·ªông, tr√¨nh th√¥ng d·ªãch (intepreter) CHIP-8 s·∫Ω ƒë·ªçc c√°c opcode t·ª´ ROM, ƒë∆∞a v√†o b·ªô nh·ªõ (RAM) r·ªìi CPU s·∫Ω ch·∫°y qua t·ª´ng opcode ƒë√£ ƒë·ªçc ƒë∆∞·ª£c v√† th·ª±c thi ch√∫ng. D·ªØ li·ªáu n·∫øu c·∫ßn s·∫Ω ƒë∆∞·ª£c ghi tr·ªü l·∫°i v√†o RAM.</p>
<p>T√≥m t·∫Øt c√≥ th·ªÉ xem trong h√¨nh sau:</p>
<p><img src="https://s3-ap-southeast-1.amazonaws.com/kipalog.com/fetchexecute.png_zf61jmls9a" alt=""></p>
<p>Gi·∫£ l·∫≠p m√† ch√∫ng ta s·∫Øp vi·∫øt, s·∫Ω m√¥ ph·ªèng ƒë√∫ng y qu√° tr√¨nh n√†y.</p>
<h2 id="c-c-th-nh-ph-n-c-b-n-c-a-m-t-thi-t-b-chip-8">C√°c th√†nh ph·∫ßn c∆° b·∫£n c·ªßa m·ªôt thi·∫øt b·ªã CHIP-8</h2>
<p>M·ªôt thi·∫øt b·ªã s·ª≠ d·ª•ng CHIP-8 c√≥ c√°c th√†nh ph·∫ßn c∆° b·∫£n sau:</p>
<ul>
<li>B·ªô nh·ªõ (memory)</li>
<li>C√°c thanh ghi (registers)</li>
<li>M√†n h√¨nh hi·ªÉn th·ªã</li>
<li>B√†n ph√≠m, Timers.</li>
</ul>
<p>V√† nhi·ªám v·ª• c·ªßa ch√∫ng ta l√† m√¥ ph·ªèng c√°c th√†nh ph·∫ßn n√†y. V√¨ th·∫ø, ch√∫ng ta ph·∫£i bi·∫øt c·∫•u tr√∫c, nhi·ªám v·ª•, ch·ª©c nƒÉng c·ªßa m·ªói ph·∫ßn.</p>
<h3 id="memory">Memory</h3>
<p>B·ªô nh·ªõ c·∫ßn d√πng c·ªßa m·ªôt thi·∫øt b·ªã CHIP-8 l√† 4KB (4096 bytes). ƒê∆∞·ª£c ƒë√°nh s·ªë t·ª´ 0x000 (0) ƒë·∫øn 0xFFF (4095).</p>
<p><img src="https://s3-ap-southeast-1.amazonaws.com/kipalog.com/memoryMap.png_wonyqqhp6c" alt="alt text"></p>
<p>512 bytes ƒë·∫ßu ti√™n (t·ª´ 0x000 ƒë·∫øn 0x1FF) l√† v·ªã tr√≠ c·ªßa tr√¨nh th√¥ng d·ªãch (interpreter) v√† ch∆∞∆°ng tr√¨nh c·ªßa ch√∫ng ta kh√¥ng th·ªÉ truy xu·∫•t ƒë·∫øn c√°c ƒë·ªãa ch·ªâ n√†y.</p>
<p>B·∫Øt ƒë·∫ßu t·ª´ v·ªã tr√≠ 0x200 cho ƒë·∫øn 0xFFF l√† n∆°i m√† ch∆∞∆°ng tr√¨nh c·ªßa ch√∫ng ta ƒë∆∞·ª£c n·∫°p v√†o.</p>
<p>V√† interpreter s·∫Ω b·∫Øt ƒë·∫ßu ch·∫°y ch∆∞∆°ng tr√¨nh t·ª´ v·ªã tr√≠ 0x200 (tr√™n c√°c m√°y ETI 660 th√¨ ƒëi·ªÉm b·∫Øt ƒë·∫ßu s·∫Ω l√† 0x600)</p>
<h3 id="registers">Registers</h3>
<p><img src="https://s3-ap-southeast-1.amazonaws.com/kipalog.com/REGISTERS.png_4bexqwfunq" alt=""></p>
<p>CHIP-8 c√≥ 16 thanh ghi ƒëa d·ª•ng (general purpose registers) 8 bit, th∆∞·ªùng ƒë∆∞·ª£c ƒë√°nh s·ªë  l√† Vx, v·ªõi x l√† c√°c s·ªë hexa t·ª´ 0 ƒë·∫øn F.</p>
<p>Thanh ghi VF m·∫∑c d√π t·ªìn t·∫°i nh∆∞ng ch∆∞∆°ng tr√¨nh kh√¥ng th·ªÉ s·ª≠ d·ª•ng v√¨ n√≥ ƒë∆∞·ª£c d√πng l√†m c·ªù (flag) cho m·ªôt s·ªë l·ªánh. C√°i n√†y m√¨nh s·∫Ω gi·∫£i th√≠ch ·ªü b√†i sau, khi ƒëi v√†o chi ti·∫øt c√°c l·ªánh.</p>
<p>Ti·∫øp ƒë·∫øn l√† thanh ghi <strong>I</strong>, ƒë∆∞·ª£c d√πng ƒë·ªÉ l∆∞u c√°c ƒë·ªãa ch·ªâ trong b·ªô nh·ªõ. ·ªû ph·∫ßn sau ch√∫ng ta s·∫Ω hi·ªÉu r√µ c∆° ch·∫ø ho·∫°t ƒë·ªông c·ªßa thanh ghi n√†y h∆°n.</p>
<p>Ngo√†i ra c√≤n c√≥ 2 timer ƒë·∫∑c bi·ªát l√† Delay Timer v√† Sound Timer, s·∫Ω n√≥i ·ªü b√™n d∆∞·ªõi. C√°c register n√†y ch·ª©a m·ªôt gi√° tr·ªã 8 bit.</p>
<h3 id="keyboard">Keyboard</h3>
<p>B√†n ph√≠m c·ªßa m√°y t√≠nh s·ª≠ d·ª•ng CHIP-8 th∆∞·ªùng c√≥ d·∫°ng 16 ph√≠m hexa. Khi vi·∫øt emulator, ch√∫ng ta n√™n map c√°c ph√≠m n√†y v√†o b√†n ph√≠m m√°y t√≠nh b√¢y gi·ªù. Nh∆∞ h√¨nh sau:</p>
<p><img src="https://s3-ap-southeast-1.amazonaws.com/kipalog.com/keymapping.png_5tx79z88xo" alt="B√™n tr√°i l√† b√†n ph√≠m hexa, b√™n ph·∫£i l√† b√†n ph√≠m m√°y t√≠nh th·ªùi b√¢y gi·ªù">
<em>(B√™n tr√°i l√† b√†n ph√≠m hexa th·ªùi c·ªï ƒë·∫°i, b√™n ph·∫£i l√† b√†n ph√≠m m√°y t√≠nh th·ªùi b√¢y gi·ªù)</em></p>
<p>Vi·ªác map ph√≠m nh∆∞ th·∫ø n√†o l√† tu·ª≥ √Ω c√°c b·∫°n, nh∆∞ng trong b√†i vi·∫øt n√†y s·∫Ω map nh∆∞ v·∫≠y, n√™n code c≈©ng s·∫Ω theo layout n√†y.</p>
<h2 id="display">Display</h2>
<p>M√†n h√¨nh tr√™n c√°c thi·∫øt b·ªã CHIP-8 l√† m√†n h√¨nh ƒë∆°n s·∫Øc (monochrome), c√≥ ƒë·ªô ph√¢n gi·∫£i 64x32 pixel.</p>
<p><img src="https://s3-ap-southeast-1.amazonaws.com/kipalog.com/display.png_ac5l516r70" alt="alt text"></p>
<p>M·ªôt s·ªë m√°y ETI 660 c√≥ ƒë·ªô ph√¢n gi·∫£i 64x48 ho·∫∑c 64x64 pixel.</p>
<p>CHIP-8 v·∫Ω c√°c h√¨nh ·∫£nh l√™n m√†n h√¨nh th√¥ng qua c√°c sprites. Sprite l√† m·ªôt t·∫≠p h·ª£p nhi·ªÅu bytes chuy·ªÉn t·ª´ d·ªØ li·ªáu binary t∆∞∆°ng ·ª©ng v·ªõi h√¨nh ·∫£nh m√† ch√∫ng ta c·∫ßn v·∫Ω. M·ªói byte c√≥ 8 bit, nh∆∞ v·∫≠y m·ªôt sprite s·∫Ω c√≥ k√≠ch th∆∞·ªõc 8x<strong>N</strong> (trong ƒë√≥ N l√† tu·ª≥ √Ω, t·ª´ 1 ƒë·∫øn 15)</p>
<p>C√°c CHIP-8 interpreter th∆∞·ªùng c√≥ m·ªôt b·ªô font c√†i ƒë·∫∑t s·∫µn (built-in), ƒë∆∞·ª£c l∆∞u trong memory (·ªü v√πng 0x000 - 0x1FF) m·ªói k√≠ t·ª± trong b·ªô font n√†y th·ª±c ch·∫•t l√† c√°c sprite c√≥ k√≠ch th∆∞·ªõc 8x5 (t·ª©c l√† c√≥ 5 bytes).</p>
<p><img src="https://s3-ap-southeast-1.amazonaws.com/kipalog.com/hexfont.png_kaigppiffk" alt="alt text"></p>
<h2 id="timers-v-sound">Timers v√† Sound</h2>
<p>Timer, ƒë√∫ng theo t√™n g·ªçi c·ªßa n√≥, th√¨ l√† m·ªôt c√°i b·ªô ƒë·∫øm (b√™n ƒëi·ªán t·ª≠ nhi·ªÅu ng∆∞·ªùi g·ªçi l√† <strong>b·ªô ƒë·ªãnh th·ªùi</strong>). Ch·ª©c nƒÉng c·ªßa n√≥ ƒë∆°n gi·∫£n l√†: khi ƒë∆∞·ª£c k√≠ch ho·∫°t, n√≥ s·∫Ω b·∫Øt ƒë·∫ßu ƒë·∫øm ng∆∞·ª£c theo m·ªôt chu k√¨ th·ªùi gian n√†o ƒë√≥, ƒë·∫øn m·ªôt l√∫c n√†o ƒë√≥ n√≥ s·∫Ω ng·ª´ng.</p>
<p>Trong CHIP-8, ch√∫ng ta c√≥ 2 timers: <strong>Delay timer</strong> v√† <strong>Sound timer</strong></p>
<p><strong>Delay timer</strong> l√† m·ªôt b·ªô ƒë·∫øm ƒë∆∞·ª£c k√≠ch ho·∫°t khi gi√° tr·ªã c·ªßa thanh ghi Delay Timer (DT) - ƒë√£ ƒë·ªÅ c·∫≠p ·ªü ph·∫ßn Register, xem h√¨nh - l√† kh√°c 0. Gi√° tr·ªã n√†y s·∫Ω t·ª± ƒë·ªông gi·∫£m (tr·ª´ 1) li√™n t·ª•c theo chu k√¨ c√≥ t·∫ßn s·ªë 60Hz (60 l·∫ßn 1 gi√¢y). Khi n√†o n√≥ v·ªÅ 0 th√¨ timer s·∫Ω ng∆∞ng ho·∫°t ƒë·ªông.</p>
<p><img src="https://s3-ap-southeast-1.amazonaws.com/kipalog.com/delayTimer.png_hdj9rkqc88" alt="alt text"></p>
<p>M·ª•c ƒë√≠ch c·ªßa Delay timer l√† l√†m cho ch∆∞∆°ng tr√¨nh ng·ª´ng l·∫°i trong m·ªôt kho·∫£ng th·ªùi gian, gi·ªëng nh∆∞ c√°c h√†m <code>Delay()</code> hay <code>Sleep()</code> ·ªü c√°c ng√¥n ng·ªØ l·∫≠p tr√¨nh kh√°c.</p>
<p><strong>Sound timer</strong> c≈©ng t∆∞∆°ng t·ª± nh∆∞ Delay timer, khi gi√° tr·ªã c·ªßa thanh ghi Sound Timer (ST) kh√°c 0 th√¨ n√≥ s·∫Ω t·ª± ƒë·ªông k√≠ch ho·∫°t, v√† gi·∫£m gi√° tr·ªã n√†y theo chu k√¨ t·∫ßn s·ªë 60Hz, r·ªìi ng∆∞ng khi n√≥ v·ªÅ 0. Nh∆∞ng ƒëi·ªÉm kh√°c bi·ªát l√†, ch·ª´ng n√†o gi√° tr·ªã trong thanh ghi ST kh√°c 0 th√¨ c√°i loa (buzzer) c·ªßa m√°y s·∫Ω h√∫ :))</p>
<p><img src="https://s3-ap-southeast-1.amazonaws.com/kipalog.com/soundTimer.png_uqkre5l3e6" alt="alt text"></p>
<hr>
<p>Ph√π!!! Th·∫ø l√† c≈©ng xong ph·∫ßn l√Ω thuy·∫øt. D√†i qu√° nh∆∞ng ƒë·ªÅ ngh·ªã c√°c b·∫°n ƒë·ª´ng c√≥ nh·∫£y c√≥c. V√¨ tr√™n ƒë√¢y l√† nh·ªØng kh√°i ni·ªám r·∫•t quan tr·ªçng c·∫ßn ph·∫£i c√≥ tr∆∞·ªõc khi b·∫Øt tay v√†o vi·∫øt Emulator.</p>
<p>Hy v·ªçng c√°c b·∫°n ƒë√£ hi·ªÉu ƒë∆∞·ª£c c∆° ch·∫ø ho·∫°t ƒë·ªông v√† ph·∫ßn n√†o h√¨nh dung ra ƒë∆∞·ª£c h∆∞·ªõng ƒëi m√† ch√∫ng ta ƒëang th·ª±c hi·ªán.</p>
<p>Ti·∫øp theo, m√¨nh s·∫Ω gi·ªõi thi·ªáu v√† gi·∫£i th√≠ch t·∫≠p l·ªánh (instruction set) c·ªßa CHIP-8, v√† n√≥i s∆° v·ªÅ c√¥ng d·ª•ng c·ªßa ch√∫ng trong th·ª±c t·∫ø.</p>
<h1 id="ph-n-2-t-p-l-nh-c-a-chip-8">Ph·∫ßn 2: T·∫≠p l·ªánh c·ªßa CHIP-8</h1>
<hr>
<h1 id="c-u-tr-c-opcode">C·∫•u tr√∫c opcode</h1>
<p>Nh∆∞ ƒë√£ n√≥i, m·ªôt ch∆∞∆°ng tr√¨nh CHIP-8 l√† m·ªôt t·∫≠p h·ª£p c√°c <code>opcode</code> d∆∞·ªõi d·∫°ng hexa. V√≠ d·ª•, ƒë√¢y l√† m·ªôt ƒëo·∫°n n·ªôi dung khi ƒë·ªçc file rom game PONG:</p>
<p><img src="https://s3-ap-southeast-1.amazonaws.com/kipalog.com/opcodestruct.png_rvtgccz886" alt="alt text"></p>
<p>M·ªói <code>opcode</code> c√≥ ƒë·ªô d√†i 2 byte v√† d∆∞·ª£c th·ªÉ hi·ªán b·ªüi 4 k√≠ t·ª± hexa. Ch√∫ng ta s·∫Ω ƒë·ªçc 2 byte n√†y v√† chuy·ªÉn v·ªÅ m√£ Assembly ƒë∆°n gi·∫£n ƒë·ªÉ d·ªÖ h√¨nh dung, v√† c√¥ng vi·ªác s·∫Ω l√†: implement c√°c ch·ª©c nƒÉng m√† c√°c c√¢u l·ªánh Assembly n√†y th·ª±c hi·ªán.</p>
<p>ƒê·ªÉ l∆∞u v·ªã tr√≠ c·ªßa opcode hi·ªán t·∫°i, ch√∫ng ta d√πng m·ªôt gi√° tr·ªã g·ªçi l√† <code>Program Counter</code> (PC)</p>
<p>V√≠ d·ª•, l·ªánh ƒë∆°n gi·∫£n nh·∫•t l√† <code>0x00E0</code>, g·ªìm c√≥ 2 byte <code>00</code> v√† <code>E0</code>, d·ªãch ra m√£ m√°y l√† <code>CLS</code> c√≥ nhi·ªám v·ª• xo√° to√†n b·ªô n·ªôi dung m√†n h√¨nh. Hay nh∆∞ h√¨nh tr√™n, ch√∫ng ta c√≥ opcode l√† <code>0x82E4</code>, trong ƒë√≥ c√≥ 2 gi√° tr·ªã <code>x = 2</code> v√† <code>y = E</code> (s·∫Ω gi·∫£i th√≠ch b√™n d∆∞·ªõi), d·ªãch ra m√£ m√°y s·∫Ω l√† <code>ADD V2, VE</code>, c√≥ nhi·ªám v·ª• c·ªông gi√° tr·ªã c·ªßa thanh ghi <code>VE</code> v√†o <code>V2</code> (<code>V2 = V2 + VE</code>).</p>
<h3 id="th-t-cao-th-p-c-a-c-c-bit-byte">Th·ª© t·ª± cao th·∫•p c·ªßa c√°c bit, byte</h3>
<p>M·ªói byte c√≥ <code>8 bit</code>, trong ƒë√≥ theo th·ª© t·ª± t·ª´ ph·∫£i qua tr√°i, c√°c bit s·∫Ω ƒë∆∞·ª£c g·ªçi t√™n t·ª´ th·∫•p ƒë·∫øn cao. V√† opcode c√≥ 2 byte, nh∆∞ v·∫≠y l√† <code>16 bit</code>, v√† theo th·ª© t·ª± n√†y, ta c√≥ c√°ch g·ªçi t√™n nh∆∞ h√¨nh sau:</p>
<p><img src="https://s3-ap-southeast-1.amazonaws.com/kipalog.com/highlowbyte.png_3adbxv1u1d" alt="alt text"></p>
<p>Bit th·∫•p l√† c√°c bit v·ªÅ ph√≠a b√™n ph·∫£i, v√† bit cao l√† c√°c bit v·ªÅ ph√≠a b√™n tr√°i. Bit cao nh·∫•t l√† bit th·ª© 1, bit th·∫•p nh·∫•t l√† bit th·ª© 16.</p>
<p>Byte ƒë·∫ßu ti√™n (1st Byte) ƒë∆∞·ª£c g·ªçi l√† <code>Byte cao</code> (High byte). Byte th·ª© 2 (2nd byte) ƒë∆∞·ª£c g·ªçi l√† <code>Byte th·∫•p</code> (low byte)</p>
<p>Ch√∫ng ta c√≥ th·ªÉ g·ªçi m·ªói <strong>4 bit</strong> l√† m·ªôt <strong>nibble</strong>.</p>
<h3 id="l-c-gi-tr-b-ng-ph-p-to-n-and">L·ªçc gi√° tr·ªã b·∫±ng ph√©p to√°n AND</h3>
<p>Trong c√°c ph√©p to√°n thao t√°c bit, ph√©p to√°n m√† ch√∫ng ta c·∫ßn s·ª≠ d·ª•ng nhi·ªÅu nh·∫•t trong qu√° tr√¨nh vi·∫øt Emulator l√† ph√©p to√°n <code>AND</code>.</p>
<p>Chi ti·∫øt v·ªÅ ph√©p to√°n <code>AND</code> b·∫°n c√≥ th·ªÉ xem t·∫°i: <a href="https://vi.wikipedia.org/wiki/Ph√©p_to√°n_thao_t√°c_bit">https://vi.wikipedia.org/wiki/Ph√©p_to√°n_thao_t√°c_bit</a></p>
<p>N·∫øu d√†i qu√° nh√°c ƒë·ªçc th√¨ ph√©p to√°n n√†y c√≥ th·ªÉ t√≥m t·∫Øt nh∆∞ h√¨nh sau:</p>
<p><img src="https://s3-ap-southeast-1.amazonaws.com/kipalog.com/andop.png_5xt4hz78x5" alt="alt text"></p>
<p>M·ªôt gi√° tr·ªã khi th·ª±c hi·ªán <code>AND</code> v·ªõi <code>0</code> th√¨ tr·∫£ v·ªÅ <code>0</code>, v√† v·ªõi <code>F</code> th√¨ tr·∫£ v·ªÅ ch√≠nh n√≥. Ch√∫ng ta d√πng ƒë·∫∑c t√≠nh n√†y ƒë·ªÉ l·ªçc v√† l·∫•y ra c√°c gi√° tr·ªã c·∫ßn thi·∫øt t·∫°i c√°c v·ªã tr√≠ mong mu·ªën b√™n trong m·ªôt opcode.</p>
<p>V√≠ d·ª•:</p>
<p><img src="https://s3-ap-southeast-1.amazonaws.com/kipalog.com/andopsample.png_cmi9maz49x" alt="alt text"></p>
<h1 id="c-c-tham-s-trong-opcode">C√°c tham s·ªë trong OPCODE</h1>
<p>·ªû v√≠ d·ª• tr√™n, ta th·∫•y opcode <code>0x82E4</code> nh·∫≠n v√†o 2 tham s·ªë <code>x = 2</code> v√† <code>y = E</code>, c√≥ t·∫•t c·∫£ 4 lo·∫°i tham s·ªë m√† ch√∫ng ta c·∫ßn l·∫•y ra t·ª´ opcode, tu·ª≥ theo t·ª´ng lo·∫°i/ch·ª©c nƒÉng c·ªßa opcode.</p>
<ul>
<li><p><strong>n</strong>: Tham s·ªë <code>n</code> l√† <strong>4 bit cu·ªëi c√πng</strong> (th·∫•p nh·∫•t) c·ªßa to√†n b·ªô opcode, c√≥ th·ªÉ l·∫•y b·∫±ng c√°ch s·ª≠ d·ª•ng ph√©p to√°n <code>opcode &amp; 0x000F</code>:</p>
<pre><code>// Gi·∫£ s·ª≠: opcode = 0x8C74
var n = opcode &amp; 0x000F;
// K·∫øt qu·∫£: n = 4
</code></pre></li>
<li><p><strong>nnn</strong>: Tham s·ªë <code>nnn</code> l√† <strong>12 bit th·∫•p nh·∫•t</strong> c·ªßa opcode, l√† k·∫øt qu·∫£ c·ªßa ph√©p t√≠nh <code>opcode &amp; 0x0FFF</code>:</p>
<pre><code>// Gi·∫£ s·ª≠: opcode = 0x8C74
var nnn = opcode &amp; 0x0FFF;
// K·∫øt qu·∫£: nnn = C74
</code></pre></li>
<li><p><strong>kk</strong>: Tham s·ªë <code>kk</code> l√† <strong>8 bit th·∫•p nh·∫•t</strong> c·ªßa opcode, t√≠nh b·∫±ng: <code>opcode &amp; 0x00FF</code>:</p>
<pre><code>// Gi·∫£ s·ª≠: opcode = 0x8C74
var kk = opcode &amp; 0x00FF;
// K·∫øt qu·∫£: kk = 74
</code></pre></li>
<li><p><strong>x</strong>: Tham s·ªë x ƒë∆∞·ª£c x√°c ƒë·ªãnh b·ªüi <strong>4 bit th·∫•p</strong> nh·∫•t c·ªßa <strong>Byte cao</strong> trong opcode, t·ª©c l√† c√°c bit 5, 6, 7, 8 . Nh∆∞ v·∫≠y, ta c√≥ th·ªÉ th·ª±c hi·ªán ph√©p to√°n AND: <code>opcode &amp; 0x0F00</code> k·∫øt h·ª£p ph√©p to√°n <code>d·ªãch bit</code> (shift) ƒë·ªÉ t√¨m ra <code>x</code>:</p>
<pre><code>// Gi·∫£ s·ª≠: opcode = 0x8C74
var x = (opcode &amp; 0x0F00) &gt;&gt; 8;
// K·∫øt qu·∫£ c·ªßa ph√©p (opcode &amp; 0x0F00) s·∫Ω tr·∫£ v·ªÅ 0x0C00
// v√† ta c·∫ßn d·ªãch chuy·ªÉn gi√° tr·ªã tr√™n 8 bit v·ªÅ b√™n ph·∫£i (&gt;&gt; 8)
// ƒë·ªÉ thu ƒë∆∞·ª£c gi√° tr·ªã 0x000C = C, l√† gi√° tr·ªã ta c·∫ßn t√¨m
// K·∫øt qu·∫£: x = C
</code></pre></li>
<li><p><strong>y</strong>: Tham s·ªë <code>y</code> ƒë∆∞·ª£c x√°c ƒë·ªãnh b·∫±ng <strong>4 bit cao</strong> c·ªßa <strong>Byte th·∫•p</strong> trong opcode, t·ª©c l√† c√°c bit 9, 10, 11, 12. V√† ta c√≥ th·ªÉ th·ª±c hi·ªán ph√©p to√°n <code>opcode &amp; 0x00F0</code> v√† <code>shift</code> ƒë·ªÉ t√¨m <code>y</code>:</p>
<pre><code>// Gi·∫£ s·ª≠: opcode = 0x8C74
var y = (opcode &amp; 0x00F0) &gt;&gt; 4;
// K·∫øt qu·∫£ c·ªßa (opcode &amp; 0x00F0) l√† 0x0070, n√™n ta c·∫ßn
// d·ªãch chuy·ªÉn gi√° tr·ªã tr√™n 4 bit v·ªÅ b√™n tr√°i (&gt;&gt; 4)
// ƒë·ªÉ thu ƒë∆∞·ª£c gi√° tr·ªã 0x0007 = 7
// K·∫øt qu·∫£: y = 7
</code></pre></li>
</ul>
<h1 id="t-p-l-nh-c-a-chip-8">T·∫≠p l·ªánh c·ªßa CHIP-8</h1>
<p>B√¢y gi·ªù, ch√∫ng ta s·∫Ω c√πng t√¨m hi·ªÉu ch·ª©c nƒÉng c·ªßa t·ª´ng opcode. Chi ti·∫øt c√°ch implement cho t·ª´ng opcode s·∫Ω c√≥ ·ªü b√†i sau.</p>
<p>N·∫øu b·∫°n th·∫Øc m·∫Øc l√† ch√∫ng ta c·∫ßn bi·∫øt ch·ª©c nƒÉng c·ªßa nh·ªØng l·ªánh n√†y l√†m g√¨, th√¨: b·∫±ng c√°ch implement t·ª´ng l·ªánh ri√™ng l·∫Ω, ch√∫ng ta s·∫Ω t·∫°o ƒë∆∞·ª£c m·ªôt tr√¨nh th√¥ng d·ªãch m√† d·ª±a v√†o nh·ªØng t·∫≠p l·ªánh ƒë√≥, c√°c l·∫≠p tr√¨nh vi√™n c√≥ th·ªÉ k·∫øt h·ª£p v√† vi·∫øt th√†nh m·ªôt ch∆∞∆°ng tr√¨nh ho·∫∑c m·ªôt tr√≤ ch∆°i ho√†n ch·ªânh.</p>
<p>B·∫°n s·∫Ω c·∫ßn t·∫≠p l·ªánh n√†y ƒë·ªÉ tham kh·∫£o khi impement.</p>
<h2 id="c-c-l-nh-v-x-l-logic">C√°c l·ªánh v·ªÅ x·ª≠ l√Ω logic</h2>
<h3 id="00e0-cls">00E0 - CLS</h3>
<p>Opcode c√≥ gi√° tr·ªã <code>0x00E0</code> c√≥ th·ªÉ chuy·ªÉn th√†nh m√£ assembly t∆∞∆°ng ·ª©ng l√† <code>CLS</code>, c√≥ nhi·ªám v·ª• xo√° to√†n b·ªô m·∫ßn h√¨nh.</p>
<h3 id="1nnn-jp-addr">1nnn - JP addr</h3>
<p>Opcode c√≥ d·∫°ng <code>0x1nnn</code> c√≥ m√£ assembly t∆∞∆°ng ·ª©ng l√† <code>JP nnn</code>, c√≥ nhi·ªám v·ª• ƒë∆∞a <code>program counter</code> ƒë·∫øn ƒë·ªãa ch·ªâ <code>nnn</code> (t·ª©c l√† nh·∫£y ƒë·∫øn m·ªôt ƒëo·∫°n n√†o ƒë√≥ trong ch∆∞∆°ng tr√¨nh)</p>
<h3 id="2nnn-call-addr">2nnn - CALL addr</h3>
<p>Opcode c√≥ d·∫°ng <code>0x2nnn</code> c√≥ m√£ assembly t∆∞∆°ng ·ª©ng l√† <code>CALL nnn</code>, c√≥ nhi·ªám v·ª• g·ªçi m·ªôt <code>subroutine</code> (c√≥ th·ªÉ hi·ªÉu l√† ch∆∞∆°ng tr√¨nh con) b·∫Øt ƒë·∫ßu t·∫°i v·ªã tr√≠ <code>nnn</code>. V·ªã tr√≠ hi·ªán t·∫°i c·ªßa <code>progam counter</code> tr∆∞·ªõc khi th·ª±c hi·ªán vi·ªác g·ªçi <code>subroutine</code> s·∫Ω ƒë∆∞·ª£c l∆∞u v√†o <code>stack</code></p>
<h3 id="00ee-ret">00EE - RET</h3>
<p>Opcode c√≥ gi√° tr·ªã <code>0x00EE</code> c√≥ m√£ assembly t∆∞∆°ng ·ª©ng l√† <code>RET</code>. Khi g·∫∑p l·ªánh n√†y, interpreter s·∫Ω ƒë∆∞a <code>program counter</code> v·ªÅ v·ªã tr√≠ cu·ªëi c√πng l∆∞u trong <code>stack</code> (t·ª©c lf tho√°t kh·ªèi <code>sobroutine</code>/ch∆∞∆°ng tr√¨nh con)</p>
<h3 id="3xkk-se-vx-byte">3xkk - SE Vx, byte</h3>
<p>G·ªìm c√≥ 2 tham s·ªë <code>x</code> v√† <code>kk</code>, c√≥ nhi·ªám v·ª• so s√°nh gi√° tr·ªã c·ªßa <code>Vx</code> v√† <code>kk</code>, n·∫øu ch√∫ng b·∫±ng nhau th√¨ b·ªè qua (skip) l·ªánh ti·∫øp theo b·∫±ng c√°ch tƒÉng gi√° tr·ªã c·ªßa <code>program counter</code> l√™n 2.</p>
<h3 id="4xkk-sne-vx-byte">4xkk - SNE Vx, byte</h3>
<p>T∆∞∆°ng t·ª± nh∆∞ l·ªánh tr√™n, n·∫øu gi√° tr·ªã c·ªßa <code>Vx</code> kh√°c <code>kk</code> th√¨ skip l·ªánh ti·∫øp theo (tƒÉng <code>program counter</code> l√™n 2)</p>
<h3 id="5yx0-se-vx-vy">5yx0 - SE Vx, Vy</h3>
<p>So s√°nh gi√° tr·ªã c·ªßa <code>Vx</code> v√† <code>Vy</code>, n·∫øu b·∫±ng nhau th√¨ skip l·ªánh ti·∫øp theo.</p>
<h3 id="6xkk-ld-vx-byte">6xkk - LD Vx, byte</h3>
<p>G√°n gi√° tr·ªã c·ªßa <code>Vx</code> th√†nh <code>kk</code></p>
<h3 id="7xkk-add-vx-byte">7xkk - ADD Vx, byte</h3>
<p>ƒê·∫∑t gi√° tr·ªã c·ªßa <code>Vx</code> b·∫±ng <code>Vx + kk</code></p>
<h3 id="8xy0-ld-vx-vy">8xy0 - LD Vx, Vy</h3>
<p>L∆∞u gi√° tr·ªã c·ªßa <code>Vy</code> v√†o <code>Vx</code></p>
<h3 id="8xy1-or-vx-vy">8xy1 - OR Vx, Vy</h3>
<p><code>Vx</code> = <code>Vx</code> OR <code>Vy</code></p>
<p>Th·ª±c hi·ªán ph√©p t√≠nh <code>OR</code> gi·ªØa 2 gi√° tr·ªã <code>Vx</code> v√† <code>Vy</code> r·ªìi l∆∞u k·∫øt qu·∫£ v√†o <code>Vx</code></p>
<h3 id="8xy2-and-vx-vy">8xy2 - AND Vx, Vy</h3>
<p><code>Vx</code> = <code>Vx</code> AND <code>Vy</code></p>
<p>Th·ª±c hi·ªán ph√©p t√≠nh <code>AND</code> gi·ªØa 2 gi√° tr·ªã <code>Vx</code> v√† <code>Vy</code> r·ªìi l∆∞u k·∫øt qu·∫£ v√†o <code>Vx</code></p>
<h3 id="8xy3-xor-vx-vy">8xy3 - XOR Vx, Vy</h3>
<p><code>Vx</code> = <code>Vx</code> XOR <code>Vy</code></p>
<p>Th·ª±c hi·ªán ph√©p t√≠nh <code>XOR</code> gi·ªØa <code>Vx</code> v√† <code>Vy</code> r·ªìi l∆∞u k·∫øt qu·∫£ v√†o <code>Vx</code></p>
<h3 id="8xy4-add-vx-vy">8xy4 - ADD Vx, Vy</h3>
<p>G√°n <code>Vx</code> = <code>Vx</code> + <code>Vy</code>, g√°n <code>VF</code> = <code>carry</code> (nh·ªõ)</p>
<p>Gi√° tr·ªã c·ªßa <code>Vx</code> v√† <code>Vy</code> ƒë∆∞·ª£c c·ªông l·∫°i v·ªõi nhau v√† l∆∞u v√†o <code>Vx</code>, n·∫øu k·∫øt qu·∫£ l·ªõn h∆°n <code>8 bit</code> (vd: &gt; 255) th√¨ <code>VF</code> s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t l√† <code>1</code>, ng∆∞·ª£c l·∫°i s·∫Ω l√† <code>0</code>.</p>
<h3 id="8xy5-sub-vx-vy">8xy5 - SUB Vx, Vy</h3>
<p>G√°n <code>Vx</code> = <code>Vx</code> - <code>Vy</code>, g√°n <code>VF</code> = <code>NOT borrow</code> (kh√¥ng m∆∞·ª£n)</p>
<p>N·∫øu <code>Vx</code> &gt; <code>Vy</code> hi·ªáu s·ªë c·ªßa <code>Vx - Vy</code> l√† kh√¥ng √¢m, n√™n <code>VF</code> s·∫Ω ƒë∆∞·ª£c g√°n b·∫±ng <code>1</code>, ng∆∞·ª£c l·∫°i th√¨ b·∫±ng <code>0</code>. K·∫øt qu·∫£ l∆∞u v√†o <code>Vx</code></p>
<h3 id="8xy6-shr-vx-vy-">8xy6 - SHR Vx {, Vy}</h3>
<p>G√°n <code>Vx</code> = <code>Vx SHR 1</code></p>
<p>N·∫øu bit th·∫•p nh·∫•t c·ªßa <code>Vx</code> l√† 1 th√¨ g√°n <code>VF</code> th√†h <code>1</code>, ng∆∞·ª£c l·∫°i th√¨ g√°n b·∫±ng <code>0</code>.
G√°n <code>Vx</code> = <code>Vx / 2</code></p>
<h3 id="8xy7-subn-vx-vy">8xy7 - SUBN Vx, Vy</h3>
<p>G√°n <code>Vx</code> = <code>Vy</code> - <code>Vx</code>, g√°n <code>VF</code> = <code>NOT borrow</code> (kh√¥ng m∆∞·ª£n)</p>
<p>N·∫øu <code>Vy</code> &gt; <code>Vx</code> th√¨ g√°n <code>VF</code> th√†nh <code>1</code>, ng∆∞·ª£c l·∫°i g√°n th√†nh <code>0</code>. Hi·ªáu s·ªë l∆∞u v√†o <code>Vx</code>.</p>
<h3 id="8xye-shl-vx-vy-">8xyE - SHL Vx {, Vy}</h3>
<p>G√°n <code>Vx</code> = <code>Vx SHL 1</code></p>
<p>N·∫øu bit cao nh·∫•t c·ªßa <code>Vx</code> l√† <code>1</code> th√¨ g√°n <code>VF</code> th√†nh <code>1</code>, ng∆∞·ª£c l·∫°i, g√°n th√†nh <code>0</code>. Cu·ªëi c√πng g√°n <code>Vx = Vx * 2</code></p>
<h3 id="9xy0-sne-vx-vy">9xy0 - SNE Vx, Vy</h3>
<p>Skip l·ªánh ti·∫øp theo n·∫øu <code>Vx</code> != <code>Vy</code></p>
<h3 id="annn-ld-i-addr">Annn - LD I, addr</h3>
<p>L∆∞u gi√° tr·ªã <code>nnn</code> v√†o thanh ghi <code>I</code></p>
<h3 id="bnnn-jp-v0-addr">Bnnn - JP V0, addr</h3>
<p>ƒê∆∞a <code>program counter</code> t·ªõi v·ªã tr√≠ <code>nnn + V0</code></p>
<h3 id="cxkk-rnd-vx-byte">Cxkk - RND Vx, byte</h3>
<p>G√°n gi√° tr·ªã <code>Vx</code> = <code>random byte</code> AND <code>kk</code></p>
<p>Interpreter s·∫Ω kh·ªüi t·∫°o m·ªôt s·ªë ng·∫´u nhi√™n (random) c√≥ gi√° tr·ªã t·ª´ <code>0</code> ƒë·∫øn <code>255</code>, sau ƒë√≥ <code>AND</code> v·ªõi gi√° tr·ªã c·ªßa <code>kk</code>. K·∫øt qu·∫£ l∆∞u v√†o <code>Vx</code></p>
<h2 id="c-c-l-nh-t-ng-t-c-display-keyboard-sound-">C√°c l·ªánh t∆∞∆°ng t√°c (display, keyboard, sound...)</h2>
<h3 id="dxyn-drw-vx-vy-nibble">Dxyn - DRW Vx, Vy, nibble</h3>
<p><strong>V·∫Ω ra m√†n h√¨nh - ƒê√¢y l√† l·ªánh quan tr·ªçng nh·∫•t trong s·ªë t·∫•t c·∫£ c√°c l·ªánh</strong></p>
<p>Interpreter s·∫Ω ƒë·ªçc <code>n</code> byte t·ª´ b·ªô nh·ªõ, b·∫Øt ƒë·∫ßu t·ª´ ƒë·ªãa ch·ªâ ƒë∆∞·ª£c l∆∞u trong thanh ghi <code>I</code>. C√°c byte n√†y s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã d∆∞·ªõi d·∫°ng m·ªôt <code>sprite</code> tr√™n m√†n h√¨nh t·ª´ to·∫° ƒë·ªô (<code>Vx</code>, <code>Vy</code>).</p>
<p>Sprite ƒë∆∞·ª£c v·∫Ω ra m√†n h√¨nh theo ph√©p <code>XOR</code>, n·∫øu c√≥ pixel n√†o b·ªã xo√° v√¨ ph√©p to√°n n√†y th√¨ <code>VF</code> s·∫Ω ƒë∆∞·ª£c g√°n l√† <code>1</code>, ng∆∞·ª£c l·∫°i th√¨ g√°n b·∫±ng <code>0</code>.</p>
<p>N·∫øu c√°c ƒëi·ªÉm c·ªßa sprite n·∫±m ·ªü b√™n ngo·∫°i ph·∫°m vi hi·ªÉn th·ªã c·ªßa m√†n h√¨nh th√¨ s·∫Ω ƒë∆∞·ª£c v·∫Ω ra ngay t·∫°i c√°c c·∫°nh bi√™n c·ªßa m√†n h√¨nh g·∫ßn v·ªõi n√≥ nh·∫•t.</p>
<h3 id="ex9e-skp-vx">Ex9E - SKP Vx</h3>
<p>Skip l·ªánh ti·∫øp theo n·∫øu ph√≠m c√≥ gi√° tr·ªã c·ªßa <code>Vx</code> ƒë∆∞·ª£c nh·∫•n.</p>
<p>Ki·ªÉm tra b√†n ph√≠m, n·∫øu ph√≠m ƒë∆∞·ª£c nh·∫•n c√≥ gi√° tr·ªã (key code) b·∫±ng v∆°i gi√° tr·ªã c·ªßa <code>Vx</code> th√¨ <code>program counter</code> s·∫Ω ƒë∆∞·ª£c tƒÉng l√™n <code>2</code>.</p>
<h3 id="exa1-sknp-vx">ExA1 - SKNP Vx</h3>
<p>Skip l·ªánh ti·∫øp theo n·∫øu ph√≠m c√≥ gi√° tr·ªã c·ªßa <code>Vx</code> kh√¥ng ƒë∆∞·ª£c nh·∫•n.</p>
<p>T∆∞∆°ng t·ª± nh∆∞ l·ªánh tr√™n, nh∆∞ng l·ªánh n√†y tƒÉng <code>PC</code> l√™n <code>2</code> n·∫øu ph√≠m c√≥ key code l√† <code>Vx</code> kh√¥ng ƒë∆∞·ª£c nh·∫•n xu·ªëng.</p>
<h3 id="fx0a-ld-vx-k">Fx0A - LD Vx, K</h3>
<p>Ch·ªù b·∫Øt s·ª± ki·ªán nh·∫•n ph√≠m, l∆∞u <code>key code</code> v√†o <code>Vx</code></p>
<p>L·ªánh n√†y s·∫Ω ng·ª´ng ch∆∞∆°ng tr√¨nh cho t·ªõi khi c√≥ ph√≠m ƒë∆∞·ª£c nh·∫•n.</p>
<h3 id="fx07-ld-vx-dt">Fx07 - LD Vx, DT</h3>
<p>G√°n <code>Vx</code> = <code>delay timer value</code></p>
<p>L∆∞u gi√° tr·ªã c·ªßa thanh ghi <code>DT</code> v√†o thanh ghi <code>Vx</code></p>
<h3 id="fx15-ld-dt-vx">Fx15 - LD DT, Vx</h3>
<p>G√°n <code>delay timer</code> = <code>Vx</code></p>
<p>G√°n gi√° tr·ªã c·ªßa thanh ghi <code>DT</code> l√† <code>Vx</code> ƒë·ªÉ b·∫Øt ƒë·∫ßu th·ª±c hi·ªán vi·ªác ch·ªù (delay), xem gi·∫£i th√≠ch v·ªÅ <code>Delay Timer</code> ·ªü b√†i tr∆∞·ªõc.</p>
<h3 id="fx18-ld-st-vx">Fx18 - LD ST, Vx</h3>
<p>G√°n <code>sound timer</code> = <code>Vx</code></p>
<p>G√°n gi√° tr·ªã c·ªßa thanh ghi <code>ST</code> th√†nh <code>Vx</code> ƒë·ªÉ b·∫Øt ƒë·∫ßu th·ª±c hi·ªán ph√°t √¢m thanh, xem gi·∫£i th√≠ch v·ªÅ <code>Sound Timer</code> ·ªü b√†i tr∆∞·ªõc.</p>
<h3 id="fx1e-add-i-vx">Fx1E - ADD I, Vx</h3>
<p>G√°n <code>I</code> = <code>I</code> + <code>Vx</code></p>
<p>L∆∞u t·ªïng s·ªë c·ªßa <code>I</code> v√† <code>Vx</code> v√†o <code>Vx</code></p>
<h3 id="fx29-ld-f-vx">Fx29 - LD F, Vx</h3>
<p>G√°n <code>I</code> = <code>v·ªã tr√≠ c·ªßa sprite k√≠ t·ª± Vx</code></p>
<p>G√°n gi√° tr·ªã c·ªßa thanh ghi <code>I</code> th√†nh v·ªã tr√≠ c·ªßa k√≠ t·ª± hex font d·ª±ng s·∫µn t∆∞∆°ng ·ª©ng v·ªõi <code>Vx</code>.</p>
<h3 id="fx33-ld-b-vx">Fx33 - LD B, Vx</h3>
<p>Interpreter l·∫•y gi√° tr·ªã th·∫≠p ph√¢n c·ªßa <code>Vx</code>, l∆∞u c√°c s·ªë h√†ng trƒÉm v√†o b·ªô nh·ªõ ·ªü v·ªã tr√≠ <code>I</code>, c√°c s·ªë h√†ng ch·ª•c v√†o v·ªã tr√≠ <code>I + 1</code>, c√°c s·ªë h√†ng ƒë∆°n v·ªã ·ªü v·ªã tr√≠ <code>I + 2</code></p>
<h3 id="fx55-ld-i-vx">Fx55 - LD [I], Vx</h3>
<p>L∆∞u gi√° tr·ªã t·ª´ thanh ghi <code>V0</code> v√†o c√°c thanh ghi <code>Vx</code> trong b·ªô nh·ªõ, b·∫Øt ƒë·∫ßu t·ª´ ƒë·ªãa ch·ªâ trong <code>I</code>. Sang ph·∫ßn sau s·∫Ω r√µ h∆°n trong qu√° tr√¨nh implement.</p>
<h3 id="fx65-ld-vx-i-">Fx65 - LD Vx, [I]</h3>
<p>ƒê·ªçc gi√° tr·ªã t·ª´ c√°c thanh ghi <code>Vx</code>, b·∫Øt ƒë·∫ßu t·ª´ <code>I</code> v√†o <code>V0</code></p>
<hr>
<p>Tr√™n ƒë√¢y l√† to√†n b·ªô c√°c opcode m√† ch√∫ng ta s·∫Ω implement ·ªü ph·∫ßn sau. Sau khi implement t·∫•t c·∫£ c√°c opcode n√†y th√¨ ch√∫ng ta c√≥ th·ªÉ load m·ªôt ROM game m·∫´u v√† ch∆°i th·ª≠.</p>
<p>C√≥ m·ªôt s·ªë l·ªánh c·ªßa Super CHIP-8 nh∆∞ng ƒë·ªÉ b√†i vi·∫øt ƒë∆°n gi·∫£n, m√¨nh s·∫Ω kh√¥ng ƒë·ªÅ c·∫≠p ƒë·∫øn. Sau n√†y n·∫øu c√≥ th·ªùi gian th√¨ ch√∫ng ta s·∫Ω implement th√™m sau.</p>
<h1 id="ph-n-3-implement">Ph·∫ßn 3: Implement</h1>
<hr>
<p>Chi ti·∫øt v·ªÅ c√°ch implement c√°c b·∫°n c√≥ th·ªÉ tham kh·∫£o m√£ ngu·ªìn t·∫°i: <a href="https://github.com/huytd/js-chip8-emulator">https://github.com/huytd/js-chip8-emulator</a></p>

                <div class="copyright">
                B·∫°n ƒë∆∞·ª£c t√πy √Ω b·∫•m like, tr√≠ch d·∫´n ho·∫∑c copy, post l·∫°i, nh∆∞ng vui l√≤ng ghi r√µ ngu·ªìn v√† t√°c gi·∫£ v√† kh√¥ng l√†m thay ƒë·ªïi n·ªôi dung b√†i vi·∫øt. N·∫øu kh√¥ng l√†m v·∫≠y, m√¨nh hy v·ªçng t·ª´ nay v·ªÅ sau b·∫°n s·∫Ω lu√¥n c·∫£m th·∫•y c·∫Øn r·ª©t l∆∞∆°ng t√¢m, ƒÉn kh√¥ng ngon, ng·ªß kh√¥ng y√™n. üòÜ
                </div>
                <div class="fb-like" data-href="http://huytd.github.io/posts/tu-viet-emulator.html" data-layout="standard" data-action="like" data-show-faces="true" data-share="true"></div>
                <div id="disqus_thread"></div>
                <script>
                /**
                * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
                * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
                */
                /*
                var disqus_config = function () {
                this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
                this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                };
                */
                (function() { // DON'T EDIT BELOW THIS LINE
                var d = document, s = d.createElement('script');

                s.src = '//huysblog.disqus.com/embed.js';

                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
                })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
            </div>
        </div>
	    <div class="footer">
            <p>Created with <a href="http://github.com/huytd/azeroth-js">azeroth.js</a></p>
            <div class="social">
                <a target="_blank" href="http://facebook.com/kingbazoka"><i class="icon-facebook-squared"></i></a>
                <a target="_blank" href="http://twitter.com/huydotnet"><i class="icon-twitter-squared"></i></a>
                <a target="_blank" href="http://github.com/huytd"><i class="icon-github-squared"></i></a>
                <a target="_blank" href="https://thefullsnack.com"><i class="icon-emo-coffee"></i></a>
            </div>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-71353335-1', 'auto');
          ga('send', 'pageview');
        </script>
        <script>
          window.fbAsyncInit = function() {
            FB.init({
              appId      : '462066520669072',
              xfbml      : true,
              version    : 'v2.6'
            });

            FB.Event.subscribe('edge.create', function(url) {
              ga('send', 'social', 'facebook', 'like', url);
            });
          };

          (function(d, s, id){
             var js, fjs = d.getElementsByTagName(s)[0];
             if (d.getElementById(id)) {return;}
             js = d.createElement(s); js.id = id;
             js.src = "//connect.facebook.net/en_US/sdk.js";
             fjs.parentNode.insertBefore(js, fjs);
           }(document, 'script', 'facebook-jssdk'));
        </script>
        <script id="dsq-count-scr" src="//huysblog.disqus.com/count.js" async></script>
        <script type="text/javascript" async src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>
        <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [['$','$'], ['\\(','\\)']],
            skipTags: ["script","noscript","style","textarea"]
          }
        });
        </script>
    </body>
</html>
