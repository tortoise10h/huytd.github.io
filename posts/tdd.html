<html>
    <head>
        <title> TDD qua v√≠ d·ª• th·ª±c t·∫ø | Huy's Blog</title>
        <meta charset="utf-8">
        <meta http-equiv="content-type" content="text/html;"><meta name=viewport content="initial-scale=1.0 maximum-scale=1.0">
        
        <link href="../css/inconsolata.css" rel="stylesheet" type="text/css">
        <link href="../css/theme.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="../css/highlight/tomorrow.css">
        <link rel="stylesheet" href="../css/fontello.css">
        <script src="../js/highlight.pack.js"></script>
        <script src="../js/autosizing.js"></script>
        <script>
        hljs.initHighlightingOnLoad();
        </script>
    </head>
    <body>
        <div class="header">
            <a href="/"><i class="icon icon-emo-coffee"></i> Huy's Blog</a>
        </div>
        <div class="container">
            <div class="main">
                <h1 id="tdd-qua-v-d-th-c-t-">TDD qua v√≠ d·ª• th·ª±c t·∫ø</h1>
<p>TDD (Test Driven Development) - t·ª©c l√† m·ªôt ph∆∞∆°ng ph√°p l·∫≠p tr√¨nh ch√∫ tr·ªçng v√†o vi·ªác test, &quot;vi·∫øt test tr∆∞·ªõc vi·∫øt code sau&quot;,... r·∫•t nhi·ªÅu ng∆∞·ªùi ƒë√£ th·ª≠ t√¨m hi·ªÉu v·ªÅ TDD v√† ƒë·ªÅu ƒë·ªçc ƒë∆∞·ª£c nh·ªØng ƒë·ªãnh nghƒ©a nh∆∞ th·∫ø n√†y trong c√°c b√†i vi·∫øt, nh∆∞ng cu·ªëi c√πng khi ƒë·ªçc xong th√¨ v·∫´n kh√¥ng hi·ªÉu n·ªïi TDD l√† g√¨.</p>
<p>M·ªôt trong nh·ªØng c√¢u h·ªèi ƒë∆∞·ª£c ƒë·∫∑t ra nhi·ªÅu nh·∫•t khi nghi√™n c·ª©u v·ªÅ TDD c√≥ l·∫Ω l√†: <strong>√Åp d·ª•ng TDD nh∆∞ th·∫ø n√†o trong th·ª±c t·∫ø?</strong> </p>
<p><img src="http://www.seleniumframework.com/wp-content/uploads/2014/10/TestDrivenDevelopment_155FE5992.png" alt=""></p>
<p>V√† h√¨nh nh∆∞ c≈©ng kh√¥ng c√≥ nhi·ªÅu b√†i vi·∫øt gi·∫£i ƒë√°p ƒë∆∞·ª£c c√¢u h·ªèi n√†y. K·∫øt qu·∫£ l√† r·∫•t nhi·ªÅu ng∆∞·ªùi kh√¥ng hi·ªÉu ƒë∆∞·ª£c n√≥ n√™n kh√¥ng √°p d·ª•ng ƒë∆∞·ª£c ho·∫∑c √°p d·ª•ng sai c√°ch, t·ª´ ƒë√≥ t·∫°o ra nh·ªØng hi·ªÉu l·∫ßm hay &quot;·∫£o t∆∞·ªüng s·ª©c m·∫°nh&quot; v·ªÅ n√≥, r·∫•t l√† tai h·∫°i.</p>
<p>V·∫≠y th·∫ø n√†o l√† TDD? V√† th·∫ø n√†o m·ªõi l√† hi·ªÉu ƒë√∫ng v·ªÅ TDD? M√¨nh xin kh√¥ng tr·∫£ l·ªùi tr·ª±c ti·∫øp, m√† s·∫Ω tr√¨nh b√†y m·ªôt v√≠ d·ª• minh h·ªça √°p d·ª•ng TDD ƒë·ªÉ qua ƒë√≥ c√°c b·∫°n c√≥ th·ªÉ t·ª± r√∫t ra ƒë∆∞·ª£c c√¢u tr·∫£ l·ªùi c≈©ng nh∆∞ quy·∫øt ƒë·ªãnh xem c√≥ n√™n √°p d·ª•ng n√≥ hay kh√¥ng :D C√≤n b√¢y gi·ªù th√¨ ch√∫ng ta b·∫Øt ƒë·∫ßu th√¥i.</p>
<h2 id="b-i-to-n-fizzbuzz">B√†i to√°n FizzBuzz</h2>
<p>ƒê·ªÉ minh h·ªça vi·ªác √°p d·ª•ng TDD trong th·ª±c t·∫ø, m√¨nh s·∫Ω √°p d·ª•ng n√≥ v√†o vi·ªác x√¢y d·ª±ng m·ªôt ch∆∞∆°ng tr√¨nh ƒë∆°n gi·∫£n c√≥ t√™n l√† <strong>FizzBuzz</strong>.</p>
<p>N·∫øu c√°c b·∫°n ch∆∞a bi·∫øt, th√¨ FizzBuzz l√† m·ªôt h√†m nh·∫≠n v√†o m·ªôt s·ªë <strong>N</strong> v√† tr·∫£ v·ªÅ c√°c gi√° tr·ªã kh√°c nhau t√πy theo t·ª´ng ƒëi·ªÅu ki·ªán:</p>
<ul>
<li>Tr·∫£ v·ªÅ chu·ªói <strong>&quot;Fizz&quot;</strong> n·∫øu s·ªë <strong>N</strong> chia h·∫øt cho <strong>3</strong> (v√≠ d·ª• 3, 6, 9,...)</li>
<li>Tr·∫£ v·ªÅ chu·ªói <strong>&quot;Buzz&quot;</strong> n·∫øu s·ªë <strong>N</strong> chia h·∫øt cho <strong>5</strong> (v√≠ d·ª• 5, 10,...)</li>
<li>Tr·∫£ v·ªÅ chu·ªói <strong>&quot;FizzBuzz&quot;</strong> n·∫øu s·ªë <strong>N</strong> chia h·∫øt cho c·∫£ <strong>3</strong> v√† <strong>5</strong> (v√≠ d·ª• 15, 45,...)</li>
<li>Tr·∫£ v·ªÅ ch√≠nh con s·ªë ƒë√≥ n·∫øu n√≥ kh√¥ng th·ªèa m√£n c√°c ƒëi·ªÅu ki·ªán tr√™n</li>
</ul>
<p>S·ª° dƒ© m√¨nh ch·ªçn b√†i to√°n n√†y ƒë·ªÉ minh h·ªça cho TDD l√† v√¨ n√≥ c·ª±c k√¨ ƒë∆°n gi·∫£n m√† l·∫°i c√≥ nhi·ªÅu case t√πy thu·ªôc v√†o t·ª´ng input, kh√¥ng qu√° kh√≥ ƒë·ªÉ hi·ªÉu v√† cover ƒë∆∞·ª£c to√†n b·ªô c√°c case trong ph·∫°m vi 1 b√†i vi·∫øt ng·∫Øn nh∆∞ th·∫ø n√†y.</p>
<h2 id="implement-b-i-to-n-fizzbuzz-p-d-ng-tdd">Implement b√†i to√°n FizzBuzz √°p d·ª•ng TDD</h2>
<p>R·ªìi, gi·ªù th√¨ ch√∫ng ta ƒë√£ hi·ªÉu ƒë·ªÅ b√†i, v·∫≠y th√¨ b·∫Øt tay v√†o code th√¥i. Trong b√†i n√†y m√¨nh s·∫Ω s·ª≠ d·ª•ng <strong>Ruby</strong> v√† <strong>Minitest</strong> ƒë·ªÉ implement v√† test. N·∫øu l·∫ßn ƒë·∫ßu ti√™n nghe n√≥i ƒë·∫øn 2 c√°i n√†y th√¨ c√°c b·∫°n ch·ªãu kh√≥ t√¨m ƒë·ªçc qua m·ªôt ch√∫t tr∆∞·ªõc khi ch√∫ng ta ti·∫øp t·ª•c. Nh·∫•t l√† Minitest, c√≤n Ruby th√¨ code c·ªßa n√≥ c≈©ng kh√¥ng ƒë·∫øn n·ªói qu√° ph·ª©c t·∫°p n√™n d√π b·∫°n code Java hay JavaScript th√¨ ƒë·ªçc v√†o ch·∫Øc c≈©ng s·∫Ω hi·ªÉu :trollface:</p>
<h3 id="chu-n-b-h-nh-l-">Chu·∫©n b·ªã h√†nh l√Ω</h3>
<p>R√µ r√†ng khi b·∫Øt ƒë·∫ßu code th√¨ ph·∫£i setup nh·ªØng th·ª© nh∆∞ l√† c·∫•u tr√∫c th∆∞ m·ª•c blah blah. Nh∆∞ng ph·∫ßn n√†y kh√¥ng li√™n quan ƒë·∫øn TDD, n√™n m√¨nh s·∫Ω n√≥i l∆∞·ªõt qua. N·∫øu c√°c b·∫°n kh√¥ng hi·ªÉu th√¨ c√≥ th·ªÉ h·ªèi trong ph·∫ßn comment nh√©. </p>
<p>T·∫°o m·ªôt th∆∞ m·ª•c d√†nh cho project c·ªßa ch√∫ng ta, c√≥ th·ªÉ ƒë·∫∑t t√™n t√πy √Ω, trong ƒë√≥ t·∫°o 3 file l·∫ßn l∆∞·ª£t nh∆∞ sau: <strong>Rakefile</strong>, <strong>FizzBuzz.rb</strong> v√† <strong>FizzBuzz_test.rb</strong></p>
<p><strong>Rakefile</strong> c√≥ nhi·ªám v·ª• ƒë·ªãnh nghƒ©a task ch·∫°y test, c√≥ n·ªôi dung nh∆∞ sau:</p>
<pre><code>require &quot;rake/testtask&quot;

Rake::TestTak.new(:test) do |t|
  t.libs &lt;&lt; &quot;test&quot;
  t.test_files = FileList[&quot;*_test.rb&quot;]
  t.verbose = true
end

task :default =&gt; :test
</code></pre><p>Ch√∫ng ta s·∫Ω implement module <strong>FizzBuzz</strong>, trong module n√†y c√≥ 1 h√†m <strong>run()</strong> nh·∫≠n v√†o tham s·ªë N v√† tr·∫£ v·ªÅ c√°c gi√° tr·ªã nh∆∞ ƒë√£ n√≥i ·ªü ph·∫ßn kh√°i ni·ªám. ƒê√¢y l√† ph·∫ßn s∆∞·ªùn code cho module <strong>FizzBuzz</strong>, n·∫±m trong file <strong>FizzBuzz.rb</strong> </p>
<pre><code>module FizzBuzz
  extend self

  def run(n)

  end
end
</code></pre><p>Ph·∫ßn code test s·∫Ω ƒë·∫∑t trong file <strong>FizzBuzz_test.rb</strong> v√† c√≥ n·ªôi dung nh∆∞ sau:</p>
<pre><code>require &quot;minitest/autorun&quot;
require &quot;./FizzBuzz&quot;

class FizzBuzzTest &lt; Minitest::Test

end
</code></pre><p>Sau khi t·∫°o xong 3 file tr√™n, c√°c b·∫°n c√≥ th·ªÉ ch·∫°y th·ª≠ test b·∫±ng l·ªánh:</p>
<pre><code>rake test

# ho·∫∑c l√†

rake
</code></pre><p>Output s·∫Ω nh∆∞ th·∫ø n√†y:</p>
<pre><code># Running:



Finished in 0.001125s, 0.0000 runs/s, 0.0000 assertions/s.

0 runs, 0 assertions, 0 failures, 0 errors, 0 skips
</code></pre><p>Output nh∆∞ tr√™n nghƒ©a l√† b·∫°n ƒë√£ c√†i ƒë·∫∑t th√†nh c√¥ng ch∆∞∆°ng tr√¨nh, nh∆∞ng ch∆∞a c√≥ test case n√†o ƒë∆∞·ª£c ch·∫°y.</p>
<p>Gi·ªù ch√∫ng ta s·∫Ω b·∫Øt tay v√†o ph·∫ßn ch√≠nh, test v√† code.</p>
<h3 id="ch-ch-t-">Ch·ªù ch√∫t!</h3>
<p>√Ä, m√† tr∆∞·ªõc khi b·∫Øt ƒë·∫ßu th√¨ c≈©ng n√™n nh·∫Øc l·∫°i m·ªôt t√≠ v·ªÅ TDD. TDD t·ª©c l√† &quot;vi·∫øt test tr∆∞·ªõc khi vi·∫øt code&quot;. Nghƒ©a l√† sao? Ch∆∞a c√≥ code th√¨ l√†m sao m√† test? </p>
<p>ƒê√¢y ch√≠nh l√† m·∫•u ch·ªët, khi b·∫°n ƒë·ªãnh implement m·ªôt function n√†o ƒë√≥, b·∫°n s·∫Ω ph·∫£i vi·∫øt m·ªôt function kh√°c, s·ª≠ d·ª•ng ch√≠nh c√°i function b·∫°n ƒë·ªãnh implement, v√† khi ch·∫°y test t·∫•t nhi√™n n√≥ s·∫Ω fail, ƒë∆°n gi·∫£n l√† v√¨ b·∫°n ch∆∞a implement c√°i g√¨ c·∫£. V√¨ v·∫≠y vi·ªác ti·∫øp theo l√† implement ƒë·ªÉ l√†m cho n√≥ h·∫øt fail (pass). Cu·ªëi c√πng, b·ªè ch√∫t th·ªùi gian ra refactor l·∫°i code cho ƒë·∫πp v√† g·ªçn g√†ng h∆°n, ƒë·ªÉ l·ª° c√≥ b·ªã ai ƒë·ªçc v√†o th√¨ h·ªç c≈©ng kh√¥i c√≥ ch·ª≠i ƒë∆∞·ª£c m√¨nh =))))</p>
<p><img src="http://luizricardo.org/wordpress/wp-content/upload-files/2014/05/tdd_flow.gif" alt=""></p>
<p>V√† b·∫±ng c√°ch suy nghƒ© tr∆∞·ªõc m·ªçi t√¨nh hu·ªëng c√≥ th·ªÉ x·∫£y ra khi s·ª≠ d·ª•ng c√°i function b·∫°n s·∫Øp vi·∫øt, sau khi to√†n b·ªô test ƒë√£ pass th√¨ b·∫°n c√≥ m·ªôt function ho√†n h·∫£o v√† kh√¥ng c√≤n kh·∫£ nƒÉng x·∫£y ra bug n·ªØa. </p>
<p>Quay tr·ªü l·∫°i b√†i to√°n, ch√∫ng ta s·∫Ω c√≥ bao nhi√™u t√¨nh hu·ªëng c·∫ßn nghƒ© ra ƒë·ªÉ test? B·∫°n th·ª≠ t·ª± tr·∫£ l·ªùi tr∆∞·ªõc khi ƒë·ªçc ti·∫øp xem?</p>
<p>C√¢u tr·∫£ l·ªùi l√† <strong>4</strong>. C≈©ng ch√≠nh l√† 4 g·∫°ch ƒë·∫ßu d√≤ng m√¥ t·∫£ h√†m <strong>FizzBuzz</strong> ƒë√£ ghi ·ªü tr√™n. T·∫•t nhi√™n n·∫øu m√°u th√¨ b·∫°n c√≥ th·ªÉ vi·∫øt nhi·ªÅu test case h∆°n cho n√≥ c≈©ng ƒë∆∞·ª£c, nh∆∞ng n·∫øu b·∫°n vi·∫øt qu√° nhi·ªÅu test case th√¨ r·∫•t c√≥ th·ªÉ b·∫°n ƒëang vi·∫øt th·ª´a r·ªìi (t·ª©c l√† s·∫Ω c√≥ c√°c test case test c√πng m·ªôt v·∫•n ƒë·ªÅ).</p>
<p>C√°c b·∫°n th·∫•y sao? Tui n√≥i nhi·ªÅu qu√° h·∫£? √Ä kh√¥ng, TDD l·ª£i h·∫°i qu√° h·∫£? Th√¥i b·∫Øt ƒë·∫ßu nh√©, gi·ªù ch√∫ng ta test c√°i case ƒë·∫ßu ti√™n nh√©.</p>
<h3 id="test-case-1-nh-n-v-o-m-t-s-chia-h-t-cho-3-tr-v-chu-i-fizz">Test case #1: Nh·∫≠n v√†o m·ªôt s·ªë chia h·∫øt cho 3, tr·∫£ v·ªÅ chu·ªói Fizz</h3>
<p>Xem n√†o, nh∆∞ ƒë√£ n√≥i ·ªü ph·∫ßn tr√™n kia th√¨ ch√∫ng ta s·∫Ω g·ªçi h√†m <code>FizzBuzz.run(...)</code>, v·ªõi tham s·ªë <strong>n</strong> truy·ªÅn v√†o cho h√†m <code>run</code> l√† m·ªôt con s·ªë chia h·∫øt cho 3, v√≠ d·ª• nh∆∞ l√† s·ªë 6, ho·∫∑c 9. V√† k·∫øt qu·∫£ thu ƒë∆∞·ª£c s·∫Ω l√† m·ªôt chu·ªói <strong>&quot;Fizz&quot;</strong>.</p>
<h4 id="vi-t-test-tr-c-">Vi·∫øt test tr∆∞·ªõc...</h4>
<p>V·∫≠y th√¨ test case ƒë·∫ßu ti√™n c·ªßa ch√∫ng ta s·∫Ω nh∆∞ th·∫ø n√†y:</p>
<p><strong>FizzBuzz_test.rb</strong> </p>
<pre><code>def test_fizzbuzz_run_return_fizz
  expect = &quot;Fizz&quot;
  actual = FizzBuzz.run(6)
  assert_equal expect, actual
end
</code></pre><p>ƒê·∫∑t t√™n h√†m c√≥ d·∫°ng <code>test_xxx</code> l√† do Minitest quy ƒë·ªãnh, v√† ƒë·ªÉ cho r√µ r√†ng th√¨ ph·∫ßn <code>xxx</code> trong t√™n h√†m test ch√∫ng ta n√™n di·ªÖn ƒë·∫°t n·ªôi dung ho·∫∑c m·ª•c ƒë√≠ch c·ªßa test case n√†y, ·ªü ƒë√¢y l√†: <em>FizzBuzz Run Return Fizz</em>, c√≥ nghƒ©a l√†: <em>H√†m <code>run</code> c·ªßa module <code>FizzBuzz</code> s·∫Ω tr·∫£ v·ªÅ n·ªôi dung Fizz</em>.</p>
<p>Vi·ªác khai b√°o 2 bi·∫øn <code>expect</code> v√† <code>actual</code> l√† ƒë·ªÉ cho ph·∫ßn code test n√†y d·ªÖ ƒë·ªçc h∆°n th√¥i, trong th·ª±c t·∫ø c√°c b·∫°n c√≥ th·ªÉ b·ªè n·∫øu kh√¥ng th√≠ch. Tuy nhi√™n ti√™u ch√≠ l√†: Code test th√¨ ph·∫£i lu√¥n lu√¥n r√µ r√†ng.</p>
<p>L·ªánh <code>assert_equal</code> c≈©ng l√† c·ªßa Minitest, c√≥ nhi·ªám v·ª• ki·ªÉm tra xem gi√° tr·ªã c·ªßa 2 tham s·ªë <code>expect</code> v√† <code>actual</code> c√≥ b·∫±ng nhau kh√¥ng. Ngo√†i ra c√≤n c√≥ nhi·ªÅu ph√©p assertion kh√°c, c√°c b·∫°n c√≥ th·ªÉ ƒë·ªçc th√™m <a href="http://docs.seattlerb.org/minitest/Minitest/Assertions.html">t·∫°i ƒë√¢y</a></p>
<p>Gi·ªù ch·∫°y test th·ª≠ nh√©, b·∫£o ƒë·∫£m n√≥ b·∫Øn l·ªói ngay:</p>
<pre><code># Running:

F

Finished in 0.001543s, 2592.3526 runs/s, 2592.3526 assertions/s.

  1) Failure:
FizzBuzzTest#test_fizzbuzz_run_return_fizz [...]:
Expected: &quot;Fizz&quot;
  Actual: nil

1 runs, 1 assertions, 1 failures, 0 errors, 0 skips
rake aborted!
</code></pre><p>N·ªôi dung th√¥ng b√°o tr√™n c√≥ nghƒ©a l√†, k·∫øt qu·∫£ mong ƒë·ª£i l√† <strong>&quot;Fizz&quot;</strong> nh∆∞ng k·∫øt qu·∫£ th·ª±c t·∫ø l·∫°i l√† <strong>nil</strong> (null, v√¨ ch∆∞a implement l·∫•y ƒë√¢u ra c√≥ k·∫øt qu·∫£).</p>
<h4 id="-vi-t-code-sau">...Vi·∫øt code sau</h4>
<p>Test c≈©ng vi·∫øt r·ªìi, fail c≈©ng fail lu√¥n r·ªìi, gi·ªù l√† l√∫c l√†m cho c√°i test kia xanh tr·ªü l·∫°i (pass), b·∫±ng c√°ch implement tr∆∞·ªùng h·ª£p ƒë·∫ßu ti√™n cho h√†m <code>run</code> nh∆∞ ƒëo·∫°n code d∆∞·ªõi ƒë√¢y:</p>
<p><strong>FizzBuzz.rb</strong></p>
<pre><code>def run(n)
  if n % 3 == 0
    return &quot;Fizz&quot; 
  end
end
</code></pre><p>Qu√° ƒë∆°n gi·∫£n! Gi·ªù ch·∫°y test l·∫°i th·ª≠ xem nh√©:</p>
<pre><code># Running:

.

Finished in 0.001766s, 566.2514 runs/s, 566.2514 assertions/s.

1 runs, 1 assertions, 0 failures, 0 errors, 0 skips
</code></pre><p>Ngon! Ghi v·∫≠y t·ª©c l√† pass r·ªìi ƒë√≥. Gi·ªù ƒë·∫øn ph·∫ßn refactor, c∆° m√† v√¨ c√°i h√†m n√†y c≈©ng ƒë∆°n gi·∫£n qu√° n√™n th√¥i m√¨nh b·ªè qua b∆∞·ªõc n√†y v·∫≠y.</p>
<p>Gi·ªù qua test case th·ª© 2 nh√©.</p>
<h3 id="test-case-2-nh-n-v-o-m-t-s-chia-h-t-cho-5-tr-v-chu-i-buzz">Test case #2: Nh·∫≠n v√†o m·ªôt s·ªë chia h·∫øt cho 5, tr·∫£ v·ªÅ chu·ªói Buzz</h3>
<p>Tr∆∞·ªùng h·ª£p th·ª© 2 l√† h√†m <code>run()</code> nh·∫≠n v√†o m·ªôt s·ªë <strong>n</strong> chia h·∫øt cho 5 (nh∆∞ng nh·ªõ l√† kh√¥ng chia h·∫øt cho 3 nh√©), v√≠ d·ª• 5, 10, 20,... v√† n√≥ s·∫Ω ph·∫£i tr·∫£ v·ªÅ k·∫øt qu·∫£ l√† chu·ªói <strong>&quot;Buzz&quot;</strong>. </p>
<h4 id="vi-t-test-tr-c-">Vi·∫øt test tr∆∞·ªõc...</h4>
<p>V·∫≠y th√¨ h√†m test th·ª© 2 s·∫Ω nh∆∞ sau:</p>
<p><strong>FizzBuzz_test.rb</strong></p>
<pre><code>def test_fizzbuzz_run_return_buzz
  expect = &quot;Buzz&quot;
  actual = FizzBuzz.run(10)
  assert_equal expect, actual
end
</code></pre><p>Ch·∫°y th·ª≠ lu√¥n cho n√≥ fail:</p>
<pre><code># Running:

F.

Finished in 0.001374s, 1455.6041 runs/s, 1455.6041 assertions/s.

  1) Failure:
FizzBuzzTest#test_fizzbuzz_run_return_buzz [/Users/huy/Desktop/Code/rbfizzbuzz/FizzBuzz_test.rb:14]:
Expected: &quot;Buzz&quot;
  Actual: nil

2 runs, 2 assertions, 1 failures, 0 errors, 0 skips
rake aborted!
</code></pre><p>Output nh∆∞ tr√™n c√≥ nghƒ©a l√† ch·∫°y 2 test case m√† c√≥ 1 c√°i fail. K·∫øt qu·∫£ mong ƒë·ª£i c·ªßa c√°i test fail l√† <strong>&quot;Buzz&quot;</strong> c√≤n output th√¨ l·∫°i l√† <strong>nil</strong>. V√¨ ch√∫ng ta ch∆∞a implement tr∆∞·ªùng h·ª£p s·ªë chia h·∫øt cho 5 m√† ko chia h·∫øt cho 3, n√™n n√≥ ko c√≥ return c√°i g√¨ v·ªÅ c·∫£.</p>
<h4 id="-vi-t-code-sau">...Vi·∫øt code sau</h4>
<p>Ch√∫ng ta implement tr∆∞·ªùng h·ª£p n√†y nh∆∞ sau:</p>
<p><strong>FizzBuzz.rb</strong></p>
<pre><code>def run(n)
  if n % 3 == 0
    return &quot;Fizz&quot;
  elsif n % 5 == 0
    return &quot;Buzz&quot;
  end
end
</code></pre><p>Gi·ªù th√¨ ch·∫°y th·ª≠ coi n√≥ pass ch∆∞a n√†o:</p>
<pre><code># Running:

..

Finished in 0.001176s, 1700.6803 runs/s, 1700.6803 assertions/s.

2 runs, 2 assertions, 0 failures, 0 errors, 0 skips
</code></pre><p>Ngon l√†nh! ƒêi ti·∫øp n√†o.</p>
<h3 id="test-case-3-nh-n-v-o-m-t-s-c-ng-chia-h-t-cho-3-v-5-tr-v-chu-i-fizzbuzz">Test case #3: Nh·∫≠n v√†o m·ªôt s·ªë c√πng chia h·∫øt cho 3 v√† 5, tr·∫£ v·ªÅ chu·ªói FizzBuzz</h3>
<p>Tr∆∞·ªùng h·ª£p th·ª© 3 l√† ch·∫°y h√†m <code>run()</code> v·ªõi input l√† m·ªôt s·ªë <strong>n</strong> c√πng chia h·∫øt cho <strong>3</strong> v√† <strong>5</strong>, v√≠ d·ª• nh∆∞ l√† 15, 30, 45,...</p>
<h4 id="vi-t-test-tr-c-">Vi·∫øt test tr∆∞·ªõc...</h4>
<p>V·∫´n nh∆∞ c√°c b∆∞·ªõc tr√™n, c√≥ v·∫ª h∆°i ch√°n r·ªìi nh·ªâ :laughing: </p>
<p><strong>FizzBuzz_test.rb</strong></p>
<pre><code>def test_fizzbuzz_run_return_fizzbuzz
  expect = &quot;FizzBuzz&quot;
  actual = FizzBuzz.run(15)
  assert_equal expect, actual
end
</code></pre><p>Ch·∫°y cho n√≥ fail n√†o... :sleeping: </p>
<pre><code># Running:

.F.

Finished in 0.001382s, 2170.7670 runs/s, 2170.7670 assertions/s.

  1) Failure:
FizzBuzzTest#test_fizzbuzz_run_return_fizzbuzz [...]:
Expected: &quot;FizzBuzz&quot;
  Actual: &quot;Fizz&quot;

3 runs, 3 assertions, 1 failures, 0 errors, 0 skips
rake aborted!
</code></pre><p>OK l·ªói r·ªìi. Gi·ªù implement n√†o, m√† khoan, sao l·∫ßn n√†y gi√° tr·ªã actual kh√¥ng ph·∫£i <strong>nil</strong> m√† l√† <strong>Fizz</strong> nh·ªâ. Th√¥i k·ªá. B·ªè qua.</p>
<h4 id="-vi-t-code-sau">...Vi·∫øt code sau</h4>
<p>V·∫≠y l√† gi·ªù ch√∫ng ta ph·∫£i implement cho tr∆∞·ªùng h·ª£p c√πng chia h·∫øt cho c·∫£ <strong>3</strong> v√† <strong>5</strong>. L√†m nh∆∞ th·∫ø n√†o nh·ªâ?</p>
<p><strong>FizzBuzz.rb</strong></p>
<pre><code>def run(n)
  if n % 3 == 0
    return &quot;Fizz&quot;
  elsif n % 5 == 0
    return &quot;Buzz&quot;
  elsif n % 3 == 0 &amp;&amp; n % 5 == 0
    return &quot;FizzBuzz&quot;
  end
end
</code></pre><p>Ngon l√†nh ch∆∞a? Hmm, h√¨nh nh∆∞ c√≥ g√¨ ƒë√≥ ko ƒë√∫ng l·∫Øm, th√¥i k·ªá, ch·∫Øc lo xa qu√° th√¥i, test n√†o.</p>
<pre><code># Running:

.F.

Finished in 0.001588s, 1889.1688 runs/s, 1889.1688 assertions/s.

  1) Failure:
FizzBuzzTest#test_fizzbuzz_run_return_fizzbuzz [/Users/huy/Desktop/Code/rbfizzbuzz/FizzBuzz_test.rb:20]:
Expected: &quot;FizzBuzz&quot;
  Actual: &quot;Fizz&quot;

3 runs, 3 assertions, 1 failures, 0 errors, 0 skips
rake aborted!
</code></pre><p>·ªö, v·∫´n l·ªói. Sao k√¨ z·∫©y, r√µ r√†ng l√† fail n√®. Implement r·ªìi m√† fail l√† sao ta. Xem n√†o, n√≥ fail v√¨ actual tr·∫£ v·ªÅ <strong>&quot;Fizz&quot;</strong>, k√¨ l·∫°... C√≥ g√¨ ƒë√≥ sai r·ªìi, c√πng xem l·∫°i code n√†o.</p>
<p>ƒê·∫ßu ti√™n ch√∫ng ta check coi s·ªë n c√≥ chia h·∫øt cho 3 kh√¥ng <code>n % 3 == 0</code>, sau ƒë√≥ check coi n c√≥ chia h·∫øt cho 5 kh√¥ng <code>n % 5 == 0</code>. √Ä ƒë√∫ng r·ªìi, v·∫≠y l√† n√≥ h·ªët lu√¥n c·∫£ 2 tr∆∞·ªùng h·ª£p chia h·∫øt cho 3 v√† 5 r·ªìi, cho n√™n tr∆∞·ªùng h·ª£p c√πng chia h·∫øt cho c·∫£ 3 v√† 5 th√¨ kh√¥ng th·ªÉ n√†o m√† n·∫±m ·ªü d∆∞·ªõi c√πng nh∆∞ v·∫≠y ƒë∆∞·ª£c.</p>
<p>V·∫≠y c√°ch gi·∫£i quy·∫øt l√† ngay t·ª´ ƒë·∫ßu ch√∫ng ta ph·∫£i ki·ªÉm tra tr∆∞·ªùng h·ª£p c√πng chia h·∫øt cho 3 v√† 5 tr∆∞·ªõc.</p>
<p><strong>FizzBuzz.rb</strong></p>
<pre><code>def run(n)
  if n % 3 == 0 &amp;&amp; n % 5 == 0
    return &quot;FizzBuzz&quot;
  elsif n % 3 == 0
    return &quot;Fizz&quot;
  elsif n % 5 == 0
    return &quot;Buzz&quot;
  end
end
</code></pre><p>ƒê√≥, l√†m v·∫≠y m·ªõi ƒë√∫ng, gi·ªù ch·∫°y test l·∫°i coi n√†o:</p>
<pre><code># Running:

...

Finished in 0.001329s, 2257.3363 runs/s, 2257.3363 assertions/s.

3 runs, 3 assertions, 0 failures, 0 errors, 0 skips
</code></pre><p>ƒê√≥! Pass r·ªìi th·∫•y ch∆∞a? V·ª´a r·ªìi kh√¥ng ph·∫£i l√† tui g√† ƒë√¢u nha, tui c·ªë t√¨nh sai cho m·∫•y b·∫°n kh·ªèi b·ªã m·∫•t t·∫≠p trung ƒë√≥ :trollface: nh·ªõ ƒë√≥ nha, kh√¥ng ph·∫£i do tui g√† ƒë√¢u ƒë√≥ :chicken: </p>
<h3 id="test-case-4-nh-n-v-o-m-t-s-kh-ng-chia-h-t-cho-3-hay-5-g-c-tr-v-ch-nh-s-">Test case #4: Nh·∫≠n v√†o m·ªôt s·ªë kh√¥ng chia h·∫øt cho 3 hay 5 g√¨ c·∫£, tr·∫£ v·ªÅ ch√≠nh s·ªë ƒë√≥</h3>
<p>Test case cu·ªëi c√πng n√†y th√¨ nh·∫π nh√†ng th√¥i, kh√¥ng c√≥ trap g√¨ gi·ªëng nh∆∞ kh√∫c tr√™n n·ªØa ƒë√¢u, ·ª© y√™n t√¢m m√† test.</p>
<h4 id="vi-t-test-tr-c-">Vi·∫øt test tr∆∞·ªõc...</h4>
<p>Trong tr∆∞·ªùng h·ª£p n√†y, input c√≥ th·ªÉ s·∫Ω l√† 2, 4, 8 g√¨ ƒë√≥, mi·ªÖn l√† n√≥ kh√¥ng chia h·∫øt cho th·∫±ng n√†o trong 2 s·ªë 3 v√† 5 l√† ƒë∆∞·ª£c.</p>
<p><strong>FizzBuzz_test.rb</strong></p>
<pre><code>def test_fizzbuzz_run_return_n
  expect = 8
  actual = FizzBuzz.run(8)
  assert_equal expect, actual
end
</code></pre><p>Test s·∫Ω fail, n·∫øu kh√¥ng fail th√¨ c·∫ßn ph·∫£i xem l·∫°i :joy: </p>
<pre><code># Running:

..F.

Finished in 0.001451s, 2756.7195 runs/s, 2756.7195 assertions/s.

  1) Failure:
FizzBuzzTest#test_fizzbuzz_run_return_n [/Users/huy/Desktop/Code/rbfizzbuzz/FizzBuzz_test.rb:26]:
Expected: 8
  Actual: nil

4 runs, 4 assertions, 1 failures, 0 errors, 0 skips
rake aborted!
</code></pre><h4 id="-vi-t-code-sau">...Vi·∫øt code sau</h4>
<p>R·ªìi, gi·ªù th√¨ implement cho tr∆∞·ªùng h·ª£p cu·ªëi c√πng, code nhanh c√≤n ƒëi c√† ph√™ ch·ªõ. M√¨nh c√≥ c√°i t·∫≠t ƒëang code m√† ai r·ªß r√™ ƒëi c√† ph√™ u·ªëng n∆∞·ªõc l√† b·ª±c l·∫Øm, t·∫°i nghe r·ªß l√† ƒë·ª©ng d·∫≠y ƒëi li·ªÅn √†...</p>
<p><strong>FizzBuzz.rb</strong></p>
<pre><code>def run(n)
  if n % 3 == 0 &amp;&amp; n % 5 == 0
    return &quot;FizzBuzz&quot;
  elsif n % 3 == 0
    return &quot;Fizz&quot;
  elsif n % 5 == 0
    return &quot;Buzz&quot;
  else
      return n
  end
end
</code></pre><p>Test lu√¥n:</p>
<pre><code># Running:

....

Finished in 0.001397s, 2863.2785 runs/s, 2863.2785 assertions/s.

4 runs, 4 assertions, 0 failures, 0 errors, 0 skips
</code></pre><p>To·∫πt z·ªùi! Pass h·∫øt lu√¥n r·ªìi!!!</p>
<h2 id="k-t-lu-n">K·∫øt lu·∫≠n</h2>
<p>ƒê·∫øn ƒë√¢y, c√°c b·∫°n ƒë√£ implement xong m·ªôt module FizzBuzz ho√†n ch·ªânh, v·ªõi ƒë·∫ßy ƒë·ªß m·ªçi test case c·∫ßn thi·∫øt ƒë·ªÉ ƒë·∫£m b·∫£o module lu√¥n ch·∫°y ƒë√∫ng v√† kh√¥ng x·∫£y ra bug ti·ªÅm ·∫©n. Cho n√™n trong qu√° tr√¨nh s·ª≠ d·ª•ng module n√†y trong d·ª± √°n, n·∫øu c√≥ x·∫£y ra l·ªói th√¨ c√°c b·∫°n c√≥ th·ªÉ ch·∫°y l·∫°i test ƒë·ªÉ ƒë·∫£m b·∫£o v·∫•n ƒë·ªÅ kh√¥ng n·∫±m trong n√†y. V·∫≠y l√† ti·∫øt ki·ªám ƒë∆∞·ª£c m·ªôt ch√∫t th·ªùi gian khi debug.</p>
<p>C√°c b·∫°n c√≥ th·ªÉ tham kh·∫£o source ƒë·∫ßy ƒë·ªß c·ªßa module FizzBuzz trong b√†i <a href="https://gist.github.com/huytd/db4624346a16c4510598e28602005f5f">t·∫°i ƒë√¢y</a></p>
<hr>
<p>ƒê·ªÉ √°p d·ª•ng TDD m·ªôt c√°ch hi·ªáu qu·∫£ th√¨ b·∫°n c·∫ßn ph·∫£i n·∫Øm r√µ ƒë∆∞·ª£c y√™u c·∫ßu, chia ƒë∆∞·ª£c v·∫•n ƒë·ªÅ c·∫ßn x·ª≠ l√Ω th√†nh c√°c v·∫•n ƒë·ªÅ nh·ªè h∆°n (t·ª´ng test case), ƒëi·ªÅu n√†y ƒë√≤i h·ªèi b·∫°n ph·∫£i t·ªën m·ªôt kho·∫£n th·ªùi gian ban ƒë·∫ßu ƒë·ªÉ suy nghƒ© v·ªÅ vi·ªác m√¨nh c·∫ßn l√†m tr∆∞·ªõc khi th·ª±c s·ª± b·∫Øt tay v√†o code. Nh∆∞ng l·ª£i √≠ch m√† n√≥ ƒëem l·∫°i th√¨ r·∫•t nhi·ªÅu, gi·ªëng nh∆∞ vi·ªác b·∫°n ƒëi v√†o r·ª´ng m√† kh√¥ng s·ª£ b·ªã l·∫°c v√¨ ƒë√£ c√≥ s·∫µn t·∫•m b·∫£n ƒë·ªì ng·ªìi t·ª± v·∫Ω t·ª´ ƒë√™m h√¥m qua v·∫≠y ƒë√≥ :laughing: </p>
<p>V·∫≠y th√¨, n√™n l·ª±a ch·ªçn gi·ªØa t·ªëc ƒë·ªô (bay v√†o code √†o √†o) hay ch·∫•t l∆∞·ª£ng (u·ªëng mi·∫øng n∆∞·ªõc ƒÉn mi·∫øng b√°nh, vi·∫øt mi·∫øng test case tr∆∞·ªõc r·ªìi m·ªõi code)? B·ªè th·ªùi gian ra ng·ªìi debug v√† c√£i nhau v·ªõi tester hay nh·∫≠n bug v·ªÅ ch·∫°y test ƒë·ªÉ bi·∫øt ƒë∆∞·ª£c v·∫•n ƒë·ªÅ n·∫±m ·ªü ƒë√¢u r·ªìi fix m·ªôt c√°ch nhanh ch√≥ng? Tr·ªü th√†nh m·ªôt l·∫≠p tr√¨nh vi√™n chuy√™n nghi·ªáp hay m·ªôt c√¥ng nh√¢n fix bug, fix v√†i nƒÉm r·ªìi l√™n l√†m leader :trollface:? Hy v·ªçng ƒë·∫øn ƒë√¢y c√°c b·∫°n ƒë√£ c√≥ c√¢u tr·∫£ l·ªùi cho ch√≠nh b·∫£n th√¢n m√¨nh.</p>
<p>Happy bug fixing ^^</p>
<div class='other-tags'><b>Tags:</b> <a class='topic-tag' href='https://huytd.github.io/tags/tdd.html'>tdd</a><a class='topic-tag' href='https://huytd.github.io/tags/ruby.html'>ruby</a><a class='topic-tag' href='https://huytd.github.io/tags/fizzbuzz.html'>fizzbuzz</a></div>
                <div class="copyright">
                B·∫°n ƒë∆∞·ª£c t√πy √Ω b·∫•m like, tr√≠ch d·∫´n ho·∫∑c copy, post l·∫°i, nh∆∞ng vui l√≤ng ghi r√µ ngu·ªìn v√† t√°c gi·∫£ v√† kh√¥ng l√†m thay ƒë·ªïi n·ªôi dung b√†i vi·∫øt. N·∫øu kh√¥ng l√†m v·∫≠y, m√¨nh hy v·ªçng t·ª´ nay v·ªÅ sau b·∫°n s·∫Ω lu√¥n c·∫£m th·∫•y c·∫Øn r·ª©t l∆∞∆°ng t√¢m, ƒÉn kh√¥ng ngon, ng·ªß kh√¥ng y√™n. üòÜ
                </div>
                <!-- Comment -->
                <div class="comments">
                  <div id="comment-loading" class="loading"></div>
                  <div id="login-box" class="login">
                    B·∫°n c·∫ßn <button onclick="login()">Login</button> ƒë·ªÉ comment
                  </div>
                  <div id="comment-box" class="comment-input">
                    <div class="avatar">
                      <img id="user-avatar" src="" width="32" height="32"/>
                    </div>
                    <div class="input">
                      <textarea id="comment-content" onkeyup="autoSizing(this)" onkeydown="submitComment(event)" placeholder="Comment g√µ v√†o ƒë√¢y :D"></textarea>
                      <span>G√µ xong nh·∫•n <kbd>Ctrl</kbd> + <kbd>Enter</kbd> ƒë·ªÉ g·ª≠i.</span>
                    </div>
                  </div>
                  <ul id="comment-list" class="comment-list"></ul>
                </div>
                <!-- End Comment -->
            </div>
        </div>
	    <div class="footer">
            <p>Created with <a href="http://github.com/huytd/azeroth-js">azeroth.js</a></p>
            <div class="social">
                <a target="_blank" href="http://facebook.com/kingbazoka"><i class="icon-facebook-squared"></i></a>
                <a target="_blank" href="http://twitter.com/huydotnet"><i class="icon-twitter-squared"></i></a>
                <a target="_blank" href="http://github.com/huytd"><i class="icon-github-squared"></i></a>
                <a target="_blank" href="https://thefullsnack.com"><i class="icon-emo-coffee"></i></a>
            </div>
        </div>
        <script type="text/javascript" async src="https://cdn.rawgit.com/mathjax/MathJax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
        <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [['$','$'], ['\\(','\\)']],
            skipTags: ["script","noscript","style","textarea"]
          }
        });
        </script>
        <script src="https://www.gstatic.com/firebasejs/3.8.0/firebase.js"></script>
        <script>
          // Initialize Firebase
          var config = {
            apiKey: "AIzaSyA1PnIAlJJ-U6iQJMNnCOknBuziBqGMYcY",
            authDomain: "huys-blog-comment.firebaseapp.com",
            databaseURL: "https://huys-blog-comment.firebaseio.com",
            projectId: "huys-blog-comment",
            storageBucket: "huys-blog-comment.appspot.com",
            messagingSenderId: "317330376829"
          };
          firebase.initializeApp(config);
        </script>
        <script>
          let provider = new firebase.auth.GoogleAuthProvider();
          let auth = firebase.auth();
          let currentUser = null;
          let postCommentURL = 'posts/tdd/comments';

          auth.onAuthStateChanged(function(user) {
            document.getElementById("comment-loading").style.display = "none";
            if (user) {
              currentUser = user;
              // Logged in
              document.getElementById("login-box").style.display = "none";
              document.getElementById("comment-box").style.display = "flex";
              document.getElementById("user-avatar").setAttribute("src", user.photoURL);
            } else {
              // Not login yet
              document.getElementById("comment-box").style.display = "none";
              document.getElementById("login-box").style.display = "block";
            }
          });

          const login = function() {
            auth.signInWithPopup(provider)
              .then(function(result) {
              }).catch(function(err) {
              });
          };

          const encodeHTML = function(s) {
            return s.replace(/</g, '&lt;').replace(/"/g, '&quot;').replace(/>/g, '&gt;');
          };

          const saveNewComment = function(comment) {
            if (!currentUser) {
              return;
            }
            let commentData = {
              user: currentUser.displayName,
              avatar: currentUser.photoURL,
              time: (new Date()).getTime(),
              message: encodeHTML(comment)
            };
            database.ref(postCommentURL).push(commentData);
            document.getElementById("comment-content").value = "";
          };

          const submitComment = function(e) {
            let keyCode = e.which || e.keyCode;
            let ctrlCode = e.ctrlKey || e.metaKey;
            if (keyCode === 13 && ctrlCode) {
              let comment = document.getElementById("comment-content").value;
              saveNewComment(comment);
            }
          };

          const filterURLinComment = function(comment) {
            return comment.replace(/(https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9]\.[^\s]{2,})/g, "<a target='_blank' rel='noopener noreferrer' href='$1'>$1</a>");
          };

          const addNewComment = function(user, avatar, time, comment) {
            let commentFiltered = encodeHTML(comment);
            commentFiltered = filterURLinComment(commentFiltered);
            let d = new Date(time);
            let commentTime = d.toLocaleTimeString() + ' ' + d.toLocaleDateString();
            let html = '<div class="avatar">' +
              '   <img src="' + avatar + '" width="32" height="32"/>' +
              ' </div>' +
              '<div class="comment">' +
              '  <div class="metadata"><b>' + user + '</b> l√∫c <span>' + commentTime + '</span></div>' +
              '  <div class="content">' + commentFiltered
              '  </div>' +
              '</div>';
            let li = document.createElement('li');
            li.innerHTML = html;
            document.getElementById("comment-list").append(li);
          };

          let database = firebase.database();
          let posts = database.ref(postCommentURL).orderByChild('time');
          posts.on('child_added', function(data) {
            addNewComment(data.val().user, data.val().avatar, data.val().time, data.val().message);
          });
        </script>
    </body>
</html>
